<html layout:decorate="~{layout_page}" xmlns:layout="http://www.w3.org/1999/xhtml">
<style>

</style>

<th:block layout:fragment="content">


    <div class="layout-contents">
        <!-- Page Title -->
        <div class="page-title-wrap">
            <div class="left">
                <h2>순회점검등록</h2><a id="toggleButton" onclick="toggleSearchWrap()"><img src="/images/icon/ico-down.png" alt="알람 아이콘"></a>
                <!--<a title="북마크" class="bookmark toggle">
                    내메뉴
                </a>-->
            </div>
            <ul class="page-navi">
                <li><img src="/images/icon/ico-nav-home.svg" alt="홈아이콘"></li>
                <li>점검관리</li>
                <li>순회점검등록</li>
            </ul>
        </div>
        <!-- Select -->
        <div class="search-wrap" id="searchWrap" style="display: none">
            <ul>
                <li>
                    <select title="지역" id="spworkcd" name="spworkcd"
                            onchange="updateCompcdOptions(); saveSelectedSandanData(); ">
                        <!-- 지역 옵션을 JavaScript에서 동적으로 채움 -->
                    </select>
                    <input type="hidden" id="spworknm" name="spworknm">
                </li>
                <li>
                    <select title="산단" id="spcompcd" name="spcompcd"
                            onchange="updatePlancdOptions(); saveSelectedSandanData();">
                        <!-- 산단 옵션을 JavaScript에서 동적으로 채움 -->
                    </select>
                    <input type="hidden" id="spcompnm" name="spcompnm">
                </li>
                <li>
                    <select title="시설" id="spplancd" name="spplancd" onchange="updatePlannm(); saveSelectedSandanData()">
                        <!-- 시설 옵션을 JavaScript에서 동적으로 채움 -->
                    </select>
                    <input type="hidden" id="spplannm" name="spplannm">
                </li>
            </ul>
        </div>
        <div class="tab-wrap">
            <ul class="tab-links">
                <input type="hidden" id="spuncode" name="spuncode" />
                <input type="hidden" id="checkdtParam" name="checkdtParam" th:value="${checkdt}" />


                <li>
                    <a href="#tab1" title="목록" id="listTabLink">목록</a>
                </li>
                <li>
                    <a href="#tab2" title="등록" id="inputTabLink">등록</a>
                </li>
                <li>
                    <a href="#maintab3" title="현황" id="current">현황</a>
                </li>
                <li>
                    <a href="#maintab4" title="기간별 조회" id="runWijmo">기간별조회</a>
                </li>
                <li>
                    <a href="#maintab5" title="기간별 대비" id="runrmate">기간별대비</a>
                </li>

            </ul>
            <div class="tab-contents">
                <!-- Section -->
                <section class="tab-item" id="tab1">
                    <div class="section-top">
                        <div class="search-wrap">
                            <dl>
                                <dt>
                                    등록일자<span class="eq">*</span>
                                </dt>
                                <dd>
                                    <ul class="date-box">
                                        <li>
                                            <input type="date" id="searchfrdate" name="searchfrdate">
                                            <label for="searchfrdate" class="hide">시작일</label>
                                        </li>
                                        <li>
                                            <input type="date" id="searchtodate" name="searchtodate">
                                            <label for="searchtodate" class="hide">종료일</label>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <dl>
                                <dt>
                                    <label>
                                        점검자<span class="eq">*</span>
                                    </label>
                                </dt>
                                <dd>
                                    <div class="srch-box">
                                        <input type="text" id="searchusr" name="searchusr" class="input-srch" placeholder="점검자명 검색">
                                        <a href="#a" class="btn-srch" id="searchgrid" title="검색" onclick="searchData()" onkeyup="searchData()"></a>
                                    </div>
                                </dd>
                            </dl>
                            <dl>
                                <dt>
                                    <label for="flag">
                                        점검여부<span class="eq">*</span></dt>
                                </label>
                                <dd>
                                    <select id="flag" class="w120">
                                        <option value="">전체</option>
                                        <option value="Y">완료</option>
                                        <option value="N">미완료</option>
                                    </select>
                                </dd>
                            </dl>
                        </div>
                        <div class="button-wrap">
                            <ul>
                                <li>
                                    <a class="btn modal_btn" title="How to Use">
                                        How to Use
                                    </a>
                                </li>
                                <li>
                                    <a  class="btn btn-delete" title="승인" id="btnAppr">
                                        <img src="/images/icon/ico-save.svg" alt="엑셀 아이콘">
                                        승인
                                    </a>
                                </li>
                                <li>
                                    <a  class="btn btn-delete" title="삭제" id="btnDelete">
                                        <img src="/images/icon/ico-delete.svg" alt="엑셀 아이콘">
                                        삭제
                                    </a>
                                </li>
                                <li>
                                    <a  class="btn btn-edit" title="수정" onclick="modifyData()">
                                        <img src="/images/icon/ico-edit.svg" alt="엑셀 아이콘">
                                        수정
                                    </a>
                                </li>
                                <li>
                                    <a class="btn btn-print" title="순회점검일지 출력" onclick="DownloadDoc()">
                                        <img src="/images/icon/ico-print.svg" alt="엑셀 아이콘">
                                        순회점검일지 출력
                                    </a>
                                </li>
                                <!-- 로딩 바 요소 -->
                                <div id="loadingBar">
                                    <div class="spinner"></div>
                                </div>
                            </ul>
                        </div>
                    </div> <!--//section-top end -->
                    <div class="container-fluid">
                        <p id="selectedItem"></p>
                        <div id="theGrid" style="height: 680px; max-height: 680px"></div>
                    </div>
                    <div class="btn-wrap">
                    </div>
                </section>
                <!-- Section -->
                <section class="tab-item" id="tab2">
                    <div class="section-top">
                        <div class="title-wrap">
                            <h3>점검 등록</h3>
                        </div>
                        <div class="button-wrap">
                            <ul>
                                <li>
                                    <a class="btn file_btn" title="파일첨부" onclick="showPopup2()">

                                        파일첨부<span>(0)</span>
                                    </a>
                                </li>
                                <li>
                                    <a class="btn btn-excell" title="신규등록" onclick="clearForm()">
                                        <img src="/images/icon/ico-plus.svg" alt="등록 아이콘">
                                        신규등록
                                    </a>
                                </li>
                                <!--<li>
                                    <a  class="btn btn-delete" title="삭제">
                                        <img src="/images/icon/ico-delete.svg" alt="삭제 아이콘">
                                        삭제
                                    </a>
                                </li>-->
                                <li>
                                    <a class="btn btn-edit" id="btnSave" title="저장">
                                        <img src="/images/icon/ico-save.svg" alt="저장 아이콘">
                                        저장
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="table-wrap">
                        <table class="write-table">
                            <caption>점검등록 테이블</caption>
                            <colgroup>
                                <col class="wp12">
                                <col class="wp40">
                                <col class="wp12">
                                <col class="wp40">
                            </colgroup>
                            <tbody>
                            <tr>
                                <th>
                                    <label for="supplier">
                                        도급계약명 수급사명
                                    </label>
                                </th>
                                <td>
                                    <input type="text" id="supplier" name="supplier" class="wp100" maxlength="50" placeholder="도급계약명">
                                    <ul id="suggestions-supplier" class="suggestions-list"></ul>
                                </td>
                                <th>
                                    <label for="checkdt">
                                        등록일자
                                    </label>
                                </th>
                                <td>
                                    <input type="date" id=checkdt name="checkdt" autocomplete="off">
                                </td>
                            </tr>
                            <tr>
                                <th>
                                    <label for="checkstdt">
                                        점검시작일자 <span class="req">*</span>
                                    </label>
                                </th>
                                <td>
                                    <input type="datetime-local" id="checkstdt" name="checkstdt" autocomplete="off">
                                </td>
                                <th>
                                    <label for="checkendt">
                                        점검종료일자 <span class="req">*</span>
                                    </label>
                                </th>
                                <td>
                                    <input type="datetime-local" id="checkendt" name="checkendt" autocomplete="off">
                                </td>
                            </tr>
                            <tr>
                                <th>
                                    <label for="checkusr">
                                        점검자
                                    </label>
                                </th>
                                <td>
                                    <div class="input-btnbox">
                                        <input type="text" id="checkusr" name="checkusr" class="wp100" placeholder="점검자" maxlength="40">
                                        <ul id="suggestions-checkusr" class="suggestions-list" style="top:100%"></ul>
                                        <button onclick="addInputField(this)" class="mg-l8">점검자 추가</button>
                                    </div>
                                </td>
                                <th>
                                    <label for="checkarea">
                                        점검장소 <span class="req">*</span>
                                    </label>
                                </th>
                                <td>
                                    <input type="text" id="checkarea" name="checkarea" maxlength="100" class="wp100" placeholder="점검장소">
                                    <ul id="suggestions-checkarea" class="suggestions-list"></ul>
                                </td>
                            </tr>

                            <table style="margin: 15px 0px;" class="write-table doc-table">
                                <caption>sad</caption>
                                <colgroup>
                                    <col width="">
                                </colgroup>
                                <thead>
                                <tr>
                                    <th scope="col" rowspan="2" style="width: 10%;">구분</th>
                                    <th scope="col" rowspan="2" style="width: 25%;">점검 사항</th>
                                    <th scope="col" rowspan="2" style="width: 8%;">점검 결과</th>
                                    <th scope="col" rowspan="2">개선 사항</th>
                                </tr>

                                </thead>
                                <tbody>
                                <tr>
                                    <td rowspan="4"><span id="inspecdivision1">일반 점검 사항</span></td>
                                    <td class="left-text">
                                        <span id="inspeccont1">ㅇ 작업환경 일반 사항<br>- 작업장 내부 적절한 조도 확보 여부<br>- 밀폐공간일 경우 유해가스 등 환기 여부</span>
                                        <input type="hidden" id="seq1" name="seq1" />
                                    </td>
                                    <td class="checkbox-cell"><span id="inspecresult1">O</span></td>
                                    <td>
                                        <div class="textarea-box">
                                            <textarea id="inspecreform1" name="inspecreform1" maxlength="100" style="height: 60px;"></textarea>
                                            <p class="text-count" name="checkplan">0/100</p>
                                        </div>
                                    </td>

                                </tr>
                                <tr>
                                    <td  class="left-text"><span id="inspeccont2">ㅇ 발전소 주변 유해위험 환경요소 점검<br>- 작업 또는 통행에 방해되는 폐기물 또는 적치물 방치 상태, 위험물/인화성물질 방치 상태 등</span>
                                        <input type="hidden" id="seq2" name="seq2" />
                                    </td>
                                    <td class="checkbox-cell"><span id="inspecresult2">O</span></td>
                                    <td>
                                        <div class="textarea-box">
                                            <textarea id="inspecreform2" name="inspecreform2" maxlength="100" style="height: 60px;"></textarea>
                                            <p class="text-count" name="inspecreform2">0/100</p>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td  class="left-text">
                                        <span id="inspeccont3">ㅇ 화재 등 위험상황 대비 관련 사항<br>- 소화기 등 비치 상태<br>- 화재 등 비상상황시 비상문, 비상대피로 확보</span>
                                        <input type="hidden" id="seq3" name="seq3" />
                                    </td>
                                    <td class="checkbox-cell"><span id="inspecresult3">O</span></td>
                                    <td>
                                        <div class="textarea-box">
                                            <textarea id="inspecreform3" name="inspecreform3" maxlength="100" style="height: 60px;"></textarea>
                                            <p class="text-count" name="inspecreform3">0/100</p>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td  class="left-text">
                                        <span id="inspeccont4">ㅇ 작업 전/후 정리정돈 등 환경정리 상태<br>- 작업전 작업환경 사전점검 실시<br>- 작업후 작업부산물 정리, 청소, 정리정돈 실시</span>
                                        <input type="hidden" id="seq4" name="seq4" />
                                    </td>
                                    <td class="checkbox-cell"><span id="inspecresult4">O</span></td>
                                    <td>
                                        <div class="textarea-box">
                                            <textarea id="inspecreform4" name="inspecreform4" maxlength="100" style="height: 60px;"></textarea>
                                            <p class="text-count" name="inspecreform4">0/100</p>
                                        </div>
                                    </td>
                                </tr>

                                <tr>
                                    <td rowspan="2"><span id="inspecdivision2">중점 점검 사항</span></td>
                                    <td class="left-text">
                                        <span id="inspeccont5">ㅇ 전기작업 위험요소 점검<br>- 전기기기의 접지 상태 확인<br>- 작업 전 차단기 OFF 조치 등 전원 통전 확인</span>
                                        <input type="hidden" id="seq5" name="seq5" />
                                    </td>

                                    <td class="checkbox-cell"><span id="inspecresult5">O</span></td>
                                    <td>
                                        <div class="textarea-box">
                                            <textarea id="inspecreform5" name="inspecreform5" maxlength="100" style="height: 60px;"></textarea>
                                            <p class="text-count" id="text-count2" name="checkplan">0/100</p>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td  class="left-text">
                                        <span id="inspeccont6">ㅇ 고소작업 위험요소 점검<br>- 작업전 사다리 상태 점검<br>- 사다리 활용 작업시 2인 1조 작업 및 최상단  발판 금지</span>
                                        <input type="hidden" id="seq6" name="seq6" />
                                    </td>
                                    <td class="checkbox-cell"><span id="inspecresult6">O</span></td>
                                    <td>
                                        <div class="textarea-box">
                                            <textarea id="inspecreform6" name="inspecreform4" maxlength="100" style="height: 60px;"></textarea>
                                            <p class="text-count" name="inspecreform4">0/100</p>
                                        </div>
                                    </td>
                                </tr>

                                </tbody>
                            </table>

                            </tbody>
                        </table>
                    </div>
                </section>
                <section class="tab-item" id="maintab3">
                    <div class="row row-1">
                        <section class="wp50" style="height: 760px">
                            <div class="title-wrap">
                                <h3>점검캘린더</h3>
                                <div class="btn-wrap">
                                </div>
                            </div>
                            <div class="calendar-wrap">
                                <div id="calendar"></div>
                            </div>
                        </section>
                        <div class="col wp30 mg-r24">
                            <!-- Section -->
                            <section style="margin-bottom: 5px">
                                <div class="title-wrap">
                                    <h3 id="StatusTitle"></h3>
                                    <div class="btn-wrap">
                                    </div>
                                </div>
                                <div class="status-inspect">
                                    <dl>
                                        <dt>등록</dt>
                                        <dd id="totalCount">1</dd>
                                    </dl>
                                    <dl>
                                        <dt>결제</dt>
                                        <dd id="yCount">3</dd>
                                    </dl>
                                    <dl>
                                        <dt>미결제</dt>
                                        <dd id="nCount">1</dd>
                                    </dl>
                                </div>
                            </section>
                            <!-- Section -->
                            <section style="margin-bottom: 5px">
                                <div class="title-wrap">
                                    <h3 id="InspectionDetails">점검내역</h3>
                                    <div class="btn-wrap">
                                    </div>
                                </div>

                                <div class="container-fluid">
                                    <div id="theGrid3" style="height: 490px; width: 440px"></div>
                                </div>

                                <!--<div class="table-wrap h200">
                                    <table class="list-table">
                                        <caption>점검내역 테이블</caption>
                                        <colgroup>
                                            <col class="wp33">
                                            <col class="wp33">
                                            <col class="wp33">
                                        </colgroup>
                                        <thead>
                                        <tr>
                                            <th>점검일자</th>
                                            <th>점검시간</th>
                                            <th>점검자</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                            <td>순회</td>
                                            <td>대구물류</td>
                                            <td>홍길동</td>
                                        </tr>
                                        <tr>
                                            <td>순회</td>
                                            <td>대구물류</td>
                                            <td>홍길동</td>
                                        </tr>
                                        <tr>
                                            <td>순회</td>
                                            <td>대구물류</td>
                                            <td>홍길동</td>
                                        </tr>
                                        <tr>
                                            <td>순회</td>
                                            <td>대구물류</td>
                                            <td>홍길동</td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>-->
                            </section>
                            <!-- Section -->
                            <!--<section>
                                <div class="title-wrap">
                                    <h3>현장 실시간 CCTV</h3>
                                    <div class="btn-wrap">

                                    </div>
                                </div>
                                <div class="thumb-wrap">
                                    &lt;!&ndash;<div>
                                        <img src="/images/sample/sample-cctv.svg" alt="cctv sample" class="wp105">
                                    </div>
                                    <div>
                                        <img src="/images/sample/sample-cctv.svg" alt="cctv sample" class="wp105">
                                    </div>&ndash;&gt;
                                    &lt;!&ndash;<canvas style="width: 300px;"></canvas>&ndash;&gt;

                                    <div class="section">
                                        <input type="radio" name="slide" id="slide01" checked>
                                        <input type="radio" name="slide" id="slide02">
                                        <input type="radio" name="slide" id="slide03">
                                        <input type="radio" name="slide" id="slide04">
                                        <div class="slidewrap">
                                            <ul class="slidelist">
                                                <li>

                                                    <a>
                                                        &lt;!&ndash;<img src="/images/sample/sample-cctv.svg" style="width: 100%">&ndash;&gt;
                                                        &lt;!&ndash;<canvas id="canvas1" style="width: 100%; height: 360px"></canvas>&ndash;&gt;
                                                        <video id="video" class="video-js vjs-default-skin" width="440" height="248" controls autoplay></video>
                                                    </a>
                                                </li>
                                                <li>
                                                    <a>
                                                        &lt;!&ndash; 두 번째 CCTV 스트림 &ndash;&gt;
                                                        &lt;!&ndash;<canvas id="canvas2" style="width: 300px;"></canvas>&ndash;&gt;
                                                        &lt;!&ndash;<canvas id="canvas2" style="width: 100%; height: 360px;"></canvas>&ndash;&gt;
                                                        <video id="video2" class="video-js vjs-default-skin" width="440" height="248" controls autoplay></video>
                                                    </a>
                                                </li>
                                                <li>
                                                    <a>
                                                        &lt;!&ndash;<canvas id="canvas3" style="width: 100%; height: 360px;"></canvas>&ndash;&gt;
                                                        <video id="video3" class="video-js vjs-default-skin" width="440" height="248" controls autoplay></video>
                                                    </a>
                                                </li>
                                                <li>
                                                    <a>
                                                        &lt;!&ndash;<canvas id="canvas4" style="width: 100%; height: 360px;"></canvas>&ndash;&gt;
                                                        <video id="video4" class="video-js vjs-default-skin" width="440" height="248" controls autoplay></video>
                                                    </a>
                                                </li>
                                            </ul>

                                            <div class="slide-control">
                                                <div class="control01">
                                                    <label for="slide04" class="left"></label>
                                                    <label for="slide02" class="right"></label>
                                                </div>
                                                <div class="control02">
                                                    <label for="slide01" class="left"></label>
                                                    <label for="slide03" class="right"></label>
                                                </div>
                                                <div class="control03">
                                                    <label for="slide02" class="left"></label>
                                                    <label for="slide04" class="right"></label>
                                                </div>
                                                <div class="control04">
                                                    <label for="slide03" class="left"></label>
                                                    <label for="slide01" class="right"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>-->
                        </div>
                        <section class="wp25" style="height: 770px">
                            <div class="title-wrap">
                                <h3 id="MonthInpsecTitle"></h3>
                                <div class="btn-wrap">
                                    <a title="더보기" class="btn-plus"></a>
                                </div>
                            </div>
                            <div class="table-wrap">

                                <div class="container-fluid">
                                    <div id="theGrid2" style="height: 680px"></div>
                                </div>
                                <!--<table class="list-table">
                                    <caption>당일 점검일지 현황 테이블</caption>
                                    <colgroup>
                                        <col class="wp33">
                                        <col class="wp33">
                                        <col class="wp33">
                                    </colgroup>
                                    <thead>
                                    <tr>
                                        <th>점검일자</th>
                                        <th>점검시간</th>
                                        <th>상태정보</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <td>2024.07.08</td>
                                        <td>13:00~15:00</td>
                                        <td>등록</td>
                                    </tr>
                                    <tr>
                                        <td>2024.07.08</td>
                                        <td>13:00~15:00</td>
                                        <td>등록</td>
                                    </tr>
                                    <tr>
                                        <td>2024.07.08</td>
                                        <td>13:00~15:00</td>
                                        <td>등록</td>
                                    </tr>
                                    <tr>
                                        <td>2024.07.08</td>
                                        <td>13:00~15:00</td>
                                        <td>결재완료</td>
                                    </tr>
                                    <tr>
                                        <td>2024.07.08</td>
                                        <td>13:00~15:00</td>
                                        <td>등록</td>
                                    </tr>
                                    <tr>
                                        <td>2024.07.08</td>
                                        <td>13:00~15:00</td>
                                        <td>결재완료</td>
                                    </tr>
                                    <tr>
                                        <td>2024.07.08</td>
                                        <td>13:00~15:00</td>
                                        <td>결재완료</td>
                                    </tr>
                                    <tr>
                                        <td>2024.07.08</td>
                                        <td>13:00~15:00</td>
                                        <td>결재완료</td>
                                    </tr>
                                    <tr>
                                        <td>2024.07.08</td>
                                        <td>13:00~15:00</td>
                                        <td>결재완료</td>
                                    </tr>
                                    <tr>
                                        <td>2024.07.08</td>
                                        <td>13:00~15:00</td>
                                        <td>등록</td>
                                    </tr>
                                    <tr>
                                        <td>2024.07.08</td>
                                        <td>13:00~15:00</td>
                                        <td>등록</td>
                                    </tr>
                                    <tr>
                                        <td>2024.07.08</td>
                                        <td>13:00~15:00</td>
                                        <td>등록</td>
                                    </tr>
                                    <tr>
                                        <td>2024.07.08</td>
                                        <td>13:00~15:00</td>
                                        <td>등록</td>
                                    </tr>
                                    </tbody>
                                </table>-->
                            </div>
                        </section>
                    </div>
                </section>

                <section class="tab-item" id="maintab4">
                    <div class="section-top">
                        <div class="search-wrap" style="margin-top: 15px">

                            <dl>
                                <dt>
                                    <label for="periodType">
                                        기간유형<span class="eq">*</span>
                                    </label>
                                </dt>
                                <dd>
                                    <ul class="date-box">
                                        <li>
                                            <select id="periodType" name="periodType" onchange="updatePeriodInputs()">
                                                <option value="hourly">시간별</option>
                                                <option value="monthly" selected>월별</option>
                                                <option value="quarterly">분기별</option>
                                                <option value="halfyearly">반기별</option>
                                                <option value="yearly">연도별</option>
                                            </select>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <dl id="searchYear" style="display: none">
                                <dt>
                                    조회연도<span class="eq">*</span>
                                </dt>
                                <dd>
                                    <ul class="date-box">
                                        <li>
                                            <select id="yearSelectTab1" name="yearSelectTab1">
                                            </select>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <dl>
                                <dt>
                                    조회기간<span class="eq">*</span>
                                </dt>
                                <dd>
                                    <ul class="date-box" id="dateBoxContainer">
                                        <li id="startDateContainer">
                                            <input type="month" id="startDate" name="startDate" value="2024-01">
                                        </li>
                                        <li id="endDateContainer">
                                            <input type="month" id="endDate" name="endDate" value="2024-12">
                                        </li>
                                    </ul>
                                </dd>
                            </dl>


                            <dl>
                                <dt style="visibility: hidden">
                                    조회기간<span class="eq">*</span>
                                </dt>
                                <dd>
                                    <ul class="date-box">
                                        <li>
                                            <a class="btn btn-delete" title="검색" id="btn-search" onclick="searchData_Byperid()">
                                                <img src="/images/icon/btn-srch.svg" alt="검색 아이콘">
                                                검색
                                            </a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                        </div>

                    </div> <!--//section-top end -->

                    <div class="row row-2" style="margin-bottom: 10px">
                        <div class="col wp50" style="margin-right: 15px">
                            <section class="tab-section section_top" style="height: 300px">
                                <div class="title-wrap" style="margin-bottom: 2px">
                                    <h3>순회점검</h3>
                                    <ul class="tab-links-sub">
                                        <li><a href="#tab3" title="통계" onclick="reload('chart1')">통계</a></li>
                                        <li><a href="#tab4" title="현황" >현황</a></li>

                                    </ul>
                                </div>
                                <div class="tab-contents">
                                    <!-- tab3 -->
                                    <div class="tab-item-sub" id="tab3">
                                        <div>
                                            <div id="chartHolder1"
                                                 style="width: 100%; height: 235px; padding-top: 5px"></div>
                                        </div>
                                    </div>
                                    <!-- tab4 -->
                                    <div class="tab-item-sub" id="tab4">
                                        <div class="container-fluid">
                                            <div id="theGrid11" style="width: 100%; height: 235px"></div>
                                        </div>
                                    </div>

                                </div>
                            </section>
                        </div>

                        <div class="col wp50">
                            <section class="tab-section section_top" style="height: 300px">
                                <div class="title-wrap" style="margin-bottom: 2px">
                                    <h3>합동안전점검</h3>
                                    <ul class="tab-links-sub">
                                        <li><a href="#tab5" title="통계" onclick="reload('chart2')">통계</a></li>
                                        <li><a href="#tab6" title="현황">현황</a></li>
                                    </ul>
                                </div>
                                <div class="tab-contents">
                                    <!-- tab5 -->
                                    <div class="tab-item-sub" id="tab5">
                                        <div>
                                            <div id="chartHolder2" style="width: 100%; height: 235px; padding-top: 5px"></div>
                                        </div>
                                    </div>
                                    <!-- tab6 -->
                                    <div class="tab-item-sub" id="tab6">
                                        <div class="container-fluid">
                                            <div id="theGrid21" style="width: 100%; height: 235px"></div>
                                        </div>
                                    </div>

                                </div>
                            </section>
                        </div>
                    </div>

                    <div class="row row-2" style="margin-bottom: 10px">
                        <div class="col wp50" style="margin-right: 15px">
                            <section class="tab-section section_top" style="height: 300px">
                                <div class="title-wrap" style="margin-bottom: 2px">
                                    <h3>전기안전점검</h3>
                                    <ul class="tab-links-sub">
                                        <li><a href="#tab7" title="통계" onclick="reload('chart3')">통계</a></li>
                                        <li><a href="#tab8" title="현황">현황</a></li>

                                    </ul>
                                </div>
                                <div class="tab-contents">
                                    <!-- tab3 -->
                                    <div class="tab-item-sub" id="tab7">
                                        <div>
                                            <div id="chartHolder3" style="width: 100%; height: 235px; padding-top: 5px"></div>
                                        </div>
                                    </div>
                                    <!-- tab4 -->
                                    <div class="tab-item-sub" id="tab8">
                                        <div class="container-fluid">
                                            <div id="theGrid31" style="width: 100%; height: 235px"></div>
                                        </div>
                                    </div>

                                </div>
                            </section>
                        </div>

                        <div class="col wp50">
                            <section class="tab-section section_top" style="height: 300px">
                                <div class="title-wrap" style="margin-bottom: 2px">
                                    <h3>비상훈련계획</h3>
                                    <ul class="tab-links-sub">
                                        <li><a href="#tab9" title="통계" onclick="reload('chart4')">통계</a></li>
                                        <li><a href="#tab10" title="현황">현황</a></li>
                                    </ul>
                                </div>
                                <div class="tab-contents">
                                    <!-- tab5 -->
                                    <div class="tab-item-sub" id="tab9">
                                        <div>
                                            <div id="chartHolder4" style="width: 100%; height: 235px; padding-top: 5px"></div>
                                        </div>
                                    </div>
                                    <!-- tab6 -->
                                    <div class="tab-item-sub" id="tab10">
                                        <div class="container-fluid">
                                            <div id="theGrid41" style="width: 100%; height: 235px"></div>
                                        </div>
                                    </div>

                                </div>
                            </section>
                        </div>
                    </div>

                    <div class="row row-2" style="margin-bottom: 10px">
                        <div class="col wp50" style="margin-right: 15px">
                            <section class="tab-section section_top" style="height: 300px">
                                <div class="title-wrap" style="margin-bottom: 2px">
                                    <h3>비상훈련결과</h3>
                                    <ul class="tab-links-sub">
                                        <li><a href="#tab11" title="통계" onclick="reload('chart5')">통계</a></li>
                                        <li><a href="#tab12" title="현황">현황</a></li>

                                    </ul>
                                </div>
                                <div class="tab-contents">
                                    <!-- tab3 -->
                                    <div class="tab-item-sub" id="tab11">
                                        <div>
                                            <div id="chartHolder5" style="width: 100%; height: 235px; padding-top: 5px"></div>
                                        </div>
                                    </div>
                                    <!-- tab4 -->
                                    <div class="tab-item-sub" id="tab12">
                                        <div class="container-fluid">
                                            <div id="theGrid51" style="width: 100%; height: 235px"></div>
                                        </div>
                                    </div>

                                </div>
                            </section>
                        </div>

                        <div class="col wp50">
                            <section class="tab-section section_top" style="height: 300px">
                                <div class="title-wrap" style="margin-bottom: 2px">
                                    <h3>안전보건교육</h3>
                                    <ul class="tab-links-sub">
                                        <li><a href="#tab13" title="통계" onclick="reload('chart6')">통계</a></li>
                                        <li><a href="#tab14" title="현황">현황</a></li>
                                    </ul>
                                </div>
                                <div class="tab-contents">
                                    <!-- tab5 -->
                                    <div class="tab-item-sub" id="tab13">
                                        <div>
                                            <div id="chartHolder6" style="width: 100%; height: 235px; padding-top: 5px"></div>
                                        </div>
                                    </div>
                                    <!-- tab6 -->
                                    <div class="tab-item-sub" id="tab14">
                                        <div class="container-fluid">
                                            <div id="theGrid61" style="width: 100%; height: 235px"></div>
                                        </div>
                                    </div>

                                </div>
                            </section>
                        </div>
                    </div>


                    <div class="row row-2" style="margin-bottom: 10px">
                        <div class="col wp50" style="margin-right: 15px">
                            <section class="tab-section section_top" style="height: 300px">
                                <div class="title-wrap" style="margin-bottom: 2px">
                                    <h3>FieldService</h3>
                                    <ul class="tab-links-sub">
                                        <li><a href="#tab15" title="통계" onclick="reload('chart7')">통계</a></li>
                                        <li><a href="#tab16" title="현황">현황</a></li>

                                    </ul>
                                </div>
                                <div class="tab-contents">
                                    <!-- tab3 -->
                                    <div class="tab-item-sub" id="tab15">
                                        <div>
                                            <div id="chartHolder7" style="width: 100%; height: 235px; padding-top: 5px"></div>

                                        </div>
                                    </div>
                                    <!-- tab4 -->
                                    <div class="tab-item-sub" id="tab16">
                                        <div class="container-fluid">
                                            <div id="theGrid71" style="width: 100%; height: 235px"></div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>
                </section>

                <section class="tab-item" id="maintab5">
                    <div class="section-top">
                        <div class="search-wrap">
                            <dl>
                                <dt>
                                    <label for="comparisonType">
                                        비교유형<span class="eq">*</span>
                                    </label>
                                </dt>
                                <dd>
                                    <ul class="date-box">
                                        <li>
                                            <select id="comparisonType" name="comparisonType">
                                                <option value="YoY">YoY</option>
                                                <option value="QoQ">QoQ</option>
                                                <option value="MoM">MoM</option>
                                                <option value="YTD">YTD</option>
                                            </select>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <dl>
                                <dt>
                                    조회기간<span class="eq">*</span>
                                </dt>
                                <dd>
                                    <ul class="date-box" id="dateBoxContainerTab2">
                                        <li id="startDateContainerTab2">
                                            <select id="startDateTab2" name="startDateTab2">
                                                <option value="2022">2022</option>
                                                <option value="2023" selected>2023</option>
                                                <option value="2024">2024</option>
                                            </select>
                                        </li>
                                        <li id="endDateContainerTab2">
                                            <select id="endDateTab2" name="endDateTab2">
                                                <option value="2022">2022</option>
                                                <option value="2023">2023</option>
                                                <option value="2024" selected>2024</option>
                                            </select>
                                        </li>
                                        <li>
                                            <a class="btn btn-delete" title="검색" id="btn-searchTab2"
                                               onclick="searchData2()">
                                                <img src="/images/icon/btn-srch.svg" alt="검색 아이콘">
                                                검색
                                            </a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                        </div>
                    </div> <!--//section-top end -->
                    <div class="row row-2" style="margin-bottom: 10px">
                        <div class="col wp50" style="margin-right: 15px" id="section1">
                            <section class="tab-section section_top" style="height: 300px" onclick="clickfunction()">
                                <div class="title-wrap" style="margin-bottom: 2px">
                                    <h3>순회점검</h3>
                                    <!--<ul class="tab-links-sub">
                                        <li><a href="#YoY1" title="YoY" data-id="chart10" onclick="RunRmateGraph2('chart10')">YoY</a></li>
                                        <li><a href="#QoQ1" title="QoQ" data-id="chart20" onclick="RunRmateGraph2('chart20')">QoQ</a></li>
                                        <li><a href="#MoM1" title="MoM" data-id="chart30" onclick="RunRmateGraph2('chart30')">MoM</a></li>
                                        <li><a href="#YTD1" title="YTD" data-id="chart40" onclick="RunRmateGraph2('chart40')">YTD</a></li>

                                    </ul>-->
                                </div>
                                <div class="tab-contents">
                                    <!-- tab3 -->
                                    <div class="tab-item-sub" id="YoY1" >
                                        <div>
                                            <div id="chartHolder10" style="width: 100%; height: 235px; padding-top: 10px" ></div>
                                        </div>
                                    </div>
                                    <!--<div class="tab-item-sub" id="QoQ1">
                                        <div>
                                            <div id="chartHolder20" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                        </div>
                                    </div>
                                    <div class="tab-item-sub" id="MoM1">
                                        <div>
                                            <div id="chartHolder30" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                        </div>
                                    </div>
                                    <div class="tab-item-sub" id="YTD1">
                                        <div>
                                            <div id="chartHolder40" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                        </div>
                                    </div>-->

                                </div>
                            </section>
                        </div>

                        <div class="col wp50" id="section2">
                            <section class="tab-section section_top" style="height: 300px">
                                <div class="title-wrap" style="margin-bottom: 2px">
                                    <h3>합동안전점검</h3>
                                    <!--<ul class="tab-links-sub">
                                        <li><a href="#YoY2" title="YoY" data-id="chart11" onclick="RunRmateGraph2('chart11')">YoY</a></li>
                                        <li><a href="#QoQ2" title="QoQ" data-id="chart21" onclick="RunRmateGraph2('chart21')">QoQ</a></li>
                                        <li><a href="#MoM2" title="MoM" data-id="chart31" onclick="RunRmateGraph2('chart31')">MoM</a></li>
                                        <li><a href="#YTD2" title="YTD" data-id="chart41" onclick="RunRmateGraph2('chart41')">YTD</a></li>

                                    </ul>-->
                                </div>
                                <div class="tab-contents">
                                    <!-- tab5 -->
                                    <div class="tab-item-sub" id="YoY2">
                                        <div>
                                            <div id="chartHolder11" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                        </div>
                                    </div>
                                    <!--<div class="tab-item-sub" id="QoQ2">
                                        <div>
                                            <div id="chartHolder21" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                        </div>
                                    </div>
                                    <div class="tab-item-sub" id="MoM2">
                                        <div>
                                            <div id="chartHolder31" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                        </div>
                                    </div>
                                    <div class="tab-item-sub" id="YTD2">
                                        <div>
                                            <div id="chartHolder41" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                        </div>
                                    </div>-->

                                </div>
                            </section>
                        </div>
                    </div>



                    <div class="row row-2" style="margin-bottom: 10px">
                        <div class="col wp50" style="margin-right: 15px" id="section3">
                            <section class="tab-section section_top" style="height: 300px;">
                                <div class="title-wrap" style="margin-bottom: 2px">
                                    <h3>전기안전점검</h3>
                                    <!--<ul class="tab-links-sub">
                                        <li><a href="#YoY3" title="YoY" data-id="chart12" onclick="RunRmateGraph2('chart12')">YoY</a></li>
                                        <li><a href="#QoQ3" title="QoQ" data-id="chart22" onclick="RunRmateGraph2('chart22')">QoQ</a></li>
                                        <li><a href="#MoM3" title="MoM" data-id="chart32" onclick="RunRmateGraph2('chart32')">MoM</a></li>
                                        <li><a href="#YTD3" title="YTD" data-id="chart42" onclick="RunRmateGraph2('chart42')">YTD</a></li>

                                    </ul>-->
                                </div>
                                <div class="tab-contents">
                                    <!-- tab3 -->
                                    <div class="tab-item-sub" id="YoY3">
                                        <div>
                                            <div id="chartHolder12" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                        </div>
                                    </div>
                                    <!--<div class="tab-item-sub" id="QoQ3">
                                        <div>
                                            <div id="chartHolder22" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                        </div>
                                    </div>
                                    <div class="tab-item-sub" id="MoM3">
                                        <div>
                                            <div id="chartHolder32" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                        </div>
                                    </div>
                                    <div class="tab-item-sub" id="YTD3">
                                        <div>
                                            <div id="chartHolder42" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                        </div>
                                    </div>-->
                                    <!-- tab4 -->


                                </div>
                            </section>
                        </div>

                        <div class="col wp50" id="section4">
                            <section class="tab-section section_top" style="height: 300px">
                                <div class="title-wrap" style="margin-bottom: 2px">
                                    <h3>비상훈련계획</h3>
                                    <!--<ul class="tab-links-sub">
                                        <li><a href="#YoY4" title="YoY" data-id="chart13" onclick="RunRmateGraph2('chart13')">YoY</a></li>
                                        <li><a href="#QoQ4" title="QoQ" data-id="chart23" onclick="RunRmateGraph2('chart23')">QoQ</a></li>
                                        <li><a href="#MoM4" title="MoM" data-id="chart33" onclick="RunRmateGraph2('chart33')">MoM</a></li>
                                        <li><a href="#YTD4" title="YTD" data-id="chart43" onclick="RunRmateGraph2('chart43')">YTD</a></li>

                                    </ul>-->
                                </div>
                                <div class="tab-contents">
                                    <!-- tab5 -->
                                    <div class="tab-contents">
                                        <!-- tab3 -->
                                        <div class="tab-item-sub" id="YoY4">
                                            <div>
                                                <div id="chartHolder13" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                            </div>
                                        </div>
                                        <!--<div class="tab-item-sub" id="QoQ4">
                                            <div>
                                                <div id="chartHolder23" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                            </div>
                                        </div>
                                        <div class="tab-item-sub" id="MoM4">
                                            <div>
                                                <div id="chartHolder33" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                            </div>
                                        </div>
                                        <div class="tab-item-sub" id="YTD4">
                                            <div>
                                                <div id="chartHolder43" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                            </div>
                                        </div>-->

                                    </div>

                                </div>
                            </section>
                        </div>
                    </div>


                    <div class="row row-2" style="margin-bottom: 10px">
                        <div class="col wp50" style="margin-right: 15px" id="section5">
                            <section class="tab-section section_top" style="height: 300px;">
                                <div class="title-wrap" style="margin-bottom: 2px">
                                    <h3>비상훈련계획</h3>
                                    <!--<ul class="tab-links-sub">
                                        <li><a href="#YoY5" title="YoY" data-id="chart14" onclick="RunRmateGraph2('chart14')">YoY</a></li>
                                        <li><a href="#QoQ5" title="QoQ" data-id="chart24" onclick="RunRmateGraph2('chart24')">QoQ</a></li>
                                        <li><a href="#MoM5" title="MoM" data-id="chart34"  onclick="RunRmateGraph2('chart34')">MoM</a></li>
                                        <li><a href="#YTD5" title="YTD" data-id="chart44" onclick="RunRmateGraph2('chart44')">YTD</a></li>

                                    </ul>-->
                                </div>
                                <div class="tab-contents">
                                    <!-- tab3 -->
                                    <div class="tab-item-sub" id="YoY5">
                                        <div>
                                            <div id="chartHolder14" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                        </div>
                                    </div>
                                    <!--<div class="tab-item-sub" id="QoQ5">
                                        <div>
                                            <div id="chartHolder24" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                        </div>
                                    </div>
                                    <div class="tab-item-sub" id="MoM5">
                                        <div>
                                            <div id="chartHolder34" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                        </div>
                                    </div>
                                    <div class="tab-item-sub" id="YTD5">
                                        <div>
                                            <div id="chartHolder44" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                        </div>
                                    </div>-->
                                    <!-- tab4 -->


                                </div>
                            </section>
                        </div>

                        <div class="col wp50" id="section6">
                            <section class="tab-section section_top" style="height: 300px">
                                <div class="title-wrap" style="margin-bottom: 2px">
                                    <h3>안전보건교육</h3>
                                    <!--<ul class="tab-links-sub">
                                        <li><a href="#YoY6" title="YoY" data-id="chart15" onclick="RunRmateGraph2('chart15')">YoY</a></li>
                                        <li><a href="#QoQ6" title="QoQ" data-id="chart25" onclick="RunRmateGraph2('chart25')">QoQ</a></li>
                                        <li><a href="#MoM6" title="MoM" data-id="chart35" onclick="RunRmateGraph2('chart35')">MoM</a></li>
                                        <li><a href="#YTD6" title="YTD" data-id="chart45" onclick="RunRmateGraph2('chart45')">YTD</a></li>

                                    </ul>-->
                                </div>
                                <div class="tab-contents">
                                    <!-- tab5 -->
                                    <div class="tab-contents">
                                        <!-- tab3 -->
                                        <div class="tab-item-sub" id="YoY6">
                                            <div>
                                                <div id="chartHolder15" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                            </div>
                                        </div>
                                        <!--<div class="tab-item-sub" id="QoQ6">
                                            <div>
                                                <div id="chartHolder25" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                            </div>
                                        </div>
                                        <div class="tab-item-sub" id="MoM6">
                                            <div>
                                                <div id="chartHolder35" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                            </div>
                                        </div>
                                        <div class="tab-item-sub" id="YTD6">
                                            <div>
                                                <div id="chartHolder45" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                            </div>
                                        </div>-->

                                    </div>

                                </div>
                            </section>
                        </div>
                    </div>


                    <div class="row row-2" style="margin-bottom: 10px">
                        <div class="col wp50" style="margin-right: 15px" id="section7">
                            <section class="tab-section section_top" style="height: 300px;">
                                <div class="title-wrap" style="margin-bottom: 2px">
                                    <h3>FieldService</h3>
                                    <!--<ul class="tab-links-sub">
                                        <li><a href="#YoY7" title="YoY" data-id="chart16" onclick="RunRmateGraph2('chart16')">YoY</a></li>
                                        <li><a href="#QoQ7" title="QoQ" data-id="chart26" onclick="RunRmateGraph2('chart26')">QoQ</a></li>
                                        <li><a href="#MoM7" title="MoM" data-id="chart36" onclick="RunRmateGraph2('chart36')">MoM</a></li>
                                        <li><a href="#YTD7" title="YTD" data-id="chart46" onclick="RunRmateGraph2('chart46')">YTD</a></li>

                                    </ul>-->
                                </div>
                                <div class="tab-contents">
                                    <!-- tab3 -->
                                    <div class="tab-item-sub" id="YoY7">
                                        <div>
                                            <div id="chartHolder16" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                        </div>
                                    </div>
                                    <!--<div class="tab-item-sub" id="QoQ7">
                                        <div>
                                            <div id="chartHolder26" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                        </div>
                                    </div>
                                    <div class="tab-item-sub" id="MoM7">
                                        <div>
                                            <div id="chartHolder36" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                        </div>
                                    </div>
                                    <div class="tab-item-sub" id="YTD7">
                                        <div>
                                            <div id="chartHolder46" style="width: 100%; height: 235px; padding-top: 10px"></div>
                                        </div>
                                    </div>-->
                                    <!-- tab4 -->


                                </div>
                            </section>
                        </div>


                    </div>
                </section>
            </div> <!--//tab-contens end-->
            <div style="height: 50px">

            </div>
        </div> <!--//tab-wrap end-->
    </div> <!--//layout-contents end -->

    <!-- 팝업 -->
    <div class="modal">
        <div class="popup-wrapper w700" id="popup1">
            <div class="popup-title">
                <h3>점검일지 업로드</h3>
                <a title="팝업닫기" onclick="closePopup()" class="btn-popup-close">
                    <img src="/images/icon/btn-popup-close.svg" alt="닫기">
                </a>
            </div>
            <div class="popup-contents">
                <div class="table-wrap">
                    <table class="write-table">
                        <caption>점검등록 테이블</caption>
                        <colgroup>
                            <col class="wp20">
                            <col class="wp80">
                        </colgroup>
                        <input type="hidden" id="popup-spuncode">
                        <tbody>
                        <tr>
                            <th>
                                <label for="date6">등록일자</label>
                            </th>
                            <td>
                                <div class="input-clear">
                                    <input type="text" id="popup-date" readonly>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <th>
                                <label for="popup-checkusr">점검자</label>
                            </th>
                            <td>
                                <div class="input-clear">
                                    <input type="text" id="popup-checkusr" readonly class="wp60" placeholder="점검자">
                                    <span class="btn-clear">×</span>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <th>
                                <label>점검장소</label>
                            </th>
                            <td>
                                <div class="input-clear">
                                    <input type="text" id="popup-checkarea" readonly class="wp100" placeholder="점검장소">
                                    <span class="btn-clear">×</span>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <th>첨부파일</th>
                            <td>
                                <div id="uploadComponent2" class="upload-component">
                                    <div class="upload-filebox" id="dropZone">
                                        <img src="/images/icon/ico-fileupload.svg" alt="업로드아이콘">
                                        <a class="btn" title="파일업로드">파일업로드</a>
                                        <input type="file" id="fileInput2" name="filelist2"  class="fileInput2">
                                        <p id="fileNameDisplay">Maximun upload file size 1GiB</p>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="popup-button">
                <button onclick="closePopup()" style="border: 1px solid #03428E !important; font-size: 15px !important;">취소</button>
                <button onclick="saveFile()" style="border: 1px solid #03428E !important;color: white;background: #03428E !important;font-size: 15px !important;">저장</button>
            </div>
        </div>
    </div>


    <!-- 사용법 팝업 -->
    <div class="modal2">
        <div class="modal_popup">
            <h3 style="text-align: center; margin-bottom: 20px">화면 설명서(목록탭)</h3>
            <img src="/images/순회점검%20(2).png" style="margin-bottom: 20px" />
            <p style="margin-bottom: 8px">1. 등록 일자, 점검자, 점검 여부 등의 조건을 통해 검색하여 조회할 수 있습니다.</p>
            <p style="margin-bottom: 8px">2. 그리드 좌측에 선택기를 통하여 하나 혹은 여러 개를 선택하여 삭제할 수 있습니다.</p>
            <p style="margin-bottom: 8px">3. 그리드 좌측에 선택기를 통하여 하나를 선택하여 수정할 수 있습니다. 등록탭이 수정탭으로 변경하며 이동됩니다.</p>
            <p style="margin-bottom: 8px">4. 그리드 좌측에 선택기를 통하여 하나 혹은 여러 개를 선택하여 출력할 수 있습니다. 등록할 때의 정보와 이미지 파일을 바탕으로 PDF 파일로 변환되어 압축파일로 다운로드 됩니다.</p>
            <p style="margin-bottom: 8px">5. 그리드의 칼럼은 일자순 혹은 숫자 순 혹은 글자 순으로 정렬할 수 있습니다.</p>
            <p style="margin-bottom: 8px">6. 버튼 클릭시 모달창이 나오며 하나의 PDF파일을 등록할 수 있습니다. (그 외 정보는 변경불가능)</p>
            <p style="margin-bottom: 8px">7. 버튼 클릭시 등록한 pdf파일을 다운로드 받을 수 있습니다.</p>

            <h3 style="text-align: center; margin: 20px auto">화면 설명서(등록탭)</h3>
            <img src="/images/순회점검_등록%20(1).png" style="margin-bottom: 20px" />
            <p style="margin-bottom: 8px">1. 수급사명, 점검장소는 입력칸입니다. 등록일자, 점검시작일자, 점검종료일자는 달력 아이콘을 누르면 달력이 나와 날짜 선택이 가능합니다. 점검자는 우측에 점검자 추가 버튼을 통해 추가 가능합니다.</p>
            <p style="margin-bottom: 8px">2. 점검결과부분은 클릭하면 O 혹은 X로 변경됩니다. 개선사항은 입력칸입니다.</p>
            <p style="margin-bottom: 8px">3. 파일업로드를 클릭하여 여러개의 파일을 업로드 가능합니다. (Drag&Drop 지원) 하단의 내가 올린 파일목록을 볼 수 있습니다.</p>
            <p style="margin-bottom: 8px">4. 정보입력이 완료되었다면 저장버튼을 클릭하여 저장됩니다.</p>

            <h3 style="text-align: center; margin: 20px auto">화면 설명서(수정탭)</h3>
            <img src="/images/순회점검_수정%20(1).png" style="margin-bottom: 20px" />
            <p style="margin-bottom: 8px">1. 목록탭에서 하나의 게시물을 선택하여 수정버튼을 클릭시 기존에 등록이었던 텍스트가 수정으로 변경됩니다.</p>
            <p style="margin-bottom: 8px">2. 저장시에 입력했던 입력 사항이 나오며 수정을 원할 경우 변경하면 됩니다.</p>
            <p style="margin-bottom: 8px">3. 저장시에 입력했던 입력 사항이 나오며 수정을 원할 경우 변경하면 됩니다.</p>
            <p style="margin-bottom: 8px">4. 저장시에 저장했던 파일목록들이 나오며 수정을 원할 경우 추가 및 삭제를 통해 첨부된 파일을 수정 할 수 있습니다.</p>
            <p style="margin-bottom: 8px">5. 정보들을 모두 입력완료되었다면 저장 버튼을 클릭할시 변경된 사항이 저장됩니다.</p>
            <p style="margin-bottom: 8px">6. 신규등록 버튼을 클릭시 등록탭으로 변경되며 수정에서 등록기능으로 변경됩니다.</p>

            <button style="border: 1px solid #03428E !important; font-size: 15px !important; position: absolute; top: 10px; right: 10px" class="close_btn">닫기</button>
        </div>
    </div>

    <!-- 파일 첨부 팝업 -->

    <div class="modal3">
        <div class="popup-wrapper3 w700" id="popup2">
            <div class="popup-title">
                <h3>파일 업로드</h3>
                <a title="팝업닫기" onclick="closeFilePopup()" class="btn-popup-close">
                    <img src="/images/icon/btn-popup-close.svg" alt="닫기">
                </a>
            </div>
            <div class="popup-contents">
                <div class="table-wrap">
                    <table class="write-table">
                        <caption>점검등록 테이블</caption>
                        <colgroup>
                            <col class="wp20">
                            <col class="wp80">
                        </colgroup>
                        <tbody>
                        <tr>
                            <th>
                                첨부파일
                            </th>
                            <td colspan="3">
                                <div id="uploadComponent1" class="upload-component">
                                    <div class="upload-filebox">
                                        <img src="/images/icon/ico-fileupload.svg" alt="업로드아이콘">
                                        <a class="btn" title="파일업로드">파일업로드</a>
                                        <input type="file" id="fileInput1" class="fileInput" multiple>
                                        <p>Maximun upload file size <span>1GiB</span></p>
                                    </div>
                                    <div class="upload-filelist">
                                        <div class="title">
                                            <h5>Files (0)</h5>
                                            <a title="Delete all" class="btn-file-deleteall">Delete
                                                all</a>
                                        </div>
                                        <ul class="filelist" id="filelist">
                                        </ul>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="popup-button">
                <button onclick="closeFilePopup()" style="border: 1px solid #03428E !important; font-size: 15px !important;">닫기</button>

            </div>
        </div>
    </div>



</th:block>
<th:block layout:fragment="scripts">
    <th:block th:replace="/common/approve_box :: approve_box"></th:block>
    <th:block th:replace="/common/ax5_uploader :: ax5_uploader" ></th:block>
    <th:block th:replace="/common/upload_one_image_box :: upload_one_image_box" ></th:block>
    <th:block th:replace="/common/popup_select_user_code :: popup_select_user_code"></th:block>



    <script>

       /* var player = videojs('video', {
            autoplay: true,
            controls: true,
            muted: true,  // 비디오를 무음으로 설정
            preload: 'auto'
        });
        player.src({
            src: 'http://121.78.112.192:9000/hls/stream1.m3u8',
            type: 'application/x-mpegURL'
        });

        var player2 = videojs('video2', {
            autoplay: true,
            controls: true,
            muted: true,  // 비디오를 무음으로 설정
            preload: 'auto'
        });
        player2.src({
            src: 'http://121.78.112.192:9000/hls/streaming1.m3u8',
            type: 'application/x-mpegURL'
        });

        var player3 = videojs('video3', {
            autoplay: true,
            controls: true,
            muted: true,  // 비디오를 무음으로 설정
            preload: 'auto'
        });
        player3.src({
            src: 'http://121.78.112.192:9000/hls/streamer.m3u8',
            type: 'application/x-mpegURL'
        });

        var player4 = videojs('video4', {
            autoplay: true,
            controls: true,
            muted: true,  // 비디오를 무음으로 설정
            preload: 'auto'
        });
        player4.src({
            src: 'http://121.78.112.192:9000/hls/streamute.m3u8',
            type: 'application/x-mpegURL'
        });*/

        /* // WebSocket 연결 설정
         var client = new WebSocket('ws://localhost:9999');
         var canvas = document.querySelector('canvas');
         var player = new jsmpeg(client, {
             canvas: canvas
         });

         // 두 번째 WebSocket 연결
         var client2 = new WebSocket('ws://localhost:10000');
         var canvas2 = document.getElementById('canvas2');
         var player2 = new jsmpeg(client2, {
             canvas: canvas2
         });

         // 두 번째 WebSocket 연결
         var client3 = new WebSocket('ws://localhost:10001');
         var canvas3 = document.getElementById('canvas3');
         var player3 = new jsmpeg(client3, {
             canvas: canvas3
         });

         // 두 번째 WebSocket 연결
         var client4 = new WebSocket('ws://localhost:10002');
         var canvas4 = document.getElementById('canvas4');
         var player4 = new jsmpeg(client4, {
             canvas: canvas4
         });*/



        let theGrid3;

        let theGrid2;


        let columns1 = [
            { binding: 'inspectypeCode', header: '점검구분', visible: false },
            { binding: 'inspectype', header: '점검구분', width: '0.5*', minWidth: 150, align: 'center' },
            { binding: 'inspecarea', header: '점검장소', width: '0.5*', minWidth: 150, align: 'center' },
            { binding: 'checkusr', header: '점검자', width: '*',minWidth: 150, align: 'center' },
            { binding: 'checkdt', header: '점검자', width: '*',minWidth: 150, align: 'center' },

        ]
        let columns2 = [
            { binding: 'inspectypeCode', header: '점검구분', visible: false },
            { binding: 'checkdt', header: '점거일자', width: '0.5*', minWidth: 150, align: 'center' },
            { binding: 'inspectype', header: '점검구분', width: '*', minWidth: 150, align: 'center' },
            { binding: 'inspecarea', header: '점검장소', width: '*', minWidth: 150, align: 'center' },
            { binding: 'checkhour', header: '점검시간', width: '*', minWidth: 150, align: 'center' },

        ]

        function BlankOpen(dicType, checkdt) {

            // 절대 경로 URL
            var url = `/gui/${dicType}/default?hideBookmark=true&checkdt=${checkdt}`;

            // 팝업 옵션 설정
            var options = "width=1400,height=700,scrollbars=yes,resizable=yes";

            // 새 창 열기
            var newWindow = window.open(url, "_blank", options);


        }

        function init1(date){
            let data2 = [];
            $.ajax({
                url: '/api/reportEvents/read',
                type: 'GET',
                data: { date: date },
                async: false,
                success: function (data) {
                    let DataLength = 10 - data.data.length;

                    if(data.data.length < 10){
                        for(let i=0; i < DataLength; i++){
                            data.data.push('empty');
                        }
                    }



                    data2 = data.data;
                }
            })

            viewdata = new wijmo.collections.CollectionView(data2);
            // 데이터 그리드에 바인딩

            if(!theGrid3) {
                theGrid3 = new wijmo.grid.FlexGrid('#theGrid3', {
                    autoGenerateColumns: false,
                    isReadOnly: true,
                    showMarquee: true,
                    allowSorting: 'MultiColumn',
                    columns: columns1,  //홀짝 로우 음영주기
                    selectionMode: wijmo.grid.SelectionMode.Row, // 행 단위 선택
                    itemsSource: viewdata,

                });
                //맨 앞에 헤더부분 없애기
                theGrid3.rowHeaders.columns.splice(0, 1);

                // 더블클릭 이벤트 추가
                theGrid3.hostElement.addEventListener('dblclick', function(e) {
                    let hitTest = theGrid3.hitTest(e);
                    if (hitTest.cellType === wijmo.grid.CellType.Cell) {
                        let row = hitTest.row;
                        let item = theGrid3.rows[row].dataItem;

                        BlankOpen(item.inspectypecode, item.checkdt);
                    }
                });


            } else {
                theGrid3.itemsSource = viewdata;
            }

        }

        function init2(date){

            let data2 = [];
            $.ajax({
                url: '/api/reportEvents/MonthAllRead',
                type: 'GET',
                data: { date: date },
                async: false,
                success: function (data) {
                    let DataLength = 15 - data.data.length;




                    if(data.data.length < 15){
                        for(let i=0; i < DataLength; i++){
                            data.data.push('empty');
                        }
                    }
                    data2 = data.data;


                    data2 = data2.map(item => {
                        return{
                            ...item,
                            checkdt: formatDate(item.checkdt)
                        };
                    });

                }
            })

            viewdata2 = new wijmo.collections.CollectionView(data2);
            // 데이터 그리드에 바인딩

            if(!theGrid2) {
                theGrid2 = new wijmo.grid.FlexGrid('#theGrid2', {
                    autoGenerateColumns: false,
                    isReadOnly: true,
                    showMarquee: true,
                    allowSorting: 'MultiColumn',
                    columns: columns2,  //홀짝 로우 음영주기
                    selectionMode: wijmo.grid.SelectionMode.Row, // 행 단위 선택
                    itemsSource: viewdata2,

                });

                theGrid2.rowHeaders.columns.splice(0, 1);  //맨 앞에 헤더부분 없애기

                // 더블클릭 이벤트 추가
                theGrid2.hostElement.addEventListener('dblclick', function(e) {
                    let hitTest = theGrid2.hitTest(e);
                    if (hitTest.cellType === wijmo.grid.CellType.Cell) {
                        let row = hitTest.row;
                        let item = theGrid2.rows[row].dataItem;

                        BlankOpen(item.inspectypecode, item.checkdt);
                    }
                });
            } else {
                theGrid2.itemsSource = viewdata2;
            }

        }

        document.addEventListener('DOMContentLoaded', function () {

            init1(getDateYYYYMMDD().replaceAll("-",""));  //TODO: 고치셈 ㅋ
            init2(getDateYYYYMMDD());


            document.getElementById('current').addEventListener('click', function(){
                setTimeout(function(){
                    const monthViewButton = document.querySelector('button[title="month view"]');
                    if (monthViewButton) {
                        monthViewButton.click();
                    } else {
                        console.error('title="month view" 버튼을 찾을 수 없습니다.');
                    }
                }, 10)

            })


            const today = new Date();
            const specificMonth = getMonth(today);

            $('#StatusTitle').text(specificMonth + '월 순회점검현황');
            $('#MonthInpsecTitle').text(specificMonth + '월 점검현황');


            let fnsuccess = function(res){

                $('#totalCount').text(res.data[0].total_count ? res.data[0].total_count : '0');
                $('#yCount').text(res.data[0].flag_y_count ? res.data[0].flag_y_count : '0');
                $('#nCount').text(res.data[0].flag_n_count ? res.data[0].flag_n_count : '0');



            };
            let fnfailure = function(res){
                Alert.alert('', '서버통신실패');

            };

            var calendarEl = document.getElementById('calendar');

            // 서버에서 데이터를 가져옴
            fetch('/api/reportEvents/Calendar')
                .then(response => response.json())
                .then(data => {

                    let events=  [];

                    data.data.forEach(function(item, index){
                        events.push({
                            title: item.inspection_type + '(' + item.count + ')',
                            start: item.checkdt,
                            /*extendedProps: {
                                message: '',
                                action: function(){

                                }
                            }*/
                        });
                    });

                    // FullCalendar 설정
                    var calendar = new FullCalendar.Calendar(calendarEl, {
                        locale: 'ko',  // 한국어 로케일 설정
                        headerToolbar: {
                            left: 'prev,next today',
                            center: 'title',
                            right: 'dayGridMonth,timeGridWeek,timeGridDay'
                        },
                        initialView: 'dayGridMonth',
                        height: 670,

                        dayHeaderFormat: {weekday: 'short'}, // 요일 형식 설정
                        events: events,
                        views: {
                            dayGridMonth: {
                                dayCellContent: function (arg) {
                                    // '일' 텍스트 제거
                                    return arg.dayNumberText.replace('일', '');
                                }
                            }
                        },
                        /*eventClick: function(info) {
                            // 이벤트 클릭 시 alert 창 띄우기
                            if(typeof info.event.extendedProps.action === 'function'){
                                info.event.extendedProps.action();
                            } else {
                                console.log('5일이나 안녕하세요 클릭한듯 ㅋ');
                            }
                        },*/
                        datesSet: function(dateInfo){
                            let currentDate = calendar.getDate();
                            let currentYear = currentDate.getFullYear();
                            let currentMonth = currentDate.getMonth() + 1;




                            $('#StatusTitle').text(currentMonth + '월 순회점검 현황');

                            let data = { year: currentYear, month: currentMonth }

                            AjaxUtil.getAsyncData('/api/reportEvents/Inspection/status', data, fnsuccess, fnfailure);

                            $('#MonthInpsecTitle').text(currentMonth + '월 점검현황');

                            let monthString = '';

                            if(currentMonth.toString().length < 2){
                                monthString = '0' + currentMonth.toString();
                            }else{
                                monthString = currentMonth.toString();
                            }

                            init2(currentYear.toString() + monthString + "15");



                        },
                        dateClick: function(info) {

                            document.querySelectorAll('.fc-daygrid-day').forEach(function(cell) {
                                cell.classList.remove('selected-date');
                            });

                            // 클릭한 날짜 셀에 'selected-date' 클래스 추가
                            info.dayEl.classList.add('selected-date');
                            let date = info.dateStr;

                            $('#InspectionDetails').text(date.substring(8,10) + '일 점검현황');

                            init1(date.replaceAll('-',''));
                        }
                    });

                    calendar.render();
                })
                .catch(error => console.error('Error fetching events:', error));
        });

    </script>


    <script type="text/javascript">



        const modal2 = document.querySelector('.modal2');
        const modalOpen = document.querySelector('.modal_btn');
        const modalClose = document.querySelector('.close_btn');

        const Filemodal = document.querySelector('.modal3');
        const modalFileOpen = document.querySelector('.file_btn');


        //열기 버튼을 눌렀을 때 모달팝업이 열림
        modalOpen.addEventListener('click',function(){
            //display 속성을 block로 변경
            modal2.style.display = 'block';
        });
        //닫기 버튼을 눌렀을 때 모달팝업이 닫힘
        modalClose.addEventListener('click',function(){
            //display 속성을 none으로 변경
            modal2.style.display = 'none';
        });

        modalFileOpen.addEventListener('click', function(){
            Filemodal.style.display = 'block';
        });



        var theGrid;
        var viewdata;
        let selectedFiles = [];
        let SelectItem;
        let csrfToken = $("[name=_csrf]").val();

        var columns = [
            { binding: 'spworknm', header: '지역명', align: 'center', width: '0.5*', minWidth: 140 },
            { binding: 'spcompnm', header: '산단명', align: 'center', width: '0.5*', minWidth: 140 },
            { binding: 'spplannm', header: '발전소명', align: 'center', width: '*', minWidth: 140 },
            { binding: 'checkdt', header: '등록일자', align: 'center', width: '*', minWidth: 130 },
            { binding: 'checkusr', header: '점검자', align: 'center', width: '0.5*', minWidth: 130 },
            { binding: 'checkarea', header: '점검장소', align: 'center', width: '*', minWidth: 200 },
            { binding: 'checktmdt', header: '점검시간', align: 'center', width: '*', minWidth: 250 },
            { binding: 'downloads', header: '다운로드', align: 'center', width: '*', minWidth: 200 },
            { binding: 'upload', header: '점검일지 업로드', align: 'center', width: '*', minWidth: 140 },
            { binding: 'fileornm', header: '대표파일명', align: 'center', width: 0, minWidth: 0, maxWidth: 0 },
            /*{ binding: 'downloads', header: '다운로드', align: 'center', width: '*', minWidth: 200,
                cellTemplate: /!*'<a title="다운로드" class="btn-filedown">다운로드</a>'*!/
                    wijmo.grid.cellmaker.CellMaker.makeButton({
                        text: '<a title="다운로드" class="btn-filedown">다운로드</a>',
                        cssClass: 'fileuploaders',
                        click: (e, ctx) => {

                            FileDownload(ctx);
                        },
                    })
            },*/
            /*{
                header: '점검일지 업로드', binding: 'upload', width: '*', minWidth: 140, align: 'center',
                cellTemplate: /!*'<a title="업로드" onclick="showPopup()" class="btn btn-popup-open" data-popup="popup1">업로드</a>'*!/
                    wijmo.grid.cellmaker.CellMaker.makeButton({
                        text: '<a title="업로드" class="btn btn-popup-open" data-popup="popup1">업로드</a>',
                        cssClass: 'fileuploaders',
                        click: (e, ctx) => {
                            showPopup(ctx);
                        }
                    })


            }*/
        ];



        /**점검일지 업로드(파일만 전송)**/
        function saveFile(){
            let file = document.getElementById('fileInput2');
            let formData = new FormData();

            if(file.files.length === 0){
                Alert.alert('', '파일을 첨부해주세요.');
                return false;
            }

            formData.append('file', file.files[0]);
            formData.append('_csrf', csrfToken);
            formData.append('spuncode', $('#popup-spuncode').val());

            AjaxFunction.PostAjaxRequest(
                '/api/inspec_report/filesave',
                true, // async
                false, // contentType
                false, // processData
                formData,
                function (res){
                    Alert.alert('', res.message);
                    closePopup();
                    searchData();
                },
                fnFailure
            );
        }

        function clearForm(){

            let dataset = DataLoad('/api/inspec_report/recentData', '').data;

            console.log('zzzzzz', dataset);

            ['checkdt', 'checkstdt', 'checkendt',
                'inspecreform1', 'inspecreform2', 'inspecreform3', 'inspecreform4', 'inspecreform5', 'inspecreform6'
            ].forEach(id => {
                document.getElementById(id).value = '';
            });

            document.getElementById('checkarea').value = dataset.checkarea;
            document.getElementById('checkusr').value = dataset.checkusr;
            document.getElementById('supplier').value = dataset.supplier;

            ['inspecresult1', 'inspecresult2', 'inspecresult3', 'inspecresult4', 'inspecresult5', 'inspecresult6'
            ].forEach(id => {
                document.getElementById(id).textContent = 'O';
            });
            $('#spuncode').val('');
            $('.filelist').empty();



            uploadedFiles = [];
            deletedFiles = [];
            updateTabLink('spuncode');
            updateFileCount();
            resetFileInput($('.fileInput'));
            resetAddedInputFields();
        }
        // 파일 인풋 초기화
        function resetFileInput($input) {
            $input.val('');
        }

        function submitTextarea(event){
            let key = event.key || event.keyCode;

            if(key === 'Enter' || key == 13){
                searchData();
            }
        }

        let searchusrval = document.getElementById('searchusr');
        searchusrval.addEventListener('keyup', event => submitTextarea(event))


        function closePopup(){

            const modal = document.querySelector('.modal');
            const modalContent = document.querySelector('.popup-wrapper');

            // 애니메이션을 위한 클래스 제거
            modal.classList.remove('show');
            modalContent.classList.remove('show');

            // 애니메이션이 끝난 후 모달을 숨기기 위해 타임아웃 설정
            setTimeout(() => {
                modal.style.display = 'none';
                modalContent.style.display = 'none';
            }, 300); // 애니메이션 지속 시간 (0.3초)과 동일하게 설정
        }

        function closeFilePopup(){
            const modal = document.querySelector('.modal3');

            modal.style.display = 'none';
        }

        function showPopup(rowIndex){

            let item = theGrid.rows[rowIndex].dataItem;
            let fileNameDisplay = document.getElementById('fileNameDisplay');

            $('#popup-date').val(item.checkdt);
            $('#popup-checkusr').val(item.checkusr);
            $('#popup-checkarea').val(item.checkarea);
            $('#popup-spuncode').val(item.spuncode);

            if(item.fileornm){
                fileNameDisplay.textContent = item.fileornm;
            }else{
                fileNameDisplay.textContent = 'Maxium upload file size 1GiB';
            }
            const modal = document.querySelector('.modal');
            const modalContent = document.querySelector('.popup-wrapper');

            // 모달과 콘텐츠를 표시
            modal.style.display = 'block';
            modalContent.style.display = 'block';

            // 애니메이션을 위한 클래스 추가
            requestAnimationFrame(() => {
                modal.classList.add('show');
                modalContent.classList.add('show');
            });
        }

        function showPopup2(){

            const modal = document.querySelector('.modal3');
            const modalContent = document.querySelector('.popup-wrapper3');

            // 모달과 콘텐츠를 표시
            modal.style.display = 'block';
            modalContent.style.display = 'block';

            // 애니메이션을 위한 클래스 추가
            requestAnimationFrame(() => {
                modal.classList.add('show');
                modalContent.classList.add('show');
            });
        }


        function FileDownload(rowIndex){
            //let spuncode = { spuncode: ctx.item.spuncode };

            var item = theGrid.rows[rowIndex].dataItem;
            // 다운로드 로직 처리


            let spuncode = { spuncode: item.spuncode }

            postFetchRequest('/api/inspec_report/FileDownload', spuncode, function(blob) {
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'modified_documents.pdf'; // 다운로드 받을 zip 파일 이름
                document.body.appendChild(a);
                a.click();
                a.remove();
                window.URL.revokeObjectURL(url); // URL 객체 해제
            }, function(error) {
                console.error('There was a problem with the fetch operation:', error);
                Alert.alert('', error.message);
            });
        }

        document.readyState === 'complete' ? init() : window.onload = init;


        document.getElementById('spworkcd').addEventListener('change', searchData);
        document.getElementById('spcompcd').addEventListener('change', searchData);
        document.getElementById('spplancd').addEventListener('change', searchData);


        <!-- 초반 페이지 진입시 그리드 바인딩 끝-->
        function init() {

            initializeSelections();

            let data2 = [];

            let checkdt = $('#checkdtParam').val().trim();

            if(checkdt !== null && checkdt !== ''){



                let searchdate = checkdt.slice(0, 4) + "-" + checkdt.slice(4, 6) + "-" + checkdt.slice(6, 8);

                document.getElementById("searchfrdate").value = searchdate;
                document.getElementById("searchtodate").value = searchdate;

            }else{


                document.getElementById("searchfrdate").value = getDateYYYYMMDD().slice(0, 7) + "-" + "01";
                document.getElementById("searchtodate").value = getLastDayOfCurrentMonth();
            }


            let searchusr = $('#searchusr').val();

            $.ajax({
                url: '/api/inspec_report/read',
                type: 'GET',
                data: {
                    'spplancd' : $('#spplancd').val(),
                    'spcompcd' : $('#spcompcd').val(),
                    'spworkcd' : $('#spworkcd').val(),
                    'searchusr' : searchusr,
                    'searchfrdate' : $('#searchfrdate').val(),
                    'searchtodate' : $('#searchtodate').val()

                },
                async: false,
                success: function(data){

                    /*let DataLength = 15 - data.data.length;

                    if(data.data.length < 15){

                        for(let i=0; i < DataLength; i++){
                            data.data.push('empty');
                        }
                    }*/
                    data2 = data.data;

                }
            })

            viewdata = new wijmo.collections.CollectionView(data2);
            // 데이터 그리드에 바인딩
            theGrid = new wijmo.grid.FlexGrid('#theGrid', {
                autoGenerateColumns: false,
                showMarquee: true,
                columns: columns,
                allowSorting: 'MultiColumn',
                isReadOnly: true,
                selectionMode: wijmo.grid.SelectionMode.Row, // 행 단위 선택
                itemsSource: viewdata,
                formatItem: function(s, e) {
                    if (e.panel.cellType === wijmo.grid.CellType.Cell) {
                        var col = s.columns[e.col];
                        var item = s.rows[e.row].dataItem;
                        if (col.binding === 'downloads') {
                            if (item && item.downloads) {
                                e.cell.innerHTML = '<a class="btn-filedown" onclick="FileDownload(' + e.row + ')">다운로드</a>';
                            } else {
                                e.cell.innerHTML = ''; // 다운로드 버튼이 표시되지 않도록 빈 문자열 설정
                            }
                        }else if(col.binding === 'upload') {
                            if (item && item.upload) {
                                e.cell.innerHTML = '<button type="button" class="wj-cell-maker fileuploaders"><a title="업로드" class="btn btn-popup-open" onclick="showPopup(' + e.row + ')" data-popup="popup1">업로드</a></button>';
                            } else {
                                e.cell.innerHTML = ''; // 다운로드 버튼이 표시되지 않도록 빈 문자열 설정
                            }
                        }
                    }
                }
            });

            /*theGrid.formatItem.addHandler(function (s, e) {
                console.log("s: ", s)

                /!*if(s._rows)*!/
            })*/
            //컨텍스트 메뉴
            new FlexGridContextMenu(theGrid);
            window.downloadFileName = '순회점검';

            let selector = new wijmo.grid.selector.Selector(theGrid, {
                itemChecked: (e, ctx) => {
                    SelectItem = theGrid.rows.filter(r => r.isSelected);

                }
            })

            theGrid.hostElement.addEventListener('dblclick', function(e){
                let hitTest = theGrid.hitTest(e);
                if (hitTest.cellType === wijmo.grid.CellType.Cell) {
                    let row = hitTest.row;
                    let item = theGrid.rows[row].dataItem;


                    if(item === 'empty' || item.checkdt === undefined){ return; }

                    if(theGrid.rows.filter(r => r.isSelected).length > 0){

                        Alert.alert('', '선택기에 선택된 값이 있습니다.');
                        return false;
                    }
                    let spuncode = item.spuncode;
                    let jsonSpunCode = JSON.stringify(spuncode);

                    AjaxFunction.PostAjaxRequest('/api/inspec_report/modfind', false, 'application/json', true, jsonSpunCode, function (data) {

                        let inputFields = document.querySelectorAll('.addusr');
                        if (inputFields) {

                            inputFields.forEach(r => {
                                deleteInputField(r);
                            })

                        }

                        let data2 = data.data;

                        $('#inputTabLink').click();

                        let str = data2.checkdt;
                        let year = str.substring(0, 4);
                        let month = str.substring(4, 6);
                        let day = str.substring(6, 8);

                        let formattedDate = `${year}-${month}-${day}`;

                        document.getElementById('spuncode').value = data2.spuncode;
                        document.getElementById('supplier').value = data2.supplier;
                        document.getElementById('checkdt').value = formattedDate;
                        document.getElementById('checkstdt').value = data2.checkstdt;
                        document.getElementById('checkendt').value = data2.checkendt;
                        document.getElementById('checkusr').value = data2.checkusr;
                        document.getElementById('checkusr').value = data2.checkusr;
                        document.getElementById('checkarea').value = data2.checkarea;




                        for (let i = 0; i < data2.inspecitem.length; i++) {
                            updateElementText('inspecresult', i, data2.inspecitem[i].inspecresult);
                            updateElementText('inspecreform', i, data2.inspecitem[i].inspecreform);

                            let str = "seq" + (i+1);
                            document.getElementById(str).value = data2.inspecitem[i].seq;

                        }


                        //탭 수정으로 업더이트
                        updateTabLink('spuncode');

                        let fileList = Array.isArray(data2.filelist) ? data2.filelist : [];
                        deletedFiles = [];
                        uploadedFiles = [];
                        $('.filelist').empty(); // 파일 리스트 초기화

                        fileList.forEach(file => {
                            let newFile = {
                                name: file.fileornm,
                                size: file.filesize,
                                type: file.fileextns,
                                spuncode_id: file.spuncode_id,
                                checkseq: file.checkseq,
                                filepath: file.filepath,
                                filesvnm: file.filesvnm

                            };
                            uploadedFiles.push(newFile); // 파일 리스트에 추가
                        });
                        console.log('파일목록확인', uploadedFiles)
                        updateFileListUI();
                        updateFileCount();

                    }, fnFailure)

                }
            })

            // 선택이 변경될 때, 현재 항목 업데이트

            //theGrid.rowHeaders.columns.splice(0,1);  //맨 앞에 헤더부분 없애기
        }
        <!-- 초반 페이지 진입시 그리드 바인딩 끝-->

        let filelist = [];



        //검색
        function searchData(){
            let data = {
                'searchusr' : $('#searchusr').val(),
                'searchfrdate': $('#searchfrdate').val(),
                'searchtodate': $('#searchtodate').val(),
                'searchflag' : $('#flag').val(),
                'spplancd' : $('#spplancd').val(),
                'spcompcd' : $('#spcompcd').val(),
                'spworkcd' : $('#spworkcd').val()
            }
            let data2 = [];
            let result =  AjaxUtil.getSyncData('/api/inspec_report/read', data);
            //선택기 그리드면 이거
            if(result.success){


                let DataLength = 10 - result.data.length;

                if(result.data.length < 10){
                    for(let i=0; i < DataLength; i++){
                        result.data.push('empty');
                    }
                }

                grid_binding(result.data);
            }

            /*if(result.success){
                console.log(result.data);
                let DataLength = 10 - result.data.length;
                if(result.data.length < 10){
                    for(let i=0; i < DataLength; i++){
                        result.data.push('empty');
                    }
                }
                data2 = result.data
                viewdata = new wijmo.collections.CollectionView(data2);
                theGrid.itemsSource = viewdata;

                let selector = new wijmo.grid.selector.Selector(theGrid, {
                    itemChecked: (e, ctx) => {
                        // 선택된 항목들을 초기화 (선택 해제)
                        theGrid.select(-1, -1);  // 그리드에서 모든 행의 선택을 해제

                    }
                });

                SelectItem = undefined;

                //grid_binding(result.data);
            }*/
        }

        function grid_binding(data){
            var inspecDto = data;
            var inspecData = [];
            var cnt = 1;
            for (let i = 0; i < inspecDto.length; i++) {
                inspecData.push({
                    spuncode: inspecDto[i]["spuncode"],
                    spworknm: inspecDto[i]["spworknm"],
                    spcompnm: inspecDto[i]["spcompnm"],
                    spplannm: inspecDto[i]["spplannm"],
                    checkdt: inspecDto[i]["checkdt"],
                    checkusr: inspecDto[i]["checkusr"],
                    checkarea: inspecDto[i]["checkarea"],
                    checktmdt: inspecDto[i]["checktmdt"],
                    downloads: inspecDto[i]["downloads"],
                    upload:    inspecDto[i]["upload"],
                    fileornm:  inspecDto[i]["fileornm"]

                });
                cnt++;
            }

            theGrid.columns.clear();
            theGrid.autoGenerateColumns = false;
            viewdata.sourceCollection = inspecData;


            for (var i = 0; i < columns.length; i++) {
                var col = new wijmo.grid.Column(columns[i]);
                theGrid.columns.push(col);
            }
            SelectItem = undefined;


        }
        function DownloadDoc() {

            if(SelectItem === undefined || SelectItem.length === 0){
                Alert.alert('', '출력할 항목을 선택하세요.');
                return;
            }

            if(!checkEmptySelectedItem(SelectItem, 'checkdt')){
                Alert.alert('', '빈 값은 불가능합니다.');
                return;
            }

            // 로딩 바 표시
            showLoadingBar();
            let selectedList = SelectItemPush(SelectItem, '_data.spuncode');

            postFetchRequest('/api/inspec_report/download-docs', selectedList, function(blob) {



                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'modified_documents.zip'; // 다운로드 받을 zip 파일 이름
                document.body.appendChild(a);
                a.click();
                a.remove();
                window.URL.revokeObjectURL(url); // URL 객체 해제


            }, function(error) {
                console.error('There was a problem with the fetch operation:', error);
                Alert.alert('', "File download failed!");

            });


        }


        //리팩터링 코드
        function updateElementText(elementIdPrefix, index, textContent) {
            let elementId = elementIdPrefix + (index + 1);
            let element = document.getElementById(elementId);


            if (element) {
                if (element.tagName.toLowerCase() === 'input' || element.tagName.toLowerCase() === 'textarea') {
                    element.value = textContent;
                } else {
                    element.textContent = textContent;
                }
            } else {
                console.warn(`Element with id ${elementId} not found.`);
            }
        }


        function modifyData(){

            if(SelectItem === undefined || SelectItem.length === 0){
                Alert.alert('', '수정할 항목을 선택하세요.');
                return;
            }else if(SelectItem.length > 1){
                Alert.alert('', '하나의 항목만 선택해주세요');
                return;
            }
            let selectedItem = SelectItem[0];


            let spuncode = selectedItem._data.spuncode;

            if(!selectedItem._data.spuncode){
                Alert.alert('', '수정할 게시물이 없습니다.', function () {

                });
                return false;
            }
            let jsonSpunCode = JSON.stringify(spuncode);
            AjaxFunction.PostAjaxRequest('/api/inspec_report/modfind', false, 'application/json', true, jsonSpunCode, function (data) {
                let data2 = data.data;

                $('#inputTabLink').click();

                let str = data2.checkdt;
                let year = str.substring(0, 4);
                let month = str.substring(4, 6);
                let day = str.substring(6, 8);

                let formattedDate = `${year}-${month}-${day}`;

                document.getElementById('spuncode').value = data2.spuncode;
                document.getElementById('supplier').value = data2.supplier;
                document.getElementById('checkdt').value = formattedDate;
                document.getElementById('checkstdt').value = data2.checkstdt;
                document.getElementById('checkendt').value = data2.checkendt;
                document.getElementById('checkusr').value = data2.checkusr;
                document.getElementById('checkusr').value = data2.checkusr;
                document.getElementById('checkarea').value = data2.checkarea;



                for (let i = 0; i < data2.inspecitem.length; i++) {
                    updateElementText('inspecresult', i, data2.inspecitem[i].inspecresult);
                    updateElementText('inspecreform', i, data2.inspecitem[i].inspecreform);

                    let str = "seq" + (i+1);
                    document.getElementById(str).value = data2.inspecitem[i].seq;

                }


                //탭 수정으로 업더이트
                updateTabLink('spuncode');

                let fileList = Array.isArray(data2.filelist) ? data2.filelist : [];
                deletedFiles = [];
                uploadedFiles = [];
                $('.filelist').empty(); // 파일 리스트 초기화

                fileList.forEach(file => {
                    let newFile = {
                        name: file.fileornm,
                        size: file.filesize,
                        type: file.fileextns,
                        spuncode_id: file.spuncode_id,
                        checkseq: file.checkseq,
                        filepath: file.filepath,
                        filesvnm: file.filesvnm

                    };
                    uploadedFiles.push(newFile); // 파일 리스트에 추가
                });
                console.log('파일목록확인', uploadedFiles)
                updateFileListUI();
                updateFileCount();

            }, fnFailure)

        }

        //이거는 따로 못뺀다.
        function updateFileCount() {
            const fileCount = uploadedFiles.length;
            $('.upload-filelist .title h5').text(`Files (${fileCount})`);
            $('.file_btn span').text(`(${fileCount})`);

        }


        document.addEventListener("DOMContentLoaded", function() {
            updateTabLink('spuncode');

        });

        let fnSuccess = function (res){
            Alert.alert('', res.message, function(){
                $('#listTabLink').click();
                searchData();
                clearForm();

                let inputFields = document.querySelectorAll('.addusr');
                if (inputFields) {

                    inputFields.forEach(r => {
                        deleteInputField(r);
                    })

                }
            });
        }


        let fnFailure = function(){
            Alert.alert('', '에러가발생하였습니다.');
        }

        let checkusrCounter = 1; // ID 카운터 초기값 설정
        function addInputField(button) {
            // 새로운 div 요소를 생성합니다.
            var newTd = document.createElement('div');
            newTd.className = 'input-btnbox';
            newTd.name = 'newusrbox';

            // 새로운 input 요소를 생성합니다.
            var newInput = document.createElement('input');
            newInput.type = 'text';
            newInput.className = 'wp100 addusr';
            newInput.placeholder = '점검자';
            newInput.name = 'checkusr';
            newInput.setAttribute('autocomplete', 'off');

            // 동적으로 생성된 입력 필드에 고유한 ID를 부여합니다.
            const uniqueId = `checkusr-${checkusrCounter}`;
            newInput.id = uniqueId;
            newInput.maxLength = 5;

            // clear 버튼과 input을 감쌀 div 요소 생성
            const inputClearDiv = document.createElement('div');
            inputClearDiv.classList.add('input-clear');

            newInput.style.marginRight = '4px'; // input의 오른쪽에 마진 추가

            // Create the clear button (×)
            const clearButton = document.createElement('span');
            clearButton.classList.add('btn-clear');
            clearButton.innerHTML = '×';
            clearButton.style.display = 'none';  // Initially hidden

            // Clear input value when clear button is clicked
            clearButton.onclick = () => {
                newInput.value = '';  // Clear the input field
                clearButton.style.display = 'none';  // Hide clear button
                newInput.focus();     // Re-focus on the input field
            };

            // Show or hide the clear button based on input value
            newInput.addEventListener('input', () => {
                clearButton.style.display = newInput.value ? 'inline' : 'none';  // Show when there's input
            });

            // Append input field and clear button to the div
            inputClearDiv.appendChild(newInput);
            inputClearDiv.appendChild(clearButton);

            // 삭제 버튼을 생성합니다.
            var deleteButton = document.createElement('button');
            deleteButton.textContent = '점검자 삭제';
            deleteButton.onclick = function () {
                deleteInputField(newTd); // 삭제 버튼을 클릭하면 해당 입력 필드를 삭제하는 함수 호출
            };
            deleteButton.style.marginLeft = '8px';
            deleteButton.style.color = 'red';
            deleteButton.style.marginTop = '5px';

            // 새로운 td에 inputClearDiv와 삭제 버튼을 추가합니다.
            newTd.appendChild(inputClearDiv); // inputClearDiv는 input과 clear 버튼을 감싼 div입니다.
            newTd.appendChild(deleteButton);

            // 담을 ul 요소를 생성합니다.
            const nameSuggestions = document.createElement('ul');
            const nameSuggestionId = `suggestions-checkusr-${checkusrCounter}`;
            nameSuggestions.id = nameSuggestionId;
            nameSuggestions.classList.add('suggestions-list');
            nameSuggestions.style.top = '100%';

            // 카운터 증가 (ul 생성 후)
            checkusrCounter++;

            // 새로운 td에 자동완성 ul 요소를 추가합니다.
            newTd.appendChild(nameSuggestions);

            // 클릭된 버튼의 부모 td 요소를 찾습니다.
            var parentTd = button.parentElement;

            // 부모 td 요소 다음에 새로운 td 요소를 추가합니다.
            parentTd.parentElement.insertBefore(newTd, parentTd.nextSibling);

            // setTimeout을 사용하여 DOM에 완전히 추가된 후 initializeAutoComplete 함수 호출
            setTimeout(function () {
                initializeAutoComplete(uniqueId, '/api/inspec_report/autocomplete', nameSuggestionId);
            }, 0);  // 0ms의 지연을 사용하여 비동기적으로 처리
        }


        //하나씩만 삭제
        function deleteInputField(inputField) {
            // 입력 필드의 부모 요소(td)를 찾아서 삭제합니다.
            inputField.remove();
        }

        // 점검자 초기화
        function resetAddedInputFields() {
            // 모든 .input-btnbox 클래스를 가진 요소들을 선택 (동적으로 추가된 요소 포함)
            const inputBoxes = document.querySelectorAll('.input-btnbox');

            // 첫 번째 요소는 기본으로 남기고, 나머지 요소들을 삭제
            inputBoxes.forEach((inputBox, index) => {
                if (index > 0) {  // 첫 번째 요소는 남겨둠
                    inputBox.remove();
                }
            });

            // ID 카운터를 초기화
            checkusrCounter = 1;
        }

        $(document).ready(function (e) {

            const fileInput = document.getElementById('fileInput2');
            const fileNameDisplay = document.getElementById('fileNameDisplay');
            const dropZone = document.getElementById('dropZone');

            function updateFileName() {
                const files = fileInput.files;
                if (files.length > 0) {
                    fileNameDisplay.textContent = files[0].name;
                } else {
                    fileNameDisplay.textContent = 'Maximum upload file size 1GiB';
                }
            }

            fileInput.addEventListener('change', updateFileName);

            // 드래그 앤 드롭 이벤트 핸들러
            dropZone.addEventListener('dragover', (event) => {
                event.preventDefault();
                dropZone.classList.add('dragover');
            });

            dropZone.addEventListener('dragleave', (event) => {
                event.preventDefault();
                dropZone.classList.remove('dragover');
            });

            dropZone.addEventListener('drop', (event) => {
                event.preventDefault();
                dropZone.classList.remove('dragover');

                const files = event.dataTransfer.files;
                if (files.length > 0) {
                    fileInput.files = files; // 파일 입력 요소에 파일 설정
                    updateFileName(); // 파일명 업데이트
                }
            });



            // 저장 시작
            $('#btnSave').click(function (e){


                Alert.confirm('', '저장하시겠습니까?', function() {

                        let formData = new FormData();

                        // 점검항목 값 가져오기
                        const table = document.querySelector('table.doc-table');
                        const rows = table.querySelectorAll('tbody tr');
                        let results = [];
                        let currentDivision = '';

                        rows.forEach((row, index)=> {
                            let cells = row.querySelectorAll('td');

                            // Check if the first cell has rowspan attribute, indicating a new division
                            if (cells[0].hasAttribute('rowspan')) {
                                currentDivision = cells[0].innerText.trim();
                            } else {
                                cells = Array.from(cells);
                                cells.unshift(document.createElement('td')); // Insert a placeholder cell
                            }

                            const inspectionItem = cells[1].innerText.trim().replace(/\n/g, ' ');
                            const inspectionResult = cells[2].innerText.trim();
                            const improvement = cells[3].querySelector('textarea').value;

                            const seqId = `seq${index + 1}`;
                            const seqElement = document.getElementById(seqId);
                            let seqValue = '';

                            if(seqElement){
                                seqValue = seqElement.value.trim();
                            }

                            const combinedText = `${currentDivision}@ ${inspectionItem}@ ${inspectionResult}@ ${improvement}@ ${seqValue}`;

                            formData.append('doc-list', combinedText);



                            results.push(combinedText);
                        });
                        // 점검항목 값 가져오기 끝, 코드작성 의도 -> 점검항목이 나중에 바뀌고 갯수도 바뀌고 했을때 동적으로 서버에 값을 넘기고 서버에서 분기해서 처리함

                        for (let i = 0; i < uploadedFiles.length; i++) {
                            formData.append('filelist', uploadedFiles[i]);
                        }

                        let SpunCodeValue = $('#spuncode').val();
                        let randomString;

                        if(SpunCodeValue === ""){
                            randomString = generateRandomStringWithDate();
                        }else{
                            randomString = SpunCodeValue;
                        }


                        var inputs = document.querySelectorAll('input[name="checkusr"]');
                        var values = [];

                        inputs.forEach(function (input) {
                            values.push(input.value);

                        })

                        var checkusrString = values.join(',');


                        // 다른 데이터를 FormData에 추가합니다.
                        formData.append('supplier', $('#supplier').val());
                        formData.append('checkdt', $('#checkdt').val());
                        formData.append('checkstdt', $('#checkstdt').val());
                        formData.append('checkendt', $('#checkendt').val());
                        formData.append('checkusr', checkusrString); // 이미 문자열로 변환된 checkusr
                        formData.append('checkarea', $('#checkarea').val());
                        formData.append('randomuuid', randomString);
                        //formData.append('_csrf', $('[name=_csrf]').val());
                        formData.append('_csrf', csrfToken);
                        formData.append('ReformList', $('#inspecreform1').val());
                        formData.append('ReformList', $('#inspecreform2').val());
                        formData.append('ReformList', $('#inspecreform3').val());
                        formData.append('ReformList', $('#inspecreform4').val());
                        formData.append('ReformList', $('#inspecreform5').val());
                        formData.append('spworkcd', $('#spworkcd').val());
                        formData.append('spworknm', $('#spworknm').val());
                        formData.append('spcompcd', $('#spcompcd').val());
                        formData.append('spcompnm', $('#spcompnm').val());
                        formData.append('spplancd', $('#spplancd').val());
                        formData.append('spplannm', $('#spplannm').val());




                    // 삭제된 파일 목록 추가
                        deletedFiles.forEach((file, index) => {
                            formData.append('deletedFiles', new Blob([JSON.stringify(file)], { type: 'application/json' }));
                        });

                        AjaxFunction.PostAjaxRequest('/api/inspec_report/save', true, false, false, formData, fnSuccess, fnFailure)

                    },

                )
            })

            //승인
            $('#btnAppr').click(function (e){
                if(SelectItem === undefined || SelectItem.length === 0){
                    Alert.alert('', '승인할 항목을 선택하세요.');
                    return;
                }

                if(!checkEmptySelectedItem(SelectItem, 'checkdt')){
                    Alert.alert('', '빈 값은 불가능합니다.');
                    return;
                }

                let apprList = [];

                apprList = SelectItemPush(SelectItem, '_data.spuncode');


                Alert.confirm('', '승인하시겠습니까?', function () {
                    let data = {
                        'spuncode': JSON.stringify(apprList),
                        '_csrf': csrfToken
                    }
                    let fnSuccess = function (res) {
                        if (res.success) {
                            Alert.alert('', '처리되었습니다.');
                            searchData();
                        }
                    }
                    AjaxUtil.postAsyncData('/api/inspec_report/approve', data, fnSuccess);
                })
            })

            //삭제
            $('#btnDelete').click(function (e) {

                if(SelectItem === undefined || SelectItem.length === 0){
                    Alert.alert('', '삭제할 항목을 선택하세요.');
                    return;
                }
                if(!checkEmptySelectedItem(SelectItem, 'checkdt')){
                    Alert.alert('', '빈 항목은 불가합니다.');
                    return;
                }


                let delList = [];

                delList = SelectItemPush(SelectItem, '_data.spuncode');


                Alert.confirm('', '삭제하시겠습니까?', function () {
                    let data = {
                        'spuncode': JSON.stringify(delList),
                        '_csrf': csrfToken
                    }
                    let fnSuccess = function (res) {
                        if (res.success) {
                            Alert.alert('', '삭제되었습니다.');
                            searchData();
                        }
                    }
                    AjaxUtil.postAsyncData('/api/inspec_report/delete', data, fnSuccess);
                })
            })

            // 자동완성
            // 크롬에서 제공해주는 자동완성 비활성화
            document.querySelectorAll('input[type="text"]').forEach(function(input) {
                input.setAttribute('autocomplete', 'off');
            });

            const autoCompleteFields = [
                { inputId: 'checkarea', suggestionId: 'suggestions-checkarea' },
                { inputId: 'supplier', suggestionId: 'suggestions-supplier' },
                { inputId: 'checkusr', suggestionId: 'suggestions-checkusr' },
            ];
            let apiUrl = '/api/inspec_report/autocomplete';

            autoCompleteFields.forEach(field => {
                initializeAutoComplete(field.inputId, apiUrl, field.suggestionId);
            });

        });
    </script>
    <!--*******************************************************************************************************************************기간별대비/기간별조회 스트립트-->
    <script>

        document.getElementById('runWijmo').addEventListener('click', function(){
            loadYearlyData();
            searchData_Byperid();

        })

        // 스트링 형식으로 레이아웃 정의.
        function returnLayoutStr(category, yField){
            return `
            <rMateChart backgroundColor="#FFFFFF" borderStyle="none">
            <Options>
            <Caption text="" />
            <SubCaption text="" textAlign="center" paddingBottom="0"/>
            </Options>
            <SeriesInterpolate id="ss"/>
            <Column2DChart showDataTips="true" selectionMode="multiple" columnWidthRatio="0.48">
            <horizontalAxis>
            <CategoryAxis categoryField="${category}"/>
            </horizontalAxis>
            <verticalAxis>
            <LinearAxis interval="5"/>
            </verticalAxis>
            <series>
            <Column2DSeries labelPosition="outside" yField="${yField}" displayName="등록건수" showDataEffect="{ss}" showValueLabels="[40]" fill="#62b2fd"/>
            </series>
            </Column2DChart>
            </rMateChart>
            `;

        }

        // 차트 데이터
        var chartData = [
        ]

        var chartData1 = [
        ]

        // 차트 데이터
        var chartData2 = [

        ]

        /***Rmate*********************************************************************************************/

        function layoutStrValue(yField, displayName, yField2, displayName2, categoryField){
            return `
            <rMateChart backgroundColor="#FFFFFF" borderStyle="none">
                <Options>
                    <Caption text=""/>
                    <Legend defaultMouseOverAction="true"/>
                </Options>
                <NumberFormatter id="numFmt" useThousandsSeparator="true"/>
                <Combination2DChart showDataTips="true" itemClickJsFunction="chartClickHandler">
                    <horizontalAxis>
                        <CategoryAxis categoryField="${categoryField}"/>
                    </horizontalAxis>
                    <verticalAxis>
                        <LinearAxis id="vAxis1" formatter="{numFmt}"/>
                    </verticalAxis>
                    <series>
                        <Line2DSeries yField="${yField}" displayName="${displayName}" itemRenderer="DiamondItemRenderer">
                            <lineStroke><Stroke color="#ffa336" weight="2"/></lineStroke>
                            <showDataEffect><SeriesInterpolate/></showDataEffect>
                            <verticalAxis>

                            </verticalAxis>
                        </Line2DSeries>
                        <Line2DSeries yField="${yField2}" displayName="${displayName2}" itemRenderer="DiamondItemRenderer">
                            <lineStroke><Stroke color="#909bff " weight="2"/></lineStroke>
                            <showDataEffect><SeriesInterpolate/></showDataEffect>

                        </Line2DSeries>
                    </series>
                    <verticalAxisRenderers>
                        <Axis2DRenderer axis="{vAxis1}" showLine="true"/>

                   </verticalAxisRenderers>
                </Combination2DChart>
            </rMateChart>`;
        }


        function layoutStr_MoM(categoryFiled, yField, displayName){
            return `<rMateChart backgroundColor="#FFFFFF" borderStyle="none">
            <Options>
            <Caption text="" paddingBottom="0"/>
            </Options>
            <Line2DChart showDataTips="true" >
            <horizontalAxis>
            <CategoryAxis categoryField="${categoryFiled}"/>
            </horizontalAxis>
            <verticalAxis>
            <LinearAxis />
            </verticalAxis>
            <series>
            <Line2DSeries yField="${yField}" displayName="${displayName}" itemRenderer="DiamondItemRenderer">
            <lineStroke><Stroke color="#ffa336" weight="2" /></lineStroke>
            <showDataEffect>
            <SeriesClip duration="1500"/>
            </showDataEffect>
            </Line2DSeries>
            </series>
            </Line2DChart>
            </rMateChart>`;
        }

        var layoutStr30 =
            '<rMateChart backgroundColor="#FFFFFF" borderStyle="none">'
            +'<Options>'
            +'<Caption text="" paddingBottom="0"/>'
            +'</Options>'
            +'<Line2DChart showDataTips="true" >'
            +'<horizontalAxis>'
            +'<CategoryAxis categoryField=""/> '
            +'</horizontalAxis>'
            +'<verticalAxis>'
            +'<LinearAxis />'
            +'</verticalAxis>'
            +'<series>'
            +'<Line2DSeries yField="Profit2023" displayName="Profit2023" itemRenderer="DiamondItemRenderer">'
            +'<lineStroke><Stroke color="#ffa336" weight="2" /></lineStroke>'
            +'<showDataEffect>'
            +'<SeriesClip duration="1500"/>'
            +'</showDataEffect>'
            +'</Line2DSeries>'
            +'</series>'
            +'</Line2DChart>'
            +'</rMateChart>';


        // 차트 데이터
        var chartData10 = [
        ];


        function RunRmateGraph(param, data){

            setTimeout(function(){
                let con = param
                rMateChartH5.create(con, "chartHolder" + con.replace(/\D/g, ""), "100%", "100%");

                document.getElementById(param).setLayout(returnLayoutStr('Month', 'Count'));

                document.getElementById(param).setData(data);
                document.getElementById(param).resize();

            }, 60)


        }

        function reload(param){

            setTimeout(function(){
                document.getElementById(param).resize();
            }, 100)
        }

        function RunRmateGraph2(param, data, category1, category2, flag){



            setTimeout(function(){

                let con = param
                rMateChartH5.create(con, "chartHolder" + con.replace(/\D/g, ""), "100%", "100%");

                if(flag === 'N'){
                    document.getElementById(param).setLayout(layoutStr_MoM("Month", "Count", "Profit"));

                }else{
                    document.getElementById(param).setLayout(layoutStrValue("Count", `${category1} (%)`, "Count2", `${category2} (%)`, "Month"));

                }

                document.getElementById(param).setData(data);


                document.getElementById(param).resize();

            }, 50)

        }
        /***Rmate*********************************************************************************************/



        // ===============================================================================Rmate

        let theGrid11;
        let theGrid21;
        let theGrid31;
        let theGrid41;
        let theGrid51;
        let theGrid61;
        let theGrid71;


        let viewdata11;
        let viewdata21;
        let viewdata31;


        let columns11 = [{ binding: 'checkarea', header: '장소', align: 'center', width: '0.5*', minWidth: 100},
            { binding: 'hour', header: '시간', align: 'center', width: '*', minWidth: 100 },
            { binding: 'checkusr', header: '점검자', align: 'center', width: '0.5*', minWidth: 100 }]

        let columns21 = [{ binding: 'checkarea', header: '장소', align: 'center', width: '0.5*', minWidth: 100},
            { binding: 'result', header: '결과', align: 'center', width: '*', minWidth: 100 },
            { binding: 'checkusr', header: '점검자', align: 'center', width: '0.5*', minWidth: 100 }]

        let columns31 = [{ binding: 'checkarea', header: '장소', align: 'center', width: '0.5*', minWidth: 100},
            { binding: 'result', header: '결과', align: 'center', width: '*', minWidth: 100 },
            { binding: 'title', header: '점검명', align: 'center', width: '0.5*', minWidth: 100 }]

        let columns41 = [{ binding: 'checkarea', header: '장소', align: 'center', width: '0.5*', minWidth: 100},
            { binding: 'result', header: '참가자', align: 'center', width: '*', minWidth: 100 },
            { binding: 'checkusr', header: '훈련명', align: 'center', width: '0.5*', minWidth: 100 }]

        let columns51 = [{ binding: 'checkarea', header: '장소', align: 'center', width: '0.5*', minWidth: 100},
            { binding: 'result', header: '참가자', align: 'center', width: '*', minWidth: 100 },
            { binding: 'checkusr', header: '훈련명', align: 'center', width: '0.5*', minWidth: 100 }]

        let columns61 = [{ binding: 'checkarea', header: '장소', align: 'center', width: '0.5*', minWidth: 100},
            { binding: 'result', header: '공사명', align: 'center', width: '*', minWidth: 100 },
            { binding: 'checkusr', header: '공사명', align: 'center', width: '0.5*', minWidth: 100 }]

        let columns71 = [{ binding: 'checkarea', header: '사이트명', align: 'center', width: '0.5*', minWidth: 100},
            { binding: 'result', header: '방문목적', align: 'center', width: '*', minWidth: 100 },
            { binding: 'checkusr', header: '담당자', align: 'center', width: '0.5*', minWidth: 100 }]


        function searchData_Byperid(){

            let searchtypeList = ['wm_inspec_month_list', 'wm_hap_input', 'wm_elecsafe_input', 'wm_emergency_plan', 'wm_emergency_result', 'wm_safety_health', 'wm_inspec_field_report'];


            for(let i=0; i < searchtypeList.length; i++){
                let dataSet = AjaxGetBodyParameter(searchtypeList[i]);

                let rowData = DataLoad('/api/inspec_statics/read', dataSet);
                let wijmoData = rowData.data;
                let rmateData = rowData.subData;

                if (i === 0) {

                    viewdata11 = new wijmo.collections.CollectionView(wijmoData);

                    if(!theGrid11){
                        console.log('dadssadsadsadasdsadsadsada')
                        theGrid11 = new wijmo.grid.FlexGrid('#theGrid11', {
                            autoGenerateColumns: false,
                            showMarquee: true,
                            columns: columns11,
                            itemsSource: viewdata11
                        });
                        theGrid11.rowHeaders.columns.splice(0,1);  //맨 앞에 헤더부분 없애기
                        console.log('있는지 없는지 체크', viewdata11);

                    }else{
                        theGrid11.itemsSource = viewdata11;
                        console.log('그리드 존재함');

                    }

                    chartData1 = rMateDataLoad_ColumnsGraph(rmateData);
                    console.log('check1', chartData1);

                    RunRmateGraph('chart1', chartData1);
                } else if (i === 1) {

                    viewdata11 = new wijmo.collections.CollectionView(wijmoData);

                    if(!theGrid21){
                        theGrid21 = new wijmo.grid.FlexGrid('#theGrid21', {
                            autoGenerateColumns: false,
                            showMarquee: true,
                            columns: columns21,
                            itemsSource: viewdata11
                        });
                        theGrid21.rowHeaders.columns.splice(0,1);
                        console.log('있는지 없는지 체크1', viewdata11);
                    }else{
                        theGrid21.itemsSource = viewdata11;
                    }

                    chartData1 = rMateDataLoad_ColumnsGraph(rmateData);
                    console.log('check2', chartData1);
                    RunRmateGraph('chart2', chartData1);
                } else if (i === 2) {

                    viewdata11 = new wijmo.collections.CollectionView(wijmoData);

                    if(!theGrid31){
                        theGrid31 = new wijmo.grid.FlexGrid('#theGrid31', {
                            autoGenerateColumns: false,
                            showMarquee: true,
                            columns: columns31,
                            itemsSource: viewdata11
                        });
                        theGrid31.rowHeaders.columns.splice(0,1);
                        console.log('있는지 없는지 체크2', viewdata11);
                    }else{
                        theGrid31.itemsSource = viewdata11;
                    }
                    chartData1 = rMateDataLoad_ColumnsGraph(rmateData);
                    console.log('check3', chartData1);
                    RunRmateGraph('chart3', chartData1);
                }else if(i === 3){

                    viewdata11 = new wijmo.collections.CollectionView(wijmoData);

                    if(!theGrid41){
                        theGrid41 = new wijmo.grid.FlexGrid('#theGrid41', {
                            autoGenerateColumns: false,
                            showMarquee: true,
                            columns: columns41,
                            itemsSource: viewdata11
                        });
                        theGrid41.rowHeaders.columns.splice(0,1);
                        console.log('있는지 없는지 체크3', viewdata11);
                    }else{
                        theGrid41.itemsSource = viewdata11;
                    }
                    chartData1 = rMateDataLoad_ColumnsGraph(rmateData);
                    RunRmateGraph('chart4',chartData1);
                }else if(i === 4){
                    viewdata11 = new wijmo.collections.CollectionView(wijmoData);

                    if(!theGrid51){
                        theGrid51 = new wijmo.grid.FlexGrid('#theGrid51', {
                            autoGenerateColumns: false,
                            showMarquee: true,
                            columns: columns51,
                            itemsSource: viewdata11
                        });
                        theGrid51.rowHeaders.columns.splice(0,1);
                        console.log('있는지 없는지 체크4', viewdata11);
                    }else{
                        theGrid51.itemsSource = viewdata11;
                    }
                    chartData1 = rMateDataLoad_ColumnsGraph(rmateData);
                    RunRmateGraph('chart5',chartData1);
                }else if(i === 5){
                    viewdata11 = new wijmo.collections.CollectionView(wijmoData);

                    if(!theGrid61){
                        theGrid61 = new wijmo.grid.FlexGrid('#theGrid61', {
                            autoGenerateColumns: false,
                            showMarquee: true,
                            columns: columns61,
                            itemsSource: viewdata11
                        });
                        theGrid61.rowHeaders.columns.splice(0,1);
                        console.log('있는지 없는지 체크4', viewdata11);
                    }else{
                        theGrid61.itemsSource = viewdata11;
                    }
                    chartData1 = rMateDataLoad_ColumnsGraph(rmateData);
                    RunRmateGraph('chart6',chartData1);
                }else if(i===6){
                    viewdata11 = new wijmo.collections.CollectionView(wijmoData);

                    if(!theGrid71){
                        theGrid71 = new wijmo.grid.FlexGrid('#theGrid71', {
                            autoGenerateColumns: false,
                            showMarquee: true,
                            columns: columns71,
                            itemsSource: viewdata11
                        });
                        theGrid71.rowHeaders.columns.splice(0,1);
                        console.log('있는지 없는지 체크4', viewdata11);
                    }else{
                        theGrid71.itemsSource = viewdata11;
                    }
                    chartData1 = rMateDataLoad_ColumnsGraph(rmateData);
                    RunRmateGraph('chart7',chartData1);
                }

                //chartData1 = rMateDataLoad_ColumnsGraph(rmateData);

                //RunRmateGraph(`chart${i+1}`);



            }
        }


        function searchData2() {
            const searchtypeList = ['wm_inspec_month_list', 'wm_hap_input', 'wm_elecsafe_input', 'wm_emergency_plan', 'wm_emergency_result', 'wm_safety_health', 'wm_inspec_field_report'];

            let bindingList;
            let comparisonType = $('#comparisonType').val();

            if(comparisonType === 'YoY' || comparisonType === 'YTD'){
                bindingList = ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'];
            }else if(comparisonType === 'QoQ'){
                bindingList = ['Q1', 'Q2', 'Q3', 'Q4']
            }

            searchtypeList.forEach((searchType, index) => {

                const dataSet = AjaxGetBodyParameter_RmateLineGraph(searchType);


                const rowData = DataLoad('/api/inspec_statics/read', dataSet);


                if(comparisonType === 'MoM')
                {
                    let rmateData1 = rowData.data;

                    console.log('test', rmateData1);

                    let rmateData2 = rMateDataLoad_ColumnsGraph(rowData.data);

                    console.log('test2', rmateData2);

                    if(index === 0){
                        chartData10 = rmateData2;
                        RunRmateGraph2('chart10', chartData10, null, null, 'N');

                    }else if(index === 1){
                        chartData10 = rmateData2;
                        RunRmateGraph2('chart11', chartData10,null, null,  'N');
                    }else if(index === 2){
                        chartData10 = rmateData2;
                        RunRmateGraph2('chart12', chartData10, null, null,  'N');
                    }else{
                        chartData10 = rmateData2;
                        RunRmateGraph2('chart13', chartData10, null, null,  'N');
                        RunRmateGraph2('chart14', chartData10, null, null,  'N');
                        RunRmateGraph2('chart15', chartData10, null, null,  'N');
                        RunRmateGraph2('chart16', chartData10, null, null,  'N');

                    }

                }
                else
                {
                let rmateData1 = rMateDataLoad(rowData.data);
                let rmateData2 = rMateDataLoad(rowData.subData);


                //chartData10 = mergeData(bindingList, rmateData1, rmateData2);

                if(index === 0){
                    chartData10 = mergeData(bindingList, rmateData1, rmateData2);
                    RunRmateGraph2('chart10', chartData10, rmateData1[0], rmateData2[0], 'Y');

                    console.log('chartDataValue', chartData10);

                }else if(index === 1){
                    console.log('rmateData1', rmateData1);
                    console.log('rmateData2', rmateData2);

                    chartData10 = mergeData(bindingList, rmateData1, rmateData2);
                    RunRmateGraph2('chart11', chartData10, rmateData1[0], rmateData2[0]);
                }else if(index === 2){
                    chartData10 = mergeData(bindingList, rmateData1, rmateData2);
                    RunRmateGraph2('chart12', chartData10, rmateData1[0], rmateData2[0]);
                }else{
                    chartData10 = mergeData(bindingList, rmateData1, rmateData2);
                    RunRmateGraph2('chart13', chartData10, rmateData1[0], rmateData2[0]);
                    RunRmateGraph2('chart14', chartData10, rmateData1[0], rmateData2[0]);
                    RunRmateGraph2('chart15', chartData10, rmateData1[0], rmateData2[0]);
                    RunRmateGraph2('chart16', chartData10, rmateData1[0], rmateData2[0]);


                }
                }
            });

        }

        //서버에서 가져온데이터를 rmate가 조회할수 있게 변환
        function rMateDataLoad_ColumnsGraph(arr){
            let data = [];
            Object.keys(arr).sort().forEach(function(key, index) {

                data.push({
                    "Month": key,
                    "Count": arr[key]
                });
            });
            return data;
        }

        //서버에서 가져온데이터를 rmate가 조회할수 있게 변환
        function rMateDataLoad(arr){

            const resultList = [];

            // 연도와 그 하위의 월별 카운트를 리스트로 변환
            Object.entries(arr).forEach(([year, months]) => {
                resultList.push(year); // 연도를 리스트에 추가

                // 월별 데이터에서 카운트 값만 추출해 리스트에 추가
                Object.values(months).forEach((count) => {
                    resultList.push(String(count)); // 카운트 값 추가 (숫자를 문자열로 변환)
                });
            });

            return resultList;
        }

        function mergeData(bind, data1, data2){
            const mergedResult = [];

            for(let i=0; i < data1.length; i++){

                if(!bind[i]){
                    continue;
                }

                mergedResult.push({
                    Month: bind[i],
                    Count: Number(data1[i+1]),
                    Count2: Number(data2[i+1])
                });

            }
            return mergedResult;
        }

        //=============================================================================================================

        function AjaxGetBodyParameter_RmateLineGraph(wm_flag){
            let dataSet;
            let ComparisonPeriodType = $('#comparisonType').val();
            let startDateTab2 = $('#startDateTab2');
            let endDateTab2 = $('#endDateTab2');

            let startMonthTab2 = $('#startMonthTab2').val();
            let endMonthTab2 = $('#endMonthTab2').val();


            if(ComparisonPeriodType === 'YoY' || ComparisonPeriodType === 'QoQ' || ComparisonPeriodType === 'YTD'){
                dataSet = {
                    'searchType': ComparisonPeriodType,
                    'wm_flag' : wm_flag,
                    'searchfrYear' : startDateTab2.val(),
                    'searchtoYear' : endDateTab2.val()

                };
            }else if(ComparisonPeriodType === 'MoM'){
                dataSet = {
                    'searchType': ComparisonPeriodType,
                    'wm_flag' : wm_flag,
                    'searchfrYear' : startDateTab2.val(),
                    'searchtoYear' : endDateTab2.val(),
                    'searchfrMonth': startMonthTab2,
                    'searchtoMonth': endMonthTab2
                };
            }

            return dataSet;

        }

        function AjaxGetBodyParameter(wm_flag){
            let dataSet;
            let periodType = $('#periodType').val();

            if(periodType === 'hourly'){
                dataSet = {
                    'searchfrdate' : $('#startDate').val(),
                    'startHour'    : $('#startHour').val(),
                    'endHour'      : $('#endHour').val(),
                    'searchType'   : periodType,
                    'wm_flag'       : wm_flag
                };
            }else if(periodType === 'monthly'){
                dataSet = {
                    'searchfrdate' : $('#startDate').val(),
                    'searchtodate' : $('#endDate').val(),
                    'searchType' : periodType,
                    'wm_flag' : wm_flag
                };
            }
            else if(periodType === 'quarterly'){


                dataSet = {
                    'searchYear' : $('#yearSelectTab1').val(),
                    'searchfrQuarter' : $('#startSelect').val(),
                    'searchtoQuarter' : $('#endSelect').val(),
                    'searchType' : periodType,
                    'wm_flag' : wm_flag
                };
            }
            else if(periodType === 'halfyearly'){

                dataSet = {
                    'searchYear' : $('#yearSelectTab1').val(),
                    'searchfrHalfYear' : $('#startSelect').val(),
                    'searchtoHalfYear' : $('#endSelect').val(),
                    'searchType' : periodType,
                    'wm_flag' : wm_flag
                }
            }
            else if(periodType === 'yearly')
            {
                dataSet = {
                    'searchfrYear' : $('#startSelect').val(),
                    'searchtoYear' : $('#endSelect').val(),
                    'searchType' : periodType,
                    'wm_flag' : wm_flag
                };
            }
            return dataSet;
        }

        $('#runrmate').click(function(){
            searchData2();
        });

        // 조회기간 변동 함수 -> 입력 필드를 동적으로 업데이트
        function updatePeriodInputs() {
            const periodType = document.getElementById("periodType").value;
            const selectedYear = document.getElementById("yearSelectTab1").value; // 선택된 조회연도 가져오기
            const startDateContainer = document.getElementById("startDateContainer");
            const endDateContainer = document.getElementById("endDateContainer");

            // 기존 내용을 초기화
            startDateContainer.innerHTML = "";
            endDateContainer.innerHTML = "";

            // 'searchYear' 요소의 표시 여부 제어
            if (periodType === "monthly" || periodType === "yearly") {
                $('#searchYear').hide();
            } else if (periodType === "quarterly" || periodType === "halfyearly") {

                $('#searchYear').show();
            }

            if (periodType === "monthly") { // 월별 조회가 선택된 경우
                const startDate = `${selectedYear}-01`; // 선택된 연도의 1월
                const endDate = `${selectedYear}-12`; // 선택된 연도의 12월

                startDateContainer.innerHTML = `<input type="month" id="startDate" name="startDate" value="${startDate}">`;
                endDateContainer.innerHTML = `<input type="month" id="endDate" name="endDate" value="${endDate}">`;
            }else if(periodType === "hourly"){
                const currentDate = new Date();
                const defaultMonth = (currentDate.getMonth() + 1).toString().padStart(2, '0');
                const defaultDay = currentDate.getDate().toString().padStart(2, '0');

                document.getElementById("startDateContainer").innerHTML = `
                <input type="date" id="startDate" name="startDate" value="${selectedYear}-${defaultMonth}-${defaultDay}">
            `;

                document.getElementById("endDateContainer").innerHTML = `
                <select id="startHour" name="startHour" style="width: 60px;">
                    ${generateHourOptions()}
                </select>
                -
                <select id="endHour" name="endHour" style="width: 60px;">
                    ${generateHourOptions(true)}
                </select>
            `;
            }
            else if (periodType === "quarterly" || periodType === "halfyearly" || periodType === "yearly") {
                const options = periodType === "quarterly" ? `
            <option value="Q1">1분기</option>
            <option value="Q2">2분기</option>
            <option value="Q3">3분기</option>
            <option value="Q4">4분기</option>
        ` : periodType === "halfyearly" ? `
            <option value="H1">상반기</option>
            <option value="H2">하반기</option>
        ` : '';

                 startDateContainer.innerHTML = `<select id="startSelect" onchange="">${options}</select>`;
                endDateContainer.innerHTML = `<select id="endSelect" onchange="">${options}</select>`;

                if (periodType === "yearly") {
                    // 연도별일 경우 연도를 동적으로 로드하여 추가
                    loadYearlyData();
                }
            }
        }


        // 시간 옵션 생성 함수
        function generateHourOptions(isEnd = false) {
            return Array.from({length: 24}, (_, i) => {
                const hour = (i + 1).toString().padStart(2, '0');
                return `<option value="${hour}"${isEnd && hour === '24' || !isEnd && hour === '01' ? ' selected' : ''}>${hour}</option>`;
            }).join('');
        }

        // 조회연도 선택 요소에 이벤트 리스너 추가
        document.getElementById("yearSelectTab1").addEventListener("change", function() {
            //updateYearInPeriod(); // 조회연도 변경 시 startDate와 endDate 갱신
            //updatePeriodInputs(); // 연도 변경 시 기간 입력 필드 초기화
        });

        document.getElementById("comparisonType").addEventListener("change", updateComparisonType);


        // 연도를 로드하고 기존 UI를 업데이트
        function loadYearlyData() {
            fetch('/api/inspec_statics/distinctYears')
                .then(response => response.json())
                .then(years => {
                    const yearSelectTab1 = document.getElementById("yearSelectTab1");
                    //const yearSelectTab2 = document.getElementById("yearSelectTab2");

                    // 기간유형이 연도별일 때 조회기간에 사용될 startSelect와 endSelect
                    const startSelect = document.getElementById("startSelect");
                    const endSelect = document.getElementById("endSelect");

                    // 기존 옵션 삭제
                    yearSelectTab1.innerHTML = '';
                    //yearSelectTab2.innerHTML = '';
                    if (startSelect) startSelect.innerHTML = '';
                    if (endSelect) endSelect.innerHTML = '';

                    // 서버에서 가져온 연도 목록을 <option>으로 추가
                    years.forEach(year => {
                        const option1 = document.createElement('option');
                        option1.value = year;
                        option1.textContent = year;

                        yearSelectTab1.appendChild(option1);
                        //yearSelectTab2.appendChild(option1.cloneNode(true));

                        if (startSelect && endSelect) {
                            const option2 = document.createElement('option');
                            option2.value = year;
                            option2.textContent = year;

                            startSelect.appendChild(option2);
                            endSelect.appendChild(option2.cloneNode(true));
                        }
                    });
                })
                .catch(error => console.error('Error loading years:', error));
        }


        // tab2 비교유형 변경시 실행될 함수
        function updateComparisonType() {
            const comparisonType = document.getElementById("comparisonType").value;
            const startDateContainerTab2 = document.getElementById("startDateContainerTab2");
            const endDateContainerTab2 = document.getElementById("endDateContainerTab2");

            // 기존 월 선택 셀렉트를 제거
            const existingStartMonthSelect = document.getElementById("startMonthTab2");
            const existingEndMonthSelect = document.getElementById("endMonthTab2");

            if (existingStartMonthSelect) startDateContainerTab2.removeChild(existingStartMonthSelect);
            if (existingEndMonthSelect) endDateContainerTab2.removeChild(existingEndMonthSelect);

            // "MoM"이 선택된 경우에만 새로운 월 셀렉트 추가
            if (comparisonType === "MoM") {
                const startMonthSelect = createMonthSelect("startMonthTab2");
                const endMonthSelect = createMonthSelect("endMonthTab2");

                // 첫 번째 셀렉트가 변경될 때 두 번째 셀렉트도 동일한 값으로 설정
                startMonthSelect.addEventListener("change", function () {
                    endMonthSelect.value = startMonthSelect.value;
                });

                startDateContainerTab2.appendChild(startMonthSelect);
                endDateContainerTab2.appendChild(endMonthSelect);
            }
        }


        // tab2 MoM 선택시, 월 선택 셀렉트 생성
        function createMonthSelect(id) {
            const monthSelect = document.createElement('select');
            monthSelect.id = id;
            monthSelect.name = id;
            monthSelect.style.width = '70px';

            const months = [
                "01", "02", "03", "04", "05", "06",
                "07", "08", "09", "10", "11", "12"
            ];

            months.forEach(month => {
                const option = document.createElement('option');
                option.value = month;
                option.textContent = `${month}월`;
                monthSelect.appendChild(option);
            });

            return monthSelect;
        }


    </script>
</th:block>
</html>