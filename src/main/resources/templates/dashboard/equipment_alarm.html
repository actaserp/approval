<html layout:decorate="~{layout_page}" xmlns:layout="http://www.w3.org/1999/xhtml">
<head>
    <style>
        .tab-item2.tab-content1 {
            display: block;
            padding-bottom: 0;
            border-radius: 0 15px 0 0 !important;
            border-bottom: 0;
            border-bottom-style: none;
        }

        .tab-contents > section, .tab-item > .row > section:first-child {
            border-radius: 0 0 15px 15px;
            border: 0 !important;
            box-shadow: 0 0 !important;
        }
        #theGrid1.wj-flexgrid .wj-cell,
        #theGrid2.wj-flexgrid .wj-cell,
        #theGrid3.wj-flexgrid .wj-cell,
        #theGrid4.wj-flexgrid .wj-cell,
        #theGrid5.wj-flexgrid .wj-cell,
        #theGrid6.wj-flexgrid .wj-cell,
        #theGrid7.wj-flexgrid .wj-cell,
        #theGrid8.wj-flexgrid .wj-cell,
        #theGrid9.wj-flexgrid .wj-cell,
        #theGrid10.wj-flexgrid .wj-cell,
        #theGrid11.wj-flexgrid .wj-cell,
        #theGrid12.wj-flexgrid .wj-cell{
            padding: 12px;

        }





    </style>
</head>
<th:block layout:fragment="content">

    <div class="layout-contents">
        <!-- Page Title -->
        <div class="page-title-wrap">
            <div class="left">
                <h2>장비 알림 이력</h2><a id="toggleButton" onclick="toggleSearchWrap()"><img src="/images/icon/ico-down.png"
                                                                                        alt="알람 아이콘"></a>
<!--                <a title="북마크" class="bookmark toggle">-->
<!--                    내메뉴-->
<!--                </a>-->
            </div>
            <ul class="page-navi">
                <li><img src="/images/icon/ico-nav-home.svg" alt="홈아이콘"></li>
                <li>모니터링</li>
                <li>종합관제</li>
                <li>장비 알림 이력</li>
            </ul>
        </div>
        <!-- Select -->
        <div class="search-wrap" id="searchWrap" style="display: none">
            <ul>
                <li>
                    <select title="지역" id="spworkcd" name="spworkcd"
                            onchange="updateCompcdOptions(); saveSelectedSandanData(); ">
                        <!-- 지역 옵션을 JavaScript에서 동적으로 채움 -->
                    </select>
                    <input type="hidden" id="spworknm" name="spworknm">
                </li>
                <li>
                    <select title="산단" id="spcompcd" name="spcompcd"
                            onchange="updatePlancdOptions(); saveSelectedSandanData();">
                        <!-- 산단 옵션을 JavaScript에서 동적으로 채움 -->
                    </select>
                    <input type="hidden" id="spcompnm" name="spcompnm">
                </li>
                <li>
                    <select title="시설" id="spplancd" name="spplancd"
                            onchange="updatePlannm(); saveSelectedSandanData()">
                        <!-- 시설 옵션을 JavaScript에서 동적으로 채움 -->
                    </select>
                    <input type="hidden" id="spplannm" name="spplannm">
                </li>
            </ul>
        </div>
        <div class="tab-wrap" id="jqueryTabs">
            <ul class="tab-links">
                <li><a href="#tab1" title="통합" class="tab-button">통합</a></li>
                <li><a href="#tab2" title="상세" class="tab-button">상세</a></li>
            </ul>
            <div class="tab-contents">

                <section class="tab-item2 tab-content1">
                    <!-- 공통 검색 조건 -->
                    <div class="section-top">
                        <div class="search-wrap">
                            <!-- 검색 조건 코드 -->
                            <dl id="division-wrapper">
                                <dt><label for="division">구분<span class="eq">*</span></label></dt>
                                <dd>
                                    <select id="division" class="w120">
                                        <option selected>전체</option>
                                        <option>Fault</option>
                                        <option>Alarm</option>
                                        <option>통신이상</option>
                                        <option>가스누출</option>
                                        <option>연료전지 고온</option>
                                        <option>계통연계</option>
                                    </select>
                                </dd>
                            </dl>
                            <dl>
                                <dt>
                                    <label for="periodType">
                                        기간유형<span class="eq">*</span>
                                    </label>
                                </dt>
                                <dd>
                                    <ul class="date-box">
                                        <li>
                                            <select id="periodType" name="periodType" onchange="updatePeriodInputs()">
                                                <option value="hourly">시간별</option>
                                                <option value="monthly" selected>월별</option>
                                                <option value="quarterly">분기별</option>
                                                <option value="halfyearly">반기별</option>
                                                <option value="yearly">연도별</option>
                                            </select>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <dl>
                                <dt>
                                    조회연도<span class="eq">*</span>
                                </dt>
                                <dd>
                                    <ul class="date-box">
                                        <li>
                                            <select id="yearSelectTab1" name="yearSelectTab1">
                                                <option>2023</option>
                                                <option selected>2024</option>
                                            </select>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>

                            <dl>
                                <dt>
                                    조회기간<span class="eq">*</span>
                                </dt>
                                <dd>
                                    <ul class="date-box" id="dateBoxContainer">
                                        <li id="startDateContainer">
                                            <input type="month" id="startDate" name="startDate" value="2024-01">
                                        </li>
                                        <li id="endDateContainer">
                                            <input type="month" id="endDate" name="endDate" value="2024-05">
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <dl>
                                <dt><label for="confirm">확인여부</label></dt>
                                <dd>
                                    <select id="confirm" class="w120">
                                        <option>전체</option>
                                        <option>확인</option>
                                        <option>미확인</option>
                                    </select>
                                </dd>
                            </dl>
                            <dl>
                                <dt><label for="btn-search"></label></dt>
                                <dd>
                                    <ul>
                                        <li>
                                            <a class="btn btn-delete" title="검색" id="btn-search" onclick="searchData()">
                                                <img src="/images/icon/btn-srch.svg" alt="검색 아이콘">
                                                검색
                                            </a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                        </div>
                    </div> <!--//section-top end -->
                </section>

                <!-- 통합 영역 -->
                <section class="tab-item tab-content" id="tab1" style="padding-top: 5px;">
                    <div class="row">
                        <div class="row row-2" style="width: 100%">
                            <section class="wp60" style="height: 460px">
                                <!-- 그래프 -->
                                <div class="chart-wrap">
                                    <div id="chartHolder1" style="height:410px; width:100%;"></div>
                                </div>
                            </section>
                            <section class="wp40" style="height: 460px">
                                <div class="chart-wrap">
                                    <div id="chartHolder2" style="height:410px; width:100%;"></div>
                                </div>
                            </section>
                        </div>
                    </div>
                    <div class="container-fluid">
                        <p id="selectedItem"></p>
                        <div id="theGrid" style="max-height: 220px"></div>
                    </div>
                </section>

                <!-- 상세 영역 -->
                <section class="tab-item tab-content" id="tab2" style="padding-top: 5px;">

                    <div class="row row-2" style="margin-bottom: 10px">
                        <div class="col wp50" style="margin-right: 15px">
                            <section class="tab-section section_top" style="height: 230px">
                                <div class="title-wrap" style="margin-bottom: 2px">
                                    <h3>Fault</h3>
                                    <ul class="tab-links-sub">
                                        <li><a href="#tab3" title="통계">통계</a></li>
                                        <li><a href="#tab4" title="현황">현황</a></li>

                                    </ul>
                                </div>
                                <div class="tab-contents">
                                    <!-- tab3 -->
                                    <div class="tab-item-sub" id="tab3">
                                        <div class="chart-wrap">
                                            <div id="chartHolder3"
                                                 style="width: 100%; height: 145px; padding-top: 5px"></div>
                                        </div>
                                    </div>
                                    <!-- tab4 -->
                                    <div class="tab-item-sub" id="tab4">
                                        <div class="container-fluid">
                                            <div id="theGrid2" style="width: 100%; height: 165px"></div>
                                        </div>
                                    </div>

                                </div>
                            </section>
                        </div>

                        <div class="col wp50">
                            <section class="tab-section section_top" style="height: 230px">
                                <div class="title-wrap" style="margin-bottom: 2px">
                                    <h3>Alarm</h3>
                                    <ul class="tab-links-sub">
                                        <li><a href="#tab5" title="통계">통계</a></li>
                                        <li><a href="#tab6" title="현황">현황</a></li>
                                    </ul>
                                </div>
                                <div class="tab-contents">
                                    <!-- tab5 -->
                                    <div class="tab-item-sub" id="tab5">
                                        <div class="chart-wrap">
                                            <div id="chartHolder4"
                                                 style="width: 100%; height: 145px; padding-top: 5px"></div>
                                        </div>
                                    </div>
                                    <!-- tab6 -->
                                    <div class="tab-item-sub" id="tab6">
                                        <div class="container-fluid">
                                            <div id="theGrid3" style="width: 100%; height: 165px"></div>
                                        </div>
                                    </div>

                                </div>
                            </section>
                        </div>
                    </div>

                    <div class="row row-2" style="margin-bottom: 10px">
                        <div class="col wp50" style="margin-right: 15px">
                            <section class="tab-section section_top" style="height: 230px">
                                <div class="title-wrap" style="margin-bottom: 2px">
                                    <h3>통신이상</h3>
                                    <ul class="tab-links-sub">
                                        <li><a href="#tab7" title="통계">통계</a></li>
                                        <li><a href="#tab8" title="현황">현황</a></li>

                                    </ul>
                                </div>
                                <div class="tab-contents">
                                    <!-- tab3 -->
                                    <div class="tab-item-sub" id="tab7">
                                        <div class="chart-wrap">
                                            <div id="chartHolder5"
                                                 style="width: 100%; height: 145px; padding-top: 5px"></div>
                                        </div>
                                    </div>
                                    <!-- tab4 -->
                                    <div class="tab-item-sub" id="tab8">
                                        <div class="container-fluid">
                                            <div id="theGrid4" style="width: 100%; height: 165px"></div>
                                        </div>
                                    </div>

                                </div>
                            </section>
                        </div>

                        <div class="col wp50">
                            <section class="tab-section section_top" style="height: 230px">
                                <div class="title-wrap" style="margin-bottom: 2px">
                                    <h3>가스누출</h3>
                                    <ul class="tab-links-sub">
                                        <li><a href="#tab9" title="통계">통계</a></li>
                                        <li><a href="#tab10" title="현황">현황</a></li>
                                    </ul>
                                </div>
                                <div class="tab-contents">
                                    <!-- tab5 -->
                                    <div class="tab-item-sub" id="tab9">
                                        <div class="chart-wrap">
                                            <div id="chartHolder6"
                                                 style="width: 100%; height: 145px; padding-top: 5px"></div>
                                        </div>
                                    </div>
                                    <!-- tab6 -->
                                    <div class="tab-item-sub" id="tab10">
                                        <div class="container-fluid">
                                            <div id="theGrid5" style="width: 100%; height: 165px"></div>
                                        </div>
                                    </div>

                                </div>
                            </section>
                        </div>
                    </div>

                    <div class="row row-2" style="margin-bottom: 10px">
                        <div class="col wp50" style="margin-right: 15px">
                            <section class="tab-section section_top" style="height: 230px">
                                <div class="title-wrap" style="margin-bottom: 2px">
                                    <h3>연료전지 고온</h3>
                                    <ul class="tab-links-sub">
                                        <li><a href="#tab11" title="통계">통계</a></li>
                                        <li><a href="#tab12" title="현황">현황</a></li>

                                    </ul>
                                </div>
                                <div class="tab-contents">
                                    <!-- tab3 -->
                                    <div class="tab-item-sub" id="tab11">
                                        <div class="chart-wrap">
                                            <div id="chartHolder7"
                                                 style="width: 100%; height: 145px; padding-top: 5px"></div>
                                        </div>
                                    </div>
                                    <!-- tab4 -->
                                    <div class="tab-item-sub" id="tab12">
                                        <div class="container-fluid">
                                            <div id="theGrid6" style="width: 100%; height: 165px"></div>
                                        </div>
                                    </div>

                                </div>
                            </section>
                        </div>

                        <div class="col wp50">
                            <section class="tab-section section_top" style="height: 230px">
                                <div class="title-wrap" style="margin-bottom: 2px">
                                    <h3>계통연계</h3>
                                    <ul class="tab-links-sub">
                                        <li><a href="#tab13" title="통계">통계</a></li>
                                        <li><a href="#tab14" title="현황">현황</a></li>
                                    </ul>
                                </div>
                                <div class="tab-contents">
                                    <!-- tab5 -->
                                    <div class="tab-item-sub" id="tab13">
                                        <div class="chart-wrap">
                                            <div id="chartHolder8"
                                                 style="width: 100%; height: 145px; padding-top: 5px"></div>
                                        </div>
                                    </div>
                                    <!-- tab6 -->
                                    <div class="tab-item-sub" id="tab14">
                                        <div class="container-fluid">
                                            <div id="theGrid7" style="width: 100%; height: 165px"></div>
                                        </div>
                                    </div>

                                </div>
                            </section>
                        </div>
                    </div>
                </section>
            </div> <!--//tab-contens end-->
        </div> <!--//tab-wrap end-->
    </div> <!--//layout-contents end -->
    <footer>
        <p>Copyrightⓒ 0000 corp. All rights reserved.</p>
    </footer>
    <div style="height: 10px"></div>

<!--    <div id="chartModal" class="modal" style="opacity:100">-->
<!--        <div class="modal-content">-->
<!--            <span class="close">&times;</span>-->
<!--            <div id="modalChartHolder" style="width: 100%; height: 500px;"></div> &lt;!&ndash; 차트를 보여줄 모달의 div &ndash;&gt;-->
<!--        </div>-->
<!--    </div>-->


</th:block>
<th:block layout:fragment="scripts">
    <th:block th:replace="/common/approve_box :: approve_box"></th:block>
    <th:block th:replace="/common/ax5_uploader :: ax5_uploader"></th:block>
    <th:block th:replace="/common/upload_one_image_box :: upload_one_image_box"></th:block>
    <th:block th:replace="/common/popup_select_user_code :: popup_select_user_code"></th:block>


    <script type="text/javascript">


        document.readyState === 'complete' ? init() : window.onload = init;


        <!-- 초반 페이지 진입시 그리드 바인딩 끝-->
        function init() {
            fetchListData();
            initializeSelections();
            updatePeriodInputs();
            setTimeout(function () {
                createTab1Charts();
                createTab2Charts();
            }, 100);

        }

        // 탭 버튼 클릭 이벤트
        $('.tab-button').click(function () {
            var targetTab = $(this).attr('href'); // 클릭한 탭의 href를 가져옴

            setTimeout(function () {
                if (targetTab === '#tab1') {
                    createTab1Charts(); // 탭 1 클릭 시 차트 생성
                    $('#division-wrapper').show();
                } else if (targetTab === '#tab2') {
                    createTab2Charts(); // 탭 2 클릭 시 차트 생성
                    $('#division-wrapper').hide();
                }
            }, 100);
        });


        // 페이지 로드 시 첫 번째 탭의 차트를 자동으로 로드
        function createTab1Charts() {
            let chartVars = "rMateOnLoadCallFunction=chartReadyHandler"; // 필요시 사용될 변수

            let chartsTab1 = [
                {name: "chart1", vars: chartVars},
                {name: "chart2", vars: chartVars}
            ];

            chartsTab1.forEach(chart => {
                let chartID = chart.name.replace(/\D/g, ""); // 숫자만 추출
                rMateChartH5.create(chart.name, "chartHolder" + chartID, chart.vars, "100%", "100%");
            });
        }

        function createTab2Charts() {
            let chartVars1 = "rMateOnLoadCallFunction=chartReadyHandler";

            let chartsTab2 = [
                {name: "chart3", vars: chartVars1},
                {name: "chart4", vars: chartVars1},
                {name: "chart5", vars: chartVars1},
                {name: "chart6", vars: chartVars1},
                {name: "chart7", vars: chartVars1},
                {name: "chart8", vars: chartVars1}
            ];

            chartsTab2.forEach(chart => {
                let chartID = chart.name.replace(/\D/g, ""); // 숫자만 추출
                rMateChartH5.create(chart.name, "chartHolder" + chartID, chart.vars, "100%", "100%");
            });
        }

        function chartReadyHandler(id) {
            // 숫자만 추출하여 해당 레이아웃 및 데이터를 설정
            let chartIndex = id.replace(/\D/g, "");

            var layoutStr;
            var chartData;

            switch (chartIndex) {
                case "1":
                    // 차트 데이터
                    chartData = [
                        {"Date": "1", "Fault": 10, "Alarm": 15, "통신이상": 8, "가스누출": 12, "연료전지 고온": 7, "계통연계": 5}, // 합계 57
                        {"Date": "2", "Fault": 20, "Alarm": 15, "통신이상": 5, "가스누출": 20, "연료전지 고온": 10, "계통연계": 5}, // 합계 75
                        {"Date": "3", "Fault": 15, "Alarm": 10, "통신이상": 10, "가스누출": 15, "연료전지 고온": 10, "계통연계": 20}, // 합계 80
                        {"Date": "4", "Fault": 10, "Alarm": 5, "통신이상": 15, "가스누출": 20, "연료전지 고온": 10, "계통연계": 15}, // 합계 75
                        {"Date": "5", "Fault": 25, "Alarm": 20, "통신이상": 10, "가스누출": 15, "연료전지 고온": 10, "계통연계": 5}, // 합계 85
                        {"Date": "6", "Fault": 10, "Alarm": 15, "통신이상": 8, "가스누출": 10, "연료전지 고온": 5, "계통연계": 12}, // 합계 60
                        {"Date": "7", "Fault": 15, "Alarm": 20, "통신이상": 10, "가스누출": 15, "연료전지 고온": 10, "계통연계": 5}, // 합계 75
                        {"Date": "8", "Fault": 10, "Alarm": 20, "통신이상": 15, "가스누출": 10, "연료전지 고온": 10, "계통연계": 15}, // 합계 80
                        {"Date": "9", "Fault": 20, "Alarm": 15, "통신이상": 15, "가스누출": 10, "연료전지 고온": 10, "계통연계": 5}, // 합계 75
                        {"Date": "10", "Fault": 25, "Alarm": 20, "통신이상": 15, "가스누출": 15, "연료전지 고온": 10, "계통연계": 5}, // 합계 90
                        {"Date": "11", "Fault": 15, "Alarm": 10, "통신이상": 10, "가스누출": 15, "연료전지 고온": 10, "계통연계": 15}, // 합계 75
                        {"Date": "12", "Fault": 20, "Alarm": 25, "통신이상": 15, "가스누출": 10, "연료전지 고온": 10, "계통연계": 5}, // 합계 85
                        {"Date": "13", "Fault": 10, "Alarm": 10, "통신이상": 5, "가스누출": 10, "연료전지 고온": 5, "계통연계": 10}, // 합계 50
                        {"Date": "14", "Fault": 15, "Alarm": 20, "통신이상": 15, "가스누출": 10, "연료전지 고온": 15, "계통연계": 10}, // 합계 85
                        {"Date": "15", "Fault": 20, "Alarm": 15, "통신이상": 20, "가스누출": 15, "연료전지 고온": 5, "계통연계": 10}, // 합계 85
                        {"Date": "16", "Fault": 10, "Alarm": 5, "통신이상": 10, "가스누출": 15, "연료전지 고온": 5, "계통연계": 10}, // 합계 55
                        {"Date": "17", "Fault": 15, "Alarm": 15, "통신이상": 15, "가스누출": 20, "연료전지 고온": 10, "계통연계": 10}  // 합계 85
                    ];
                    break;
                case "2":
                    // 차트 데이터
                    chartData = [{"division": "Fault", "Profit": 40},
                        {"division": "Alarm", "Profit": 30},
                        {"division": "통신이상", "Profit": 10},
                        {"division": "가스누출", "Profit": 15},
                        {"division": "연료전지 고온", "Profit": 50},
                        {"division": "계통연계", "Profit": 10}];
                    break;
                case "3":
                    chartData = [
                        {"Month": "1월", "Profit": 42},
                        {"Month": "2월", "Profit": 57},
                        {"Month": "3월", "Profit": 1},
                        {"Month": "4월", "Profit": 46},
                        {"Month": "5월", "Profit": 42},
                        {"Month": "6월", "Profit": 68},
                        {"Month": "7월", "Profit": 85},
                        {"Month": "8월", "Profit": 23},
                        {"Month": "9월", "Profit": 15},
                        {"Month": "10월", "Profit": 44},
                        {"Month": "11월", "Profit": 35},
                        {"Month": "12월", "Profit": 45}
                    ];
                    break;
                case "4":
                    chartData = [
                        {"Month": "1월", "Profit": 78},
                        {"Month": "2월", "Profit": 56},
                        {"Month": "3월", "Profit": 23},
                        {"Month": "4월", "Profit": 23},
                        {"Month": "5월", "Profit": 12},
                        {"Month": "6월", "Profit": 55},
                        {"Month": "7월", "Profit": 23},
                        {"Month": "8월", "Profit": 87},
                        {"Month": "9월", "Profit": 65},
                        {"Month": "10월", "Profit": 45},
                        {"Month": "11월", "Profit": 23},
                        {"Month": "12월", "Profit": 58}
                    ];
                    break;
                case "5":
                    chartData = [
                        {"Month": "1월", "Profit": 45},
                        {"Month": "2월", "Profit": 56},
                        {"Month": "3월", "Profit": 23},
                        {"Month": "4월", "Profit": 56},
                        {"Month": "5월", "Profit": 47},
                        {"Month": "6월", "Profit": 53},
                        {"Month": "7월", "Profit": 56},
                        {"Month": "8월", "Profit": 83},
                        {"Month": "9월", "Profit": 31},
                        {"Month": "10월", "Profit": 12},
                        {"Month": "11월", "Profit": 2},
                        {"Month": "12월", "Profit": 32}
                    ];
                    break;
                case "6":
                    chartData = [
                        {"Month": "1월", "Profit": 21},
                        {"Month": "2월", "Profit": 45},
                        {"Month": "3월", "Profit": 22},
                        {"Month": "4월", "Profit": 12},
                        {"Month": "5월", "Profit": 35},
                        {"Month": "6월", "Profit": 78},
                        {"Month": "7월", "Profit": 53},
                        {"Month": "8월", "Profit": 45},
                        {"Month": "9월", "Profit": 23},
                        {"Month": "10월", "Profit": 85},
                        {"Month": "11월", "Profit": 52},
                        {"Month": "12월", "Profit": 12}
                    ];
                    break;
                case "7":
                    chartData = [
                        {"Month": "1월", "Profit": 12},
                        {"Month": "2월", "Profit": 32},
                        {"Month": "3월", "Profit": 25},
                        {"Month": "4월", "Profit": 56},
                        {"Month": "5월", "Profit": 75},
                        {"Month": "6월", "Profit": 93},
                        {"Month": "7월", "Profit": 32},
                        {"Month": "8월", "Profit": 45},
                        {"Month": "9월", "Profit": 56},
                        {"Month": "10월", "Profit": 53},
                        {"Month": "11월", "Profit": 21},
                        {"Month": "12월", "Profit": 12}
                    ];
                    break;
                case "8":
                    chartData = [
                        {"Month": "1월", "Profit": 23},
                        {"Month": "2월", "Profit": 56},
                        {"Month": "3월", "Profit": 53},
                        {"Month": "4월", "Profit": 54},
                        {"Month": "5월", "Profit": 23},
                        {"Month": "6월", "Profit": 12},
                        {"Month": "7월", "Profit": 83},
                        {"Month": "8월", "Profit": 45},
                        {"Month": "9월", "Profit": 23},
                        {"Month": "10월", "Profit": 23},
                        {"Month": "11월", "Profit": 86},
                        {"Month": "12월", "Profit": 78}
                    ];
                    break;
            }

            var layoutStr = '<rMateChart backgroundColor="#FFFFFF" borderStyle="none">'
                + '<Column2DChart showDataTips="true">'
                + '<horizontalAxis><CategoryAxis categoryField="Month"/></horizontalAxis>'
                + '<series>'
                + '<Column2DSeries yField="Profit" fill="#62b2fd">'
                + '<showDataEffect><SeriesInterpolate/></showDataEffect>'
                + '</Column2DSeries>'
                + '</series>'
                + '</Column2DChart>'
                + '</rMateChart>';

            document.getElementById(id).setLayout(layoutStr);
            document.getElementById(id).setData(chartData);
            if (chartIndex === "1") {
                document.getElementById(id).setLayout(layoutStr1);
            } else if (chartIndex === "2") {
                document.getElementById(id).setLayout(layoutStr2);
            }
        }


        var theGrid;
        let theGrid2;
        let theGrid3;
        let theGrid4;
        let theGrid5;
        let theGrid6;
        let theGrid7;

        let viewdata;
        let viewdata2;
        let viewdata3;
        let viewdata4;
        let viewdata5;
        let viewdata6;
        let viewdata7;

        var columns = [
            {binding: 'occurDateTime', header: '발생일시', align: 'center', width: '*'},
            {binding: 'device', header: '장비', align: 'center', width: '*'},
            {binding: 'eventContent', header: '이벤트내용', align: 'center', width: '*'},
            {binding: 'actionDateTime', header: '조치일시', align: 'center', width: '*'},
            {binding: 'actionUser', header: '조치자', align: 'center', width: '*'},
            {binding: 'actionContent', header: '조치내용', align: 'center', width: '*'},
            {binding: 'confirmed', header: '확인', align: 'center', width: '*'},
        ];

        var columns2 = [
            {binding: 'occurDateTime', header: '발생일시', align: 'center', width: '*'},
            {binding: 'device', header: '장비', align: 'center', width: '*'},
            {binding: 'actionDateTime', header: '조치일시', align: 'center', width: '*'},
            {binding: 'actionUser', header: '조치자', align: 'center', width: '*'},
            {binding: 'actionContent', header: '조치내용', align: 'center', width: '*'},
        ];

        var columns3 = [
            {binding: 'occurDateTime', header: '발생일시', align: 'center', width: '*'},
            {binding: 'device', header: '장비', align: 'center', width: '*'},
            {binding: 'actionDateTime', header: '조치일시', align: 'center', width: '*'},
            {binding: 'actionUser', header: '조치자', align: 'center', width: '*'},
            {binding: 'actionContent', header: '조치내용', align: 'center', width: '*'},
        ];

        var columns4 = [
            {binding: 'occurDateTime', header: '발생일시', align: 'center', width: '*'},
            {binding: 'device', header: '장비', align: 'center', width: '*'},
            {binding: 'actionDateTime', header: '조치일시', align: 'center', width: '*'},
            {binding: 'actionUser', header: '조치자', align: 'center', width: '*'},
            {binding: 'actionContent', header: '조치내용', align: 'center', width: '*'},
        ];

        var columns5 = [
            {binding: 'occurDateTime', header: '발생일시', align: 'center', width: '*'},
            {binding: 'device', header: '장비', align: 'center', width: '*'},
            {binding: 'actionDateTime', header: '조치일시', align: 'center', width: '*'},
            {binding: 'actionUser', header: '조치자', align: 'center', width: '*'},
            {binding: 'actionContent', header: '조치내용', align: 'center', width: '*'},
        ];

        var columns6 = [
            {binding: 'occurDateTime', header: '발생일시', align: 'center', width: '*'},
            {binding: 'device', header: '장비', align: 'center', width: '*'},
            {binding: 'actionDateTime', header: '조치일시', align: 'center', width: '*'},
            {binding: 'actionUser', header: '조치자', align: 'center', width: '*'},
            {binding: 'actionContent', header: '조치내용', align: 'center', width: '*'},
        ];

        var columns7 = [
            {binding: 'occurDateTime', header: '발생일시', align: 'center', width: '*'},
            {binding: 'device', header: '장비', align: 'center', width: '*'},
            {binding: 'actionDateTime', header: '조치일시', align: 'center', width: '*'},
            {binding: 'actionUser', header: '조치자', align: 'center', width: '*'},
            {binding: 'actionContent', header: '조치내용', align: 'center', width: '*'},
        ];


        function fetchListData() {
            let data2 = [];
            const categories1 = ['Fault', 'Alarm', '통신이상', '가스누출', '연료전지 고온', '계통연계'];
            const categories2 = ['Fault', 'Alarm', '통신이상', '가스누출', '연료전지 고온', '계통연계'];
            // $.ajax({
            //     url: '/api/inspec_report/read',
            //     type: 'GET',
            //     data: {
            //         'searchusr': 'infinited',
            //
            //     },
            //     async: false,
            //     success: function (data) {
            //         console.log('check1', data.data);
            //         if (data.data.length === 0) {
            //             for (let i = 0; i < 10; i++) {
            //                 data.data.push('example');
            //             }
            //         }
            //         console.log(data.data);
            //         data2 = data.data;
            //     }
            // })

            // 샘플 데이터 생성
            for (let i = 0; i < 20; i++) {
                const category1 = categories1[i % categories1.length];
                data2.push({
                    occurDateTime: `2023-09-${(i + 1).toString().padStart(2, '0')} 12:34:56`,
                    device: `FC#1`,
                    eventContent: category1,
                    actionDateTime: `2023-09-${(i + 1).toString().padStart(2, '0')} 13:00:00`,
                    actionUser: `관리자`,
                    actionContent: `${category1} 확인`,
                    confirmed: i % 2 === 0 ? 'Yes' : 'No'
                });
            }

            viewdata = new wijmo.collections.CollectionView(data2);
            // 데이터 그리드에 바인딩
            if (!theGrid) {
                theGrid = new wijmo.grid.FlexGrid('#theGrid', {
                    autoGenerateColumns: false,
                    showMarquee: true,
                    columns: columns,
                    itemsSource: viewdata
                });

                // 선택이 변경될 때, 현재 항목 업데이트
                theGrid.rowHeaders.columns.splice(0, 1);  //맨 앞에 헤더부분 없애기
                new FlexGridContextMenu(theGrid);
                window.downloadFileName = '장비알림이력';
            } else {
                // 이미 FlexGrid이 존재하는 경우, 데이터만 업데이트
                theGrid.itemsSource = viewdata;
            }

            let data3 = [];
            viewdata2 = new wijmo.collections.CollectionView(data3);
            // 데이터 그리드에 바인딩
            theGrid2 = new wijmo.grid.FlexGrid('#theGrid2', {
                autoGenerateColumns: false,
                showMarquee: true,
                columns: columns2,
                itemsSource: viewdata2
            });
            theGrid2.rowHeaders.columns.splice(0, 1);

            let data4 = [];
            viewdata3 = new wijmo.collections.CollectionView(data4);
            // 데이터 그리드에 바인딩
            theGrid3 = new wijmo.grid.FlexGrid('#theGrid3', {
                autoGenerateColumns: false,
                showMarquee: true,
                columns: columns3,
                itemsSource: viewdata3
            });
            theGrid3.rowHeaders.columns.splice(0, 1);

            let data5 = [];
            viewdata4 = new wijmo.collections.CollectionView(data5);
            // 데이터 그리드에 바인딩
            theGrid4 = new wijmo.grid.FlexGrid('#theGrid4', {
                autoGenerateColumns: false,
                showMarquee: true,
                columns: columns4,
                itemsSource: viewdata4
            });
            theGrid4.rowHeaders.columns.splice(0, 1);

            let data6 = [];
            viewdata5 = new wijmo.collections.CollectionView(data6);
            // 데이터 그리드에 바인딩
            theGrid5 = new wijmo.grid.FlexGrid('#theGrid5', {
                autoGenerateColumns: false,
                showMarquee: true,
                columns: columns5,
                itemsSource: viewdata5
            });
            theGrid5.rowHeaders.columns.splice(0, 1);

            let data7 = [];
            viewdata6 = new wijmo.collections.CollectionView(data7);
            // 데이터 그리드에 바인딩
            theGrid6 = new wijmo.grid.FlexGrid('#theGrid6', {
                autoGenerateColumns: false,
                showMarquee: true,
                columns: columns6,
                itemsSource: viewdata6
            });
            theGrid6.rowHeaders.columns.splice(0, 1);

            let data8 = [];
            viewdata7 = new wijmo.collections.CollectionView(data8);
            // 데이터 그리드에 바인딩
            theGrid7 = new wijmo.grid.FlexGrid('#theGrid7', {
                autoGenerateColumns: false,
                showMarquee: true,
                columns: columns7,
                itemsSource: viewdata7
            });
            theGrid7.rowHeaders.columns.splice(0, 1);
        }

        //  select 바뀌면 hidden input 변경
        function updateSelect(selectId, hiddenInputId) {
            var selectElement = document.getElementById(selectId);
            var selectedOptionText = selectElement.options[selectElement.selectedIndex].text;
            document.getElementById(hiddenInputId).value = selectedOptionText;
        }

        // 조회기간 변동 함수 -> 입력 필드를 동적으로 업데이트
        function updatePeriodInputs() {
            const periodType = document.getElementById("periodType").value;
            const selectedYear = document.getElementById("yearSelectTab1").value; // 선택된 조회연도 가져오기
            const dateBoxContainer = document.getElementById("dateBoxContainer");
            const startDateContainer = document.getElementById("startDateContainer");
            const endDateContainer = document.getElementById("endDateContainer");
            const periodLabel = dateBoxContainer.closest('dl').querySelector('dt'); // <dl> 요소를 가져옴
            const periodDl = dateBoxContainer.closest('dl');

            // 기존 내용을 초기화
            // document.getElementById("startDateContainer").innerHTML = "";
            // document.getElementById("endDateContainer").innerHTML = "";

            // 조회연도 필드를 가져옴
            const yearSelectContainer = Array.from(document.querySelectorAll('dl')).find(dl => {
                const dt = dl.querySelector('dt');
                return dt && dt.textContent.includes("조회연도");
            });

            // 시간별, 월별일 경우 조회연도 필드를 숨기거나 표시
            if (periodType === "hourly" || periodType === "monthly") {
                if (yearSelectContainer) yearSelectContainer.style.display = "none"; // 조회연도 숨기기
            } else {
                if (yearSelectContainer) yearSelectContainer.style.display = "block"; // 조회연도 표시
            }

            if (periodType === "yearly") { // 연도별 조회가 선택된 경우
                if (periodDl) periodDl.style.display = "none";
                // 조회기간 글자 숨기기
                periodLabel.style.visibility = "hidden";
                // startDate와 endDate input 요소 숨기기
                startDateContainer.style.display = "none";
                endDateContainer.style.display = "none";
            } else {
                // 조회기간 글자 보이기
                if (periodDl) periodDl.style.display = "block"; // 조회기간 전체 dl 보이기
                periodLabel.style.visibility = "visible";
                // startDate와 endDate input 요소 보이기
                startDateContainer.style.display = "inline-block";
                endDateContainer.style.display = "inline-block";

                // 각 기간유형에 맞는 요소 설정
                if (periodType === "hourly") {
                    const currentDate = new Date();
                    const defaultMonth = (currentDate.getMonth() + 1).toString().padStart(2, '0');
                    const defaultDay = currentDate.getDate().toString().padStart(2, '0');

                    document.getElementById("startDateContainer").innerHTML = `
                <input type="date" id="startDate" name="startDate" value="${selectedYear}-${defaultMonth}-${defaultDay}">
            `;

                    document.getElementById("endDateContainer").innerHTML = `
                <select id="startHour" name="startHour" style="width: 60px;">
                    ${generateHourOptions()}
                </select>
                -
                <select id="endHour" name="endHour" style="width: 60px;">
                    ${generateHourOptions(true)}
                </select>
            `;
                } else if (periodType === "monthly") {
                    const startDate = `${selectedYear}-01`;
                    const endDate = `${selectedYear}-12`;

                    document.getElementById("startDateContainer").innerHTML = `<input type="month" id="startDate" name="startDate" value="${startDate}">`;
                    document.getElementById("endDateContainer").innerHTML = `<input type="month" id="endDate" name="endDate" value="${endDate}">`;
                } else if (periodType === "quarterly") {
                    const options = `
                <option value="Q1">1분기</option>
                <option value="Q2">2분기</option>
                <option value="Q3">3분기</option>
                <option value="Q4">4분기</option>
            `;
                    document.getElementById("startDateContainer").innerHTML = `<select id="startQuarter">${options}</select>`;
                    document.getElementById("endDateContainer").innerHTML = `<select id="endQuarter">${options}</select>`;
                } else if (periodType === "halfyearly") {
                    const options = `
                <option value="H1">상반기</option>
                <option value="H2">하반기</option>
            `;
                    document.getElementById("startDateContainer").innerHTML = `<select id="startHalf">${options}</select>`;
                    document.getElementById("endDateContainer").innerHTML = `<select id="endHalf">${options}</select>`;
                }
            }
        }

        function getISOWeek(date) {
            const target = new Date(date);
            const dayNumber = (date.getDay() + 6) % 7;
            target.setDate(target.getDate() - dayNumber + 3);
            const firstThursday = target.valueOf();
            target.setMonth(0, 1);
            if (target.getDay() !== 4) {
                target.setMonth(0, 1 + ((4 - target.getDay()) + 7) % 7);
            }
            return 1 + Math.ceil((firstThursday - target) / 604800000);
        }

        // 시간 옵션 생성 함수
        function generateHourOptions(isEnd = false) {
            return Array.from({length: 24}, (_, i) => {
                const hour = (i + 1).toString().padStart(2, '0');
                return `<option value="${hour}"${isEnd && hour === '24' || !isEnd && hour === '01' ? ' selected' : ''}>${hour}</option>`;
            }).join('');
        }

        // 스트링 형식으로 레이아웃 정의.
        var layoutStr1 =
            '<rMateChart backgroundColor="#FFFFFF" borderStyle="none">'
            + '<Options>'
            + '<Caption text="유형별"/>'
            // +'<SubCaption text="( $M )" textAlign="right" paddingBottom="35"/>'
            + '<Legend defaultMouseOverAction="true" useVisibleCheck="true"/>'
            + '</Options>'
            + '<Column2DChart seriesMouseOverAction="series" showDataTips="true" columnWidthRatio="0.4" paddingBottom="25">'
            + '<horizontalAxis>'
            + '<CategoryAxis categoryField="Date"/>'
            + '</horizontalAxis>'
            + '<verticalAxis>'
            + '<LinearAxis maximum="100" interval="10"/>'
            + '</verticalAxis>'
            + '<series>'
            + '<Column2DSet type="stacked" showTotalLabel="true" totalLabelJsFunction="totalFunc" labelYOffset="-5">'
            + '<series>'
            + '<Column2DSeries yField="Fault" displayName="Fault" lineToEachItems="false" showLinkLabels="true">'
            + '<showDataEffect>'
            + '</showDataEffect>'
            + '</Column2DSeries>'
            + '<Column2DSeries yField="Alarm" displayName="Alarm" lineToEachItems="false" showLinkLabels="true" fill="#01dbab">'
            + '<showDataEffect>'
            + '</showDataEffect>'
            + '</Column2DSeries>'
            + '<Column2DSeries yField="통신이상" displayName="통신이상" lineToEachItems="false" showLinkLabels="true" fill="#7d88ff">'
            + '<showDataEffect>'
            + '</showDataEffect>'
            + '</Column2DSeries>'
            + '<Column2DSeries yField="가스누출" displayName="가스누출" lineToEachItems="false" showLinkLabels="true">'
            + '<showDataEffect>'
            + '</showDataEffect>'
            + '</Column2DSeries>'
            + '<Column2DSeries yField="연료전지 고온" displayName="연료전지 고온" lineToEachItems="false" showLinkLabels="true">'
            + '<showDataEffect>'
            + '</showDataEffect>'
            + '</Column2DSeries>'
            + '<Column2DSeries yField="계통연계" displayName="계통연계" lineToEachItems="false" showLinkLabels="true">'
            + '<showDataEffect>'
            + '</showDataEffect>'
            + '</Column2DSeries>'
            + '</series>'
            + '</Column2DSet>'
            + '</series>'
            + '</Column2DChart>'
            + '</rMateChart>';


        // rMateChartH5.calls("chart1", {
        //     "setLayout" : layoutStr1,
        //     "setData" : chartData1
        // });

        // 스택 수치 합 사용자 정의 함수
        function totalFunc(index, data, value) {
            if (index == 4)
                return insertComma(value);
            return "";
        }

        //숫자에 천단위 콤마 찍어 반환하는 함수.
        function insertComma(n) {
            var reg = /(^[+-]?\d+)(\d{3})/; // 정규식
            n += "";
            while (reg.test(n))
                n = n.replace(reg, '$1' + "," + '$2');
            return n;
        }

        rMateChartH5.registerTheme(rMateChartH5.themes);

        function rMateChartH5ChangeTheme(theme) {
            document.getElementById("chart1").setTheme(theme);
        }

        // 스트링 형식으로 레이아웃 정의.
        var layoutStr2 =
            '<rMateChart backgroundColor="#FFFFFF" borderStyle="none">'
            + '<Options>'
            + '<Caption text="발생빈도별" paddingBottom="70"/>'
            + '<Legend defaultMouseOverAction="true" useVisibleCheck="true"/>'
            + '</Options>'
            + '<Pie2DChart innerRadius="0.5" showDataTips="true" selectionMode="single" paddingBottom="25">'
            + '<series>'
            + '<Pie2DSeries nameField="division" field="Profit" startAngle="20" renderDirection="clockwise" labelPosition="inside" color="#ffffff" itemRollOverEmphasize="true">'
            /* Pie2DChart 정의 후 Pie2DSeries labelPosition="inside"정의합니다 */
            + '<showDataEffect>'
            /* 차트 생성시에 Effect를 주고 싶을 때 shoDataEffect정의합니다 */
            + '<SeriesSlide previewColor="#eeeeee" duration="1000"/>'
            + '</showDataEffect>'
            + '</Pie2DSeries>'
            + '</series>'
            + '<backgroundElements>'
            + '<CanvasElement>'
            + '</CanvasElement>'
            + '</backgroundElements>'
            + '</Pie2DChart>'
            + '</rMateChart>';

        // rMateChartH5.calls("chart2", {
        //     "setLayout" : layoutStr2,
        //     "setData" : chartData2
        // });

        rMateChartH5.registerTheme(rMateChartH5.themes);

        // $(document).ready(function() {
        //     // 모든 chart-wrap 요소에 투명한 오버레이를 자동으로 추가
        //     $('.chart-wrap').each(function () {
        //         // 오버레이 요소를 생성
        //         let overlay = $('<div class="chart-overlay"></div>');
        //
        //         // 오버레이 스타일 적용
        //         overlay.css({
        //             'position': 'absolute',
        //             'top': '0',
        //             'left': '0',
        //             'width': '100%',
        //             'height': '100%',
        //             'cursor': 'pointer',
        //             'z-index': '10',
        //             'background': 'transparent'
        //         });
        //
        //         // chart-wrap에 오버레이 추가
        //         $(this).css('position', 'relative').append(overlay);
        //     });
        //
        //
        //     // .chart-wrap에 클릭 이벤트 바인딩 (동적 요소에 대해서도 대응)
        //     $(document).on('click', '.chart-overlay', function() {
        //         // 클릭한 div의 id 가져오기
        //         let chartHolderId = $(this).prev('div[id^="chartHolder"]').attr('id');
        //
        //         // ID가 제대로 추출되었는지 확인
        //         console.log("Clicked chartHolder ID: " + chartHolderId);
        //
        //         // 모달 열기
        //         let modal = document.getElementById("chartModal");
        //         let modalChartHolder = document.getElementById("modalChartHolder");
        //         modal.style.display = "block";
        //
        //         // 기존 차트의 레이아웃과 데이터를 모달 차트로 설정
        //         rMateChartH5.create(chartHolderId + "_modal", "modalChartHolder", "rMateOnLoadCallFunction=chartReadyHandler", "100%", "100%");
        //
        //         // 모달 닫기 버튼 클릭 시 모달 닫기
        //         let closeModal = document.getElementsByClassName("close")[0];
        //         closeModal.onclick = function() {
        //             modal.style.display = "none";
        //             modalChartHolder.innerHTML = ""; // 모달 차트 초기화
        //         }
        //
        //         // 모달 외부를 클릭하면 모달 닫기
        //         window.onclick = function(event) {
        //             if (event.target === modal) {
        //                 modal.style.display = "none";
        //                 modalChartHolder.innerHTML = ""; // 모달 차트 초기화
        //             }
        //         }
        //     });
        // });


    </script>
</th:block>

</html>