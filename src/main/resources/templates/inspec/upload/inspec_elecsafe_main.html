<html layout:decorate="~{layout_page}" xmlns:layout="http://www.w3.org/1999/xhtml">
<style>

</style>
<th:block layout:fragment="content">

            <!--- (레이아웃) Contents 영역 -->
            <div class="layout-contents">
                <!-- Page Title -->
                <div class="page-title-wrap">
                    <div class="left">
                        <h2>전기안전관리</h2>
                        <a href="#" title="북마크" class="bookmark toggle">
                            내메뉴
                        </a>
                    </div>
                    <ul class="page-navi">
                        <li><img src="/images/icon/ico-nav-home.svg" alt="홈아이콘"></li>
                        <li>점검관리</li>
                        <li>전기안전관리</li>
                    </ul>
                </div>
                <!-- Select -->
                <div class="search-wrap">
                    <ul>
                        <li>
                            <select title="지역">
                                <option>대구</option>
                            </select>
                        </li>
                        <li>
                            <select title="구">
                                <option>성서산단</option>
                            </select>
                        </li>
                        <li>
                            <select title="동">
                                <option>성서</option>
                            </select>
                        </li>
                    </ul>
                </div>
                <div class="tab-wrap">
                    <ul class="tab-links">
                        <li>
                            <a href="#tab1" title="목록">목록</a>
                        </li>
                        <li>
                            <a href="#tab2" title="등록">등록</a>
                        </li>
                    </ul>
                    <div class="tab-contents">
                        <!-- Section -->
                        <section class="tab-item" id="tab1">
                            <div class="section-top">
                                <div class="search-wrap">
                                    <dl>
                                        <dt>
                                            점검일자<span class="eq">*</span>
                                        </dt>
                                        <dd>
                                            <ul class="date-box">
                                                <li>
                                                    <input type="date" id="date1" name="">
                                                    <label for="date1" class="hide">시작일</label>
                                                </li>
                                                <li>
                                                    <input type="date" id="date2" name="">
                                                    <label for="date2" class="hide">종료일</label>
                                                </li>
                                            </ul>
                                        </dd>
                                    </dl>
                                    <dl>
                                        <dt>
                                            <label for="inspec_name">
                                                점검자<span class="eq">*</span>
                                            </label>
                                        </dt>
                                        <dd>
                                            <div class="srch-box">
                                                <input type="text" id="inspec_name" class="input-srch"
                                                       placeholder="점검자명 검색">
                                                <a href="#a" class="btn-srch" title="검색"></a>
                                            </div>
                                        </dd>
                                    </dl>
                                    <dl>
                                        <dt>
                                            <label for="inspec_cop">
                                                협력사<span class="eq">*</span>
                                            </label>
                                        </dt>
                                        <dd>
                                            <div class="srch-box">
                                                <input type="text" id="inspec_cop" class="input-srch"
                                                       placeholder="협력사명 검색">
                                                <a href="#a" class="btn-srch" title="검색"></a>
                                            </div>
                                        </dd>
                                    </dl>
                                </div>
                                <div class="button-wrap">
                                    <ul>
                                        <li>
                                            <a href="#" class="btn btn-excell" title="엑셀다운로드">
                                                <img src="/images/icon/ico-excell.svg" alt="엑셀 아이콘">
                                                엑셀다운로드
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="btn btn-delete" title="삭제">
                                                <img src="/images/icon/ico-delete.svg" alt="엑셀 아이콘">
                                                삭제
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="btn btn-edit" title="수정">
                                                <img src="/images/icon/ico-edit.svg" alt="엑셀 아이콘">
                                                수정
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="btn btn-print" title="순회점검일지 출력">
                                                <img src="/images/icon/ico-print.svg" alt="엑셀 아이콘">
                                                순회점검일지 출력
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div> <!--//section-top end -->
                            <div class="table-wrap">
                                <table class="list-table">
                                    <caption>공지사항 테이블</caption>
                                    <colgroup>
                                        <col class="wp5">
                                        <col class="wp10">
                                        <col class="wp10">
                                        <col class="wp10">
                                        <col class="wp10">
                                        <col class="wp10">
                                        <col class="wp10">
                                        <col class="wauto">
                                        <col class="wp10">
                                        <col class="wp10">
                                    </colgroup>
                                    <thead>
                                    <tr>
                                        <th>No</th>
                                        <th>지역</th>
                                        <th>산단명</th>
                                        <th>발전소명</th>
                                        <th>등록일자</th>
                                        <th>점검자</th>
                                        <th>점검장소</th>
                                        <th>점검시간</th>
                                        <th>점검일지 다운로드</th>
                                        <th>점검일지 업로드</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <td>1</td>
                                        <td>대구</td>
                                        <td>성서산단</td>
                                        <td>성서</td>
                                        <td>2024-06-10</td>
                                        <td>홍길동</td>
                                        <td>성서산단</td>
                                        <td>06.10 13:00 ~ 06.10 15:00</td>
                                        <td>
                                            <a href="#" title="다운로드" class="btn-filedown">다운로드</a>
                                        </td>
                                        <td>
                                            <a href="#" title="업로드" class="btn btn-popup-open" data-popup="popup1">
                                                업로드
                                            </a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>1</td>
                                        <td>대구</td>
                                        <td>성서산단</td>
                                        <td>성서</td>
                                        <td>2024-06-10</td>
                                        <td>홍길동</td>
                                        <td>성서산단</td>
                                        <td>06.10 13:00 ~ 06.10 15:00</td>
                                        <td>
                                            <a href="#" title="다운로드" class="btn-filedown">다운로드</a>
                                        </td>
                                        <td>
                                            <a href="#" title="업로드" class="btn btn-popup-open" data-popup="popup1">
                                                업로드
                                            </a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>1</td>
                                        <td>대구</td>
                                        <td>성서산단</td>
                                        <td>성서</td>
                                        <td>2024-06-10</td>
                                        <td>홍길동</td>
                                        <td>성서산단</td>
                                        <td>06.10 13:00 ~ 06.10 15:00</td>
                                        <td>
                                            <a href="#" title="다운로드" class="btn-filedown">다운로드</a>
                                        </td>
                                        <td>
                                            <a href="#" title="업로드" class="btn btn-popup-open" data-popup="popup1">
                                                업로드
                                            </a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>1</td>
                                        <td>대구</td>
                                        <td>성서산단</td>
                                        <td>성서</td>
                                        <td>2024-06-10</td>
                                        <td>홍길동</td>
                                        <td>성서산단</td>
                                        <td>06.10 13:00 ~ 06.10 15:00</td>
                                        <td>
                                            <a href="#" title="다운로드" class="btn-filedown">다운로드</a>
                                        </td>
                                        <td>
                                            <a href="#" title="업로드" class="btn btn-popup-open" data-popup="popup1">
                                                업로드
                                            </a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>1</td>
                                        <td>대구</td>
                                        <td>성서산단</td>
                                        <td>성서</td>
                                        <td>2024-06-10</td>
                                        <td>홍길동</td>
                                        <td>성서산단</td>
                                        <td>06.10 13:00 ~ 06.10 15:00</td>
                                        <td>
                                            <a href="#" title="다운로드" class="btn-filedown">다운로드</a>
                                        </td>
                                        <td>
                                            <a href="#" title="업로드" class="btn btn-popup-open" data-popup="popup1">
                                                업로드
                                            </a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>1</td>
                                        <td>대구</td>
                                        <td>성서산단</td>
                                        <td>성서</td>
                                        <td>2024-06-10</td>
                                        <td>홍길동</td>
                                        <td>성서산단</td>
                                        <td>06.10 13:00 ~ 06.10 15:00</td>
                                        <td>
                                            <a href="#" title="다운로드" class="btn-filedown">다운로드</a>
                                        </td>
                                        <td>
                                            <a href="#" title="업로드" class="btn btn-popup-open" data-popup="popup1">
                                                업로드
                                            </a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>1</td>
                                        <td>대구</td>
                                        <td>성서산단</td>
                                        <td>성서</td>
                                        <td>2024-06-10</td>
                                        <td>홍길동</td>
                                        <td>성서산단</td>
                                        <td>06.10 13:00 ~ 06.10 15:00</td>
                                        <td>
                                            <a href="#" title="다운로드" class="btn-filedown">다운로드</a>
                                        </td>
                                        <td>
                                            <a href="#" title="업로드" class="btn btn-popup-open" data-popup="popup1">
                                                업로드
                                            </a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>1</td>
                                        <td>대구</td>
                                        <td>성서산단</td>
                                        <td>성서</td>
                                        <td>2024-06-10</td>
                                        <td>홍길동</td>
                                        <td>성서산단</td>
                                        <td>06.10 13:00 ~ 06.10 15:00</td>
                                        <td>
                                            <a href="#" title="다운로드" class="btn-filedown">다운로드</a>
                                        </td>
                                        <td>
                                            <a href="#" title="업로드" class="btn btn-popup-open" data-popup="popup1">
                                                업로드
                                            </a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>1</td>
                                        <td>대구</td>
                                        <td>성서산단</td>
                                        <td>성서</td>
                                        <td>2024-06-10</td>
                                        <td>홍길동</td>
                                        <td>성서산단</td>
                                        <td>06.10 13:00 ~ 06.10 15:00</td>
                                        <td>
                                            <a href="#" title="다운로드" class="btn-filedown">다운로드</a>
                                        </td>
                                        <td>
                                            <a href="#" title="업로드" class="btn btn-popup-open" data-popup="popup1">
                                                업로드
                                            </a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>1</td>
                                        <td>대구</td>
                                        <td>성서산단</td>
                                        <td>성서</td>
                                        <td>2024-06-10</td>
                                        <td>홍길동</td>
                                        <td>성서산단</td>
                                        <td>06.10 13:00 ~ 06.10 15:00</td>
                                        <td>
                                            <a href="#" title="다운로드" class="btn-filedown">다운로드</a>
                                        </td>
                                        <td>
                                            <a href="#" title="업로드" class="btn btn-popup-open" data-popup="popup1">
                                                업로드
                                            </a>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="btn-wrap">
                                <div class="center">
                                    <ul class="paging-wrap">
                                        <li><a href="#" title="처음" class="btn-first"></a></li>
                                        <li><a href="#" title="이전" class="btn-prev"></a></li>
                                        <li class="on"><a href="#" title="1">1</a></li>
                                        <li><a href="#" title="2">2</a></li>
                                        <li><a href="#" title="3">3</a></li>
                                        <li><a href="#" title="4">4</a></li>
                                        <li><a href="#" title="5" class="disable">5</a></li>
                                        <li><a href="#" title="다음" class="btn-next"></a></li>
                                        <li><a href="#" title="마지막" class="btn-last"></a></li>
                                    </ul>
                                </div>
                            </div>
                        </section>
                        <!-- Section -->
                        <section class="tab-item" id="tab2">
                            <div class="section-top">
                                <div class="title-wrap">
                                    <h3>전기안전점검 등록</h3>
                                </div>
                                <div class="button-wrap">
                                    <ul>
                                        <li>
                                            <a href="#" class="btn btn-excell" title="신규등록">
                                                <img src="/images/icon/ico-plus.svg" alt="등록 아이콘">
                                                신규등록
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="btn btn-delete" title="삭제">
                                                <img src="/images/icon/ico-delete.svg" alt="삭제 아이콘">
                                                삭제
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="btn btn-edit" id="btnSave" title="저장">
                                                <img src="/images/icon/ico-save.svg" alt="저장 아이콘">
                                                저장
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="table-wrap">
                                <table class="write-table">
                                    <form id="customForm">
                                        <input type="hidden" id="spworkcd" name="spworkcd" value="001"/>
                                        <input type="hidden" id="spworknm" name="spworknm" value="대구"/>
                                        <input type="hidden" id="spcompcd" name="spcompcd" value="002"/>
                                        <input type="hidden" id="spplancd" name="spplancd" value="003"/>
                                        <input type="hidden" id="checksdt" name="checksdt" value="20240701"/>
                                        <input type="hidden" id="checkedt" name="checkedt" value="20240705"/>
                                        <input type="hidden"  id="inusernm" name="inusernm" th:value="${username}"/>
                                        <caption>점검등록 테이블</caption>
                                        <colgroup>
                                            <col class="wp12">
                                            <col class="wp40">
                                            <col class="wp12">
                                            <col class="wp40">
                                        </colgroup>
                                        <tbody>
                                        <tr>
                                            <th>
                                                <label for="title">
                                                    제목
                                                </label>
                                            </th>
                                            <td>
                                                <input type="text" id="title" class="wp100" placeholder="제목">
                                            </td>
                                            <th>
                                                <label for="inspec_year">
                                                    점검년도
                                                </label>
                                            </th>
                                            <td>
                                                <select id="inspec_year" name="inspec_year">
                                                </select>
                                            </td>
                                        </tr>
                                        <tr>
                                            <th>
                                                <label for="inspec_date">
                                                    점검일자
                                                </label>
                                            </th>
                                            <td>
                                                <input type="date" id="inspec_date" name="inspec_date">
                                            </td>
                                            <th>
                                                <label for="doc_select">
                                                    문서구분 <span class="req">*</span>
                                                </label>
                                            </th>
                                            <td>
                                                <select id="doc_select" name="doc_select">
                                                    <option>전기설비점검결과표</option>
                                                </select>
                                            </td>
                                        </tr>
                                        <tr>
                                            <th>
                                                <label for="inspec_loc">
                                                    점검장소 <span class="req">*</span>
                                                </label>
                                            </th>
                                            <td>
                                                <input type="text" id="inspec_loc" class="wp100" placeholder="점검장소">
                                            </td>
                                        </tr>
                                        <tr>
                                            <th>
                                                <label for="endresult">
                                                    점검사항
                                                </label>
                                            </th>
                                            <td>
                                                <div class="textarea-box">
                                                    <textarea id="endresult" placeholder="점검사항"></textarea>
                                                    <p class="text-count" id="text-count1">0/100</p>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <th>
                                                첨부파일
                                            </th>
                                            <td colspan="3">
                                                <div id="uploadComponent1" class="upload-component">
                                                    <div class="upload-filebox">
                                                        <img src="/images/icon/ico-fileupload.svg" alt="업로드아이콘">
                                                        <a href="#" class="btn" title="파일업로드">파일업로드</a>
                                                        <input type="file" id="fileInput1" class="fileInput" multiple>
                                                        <p>Maximun upload file size <span>1GiB</span></p>
                                                    </div>
                                                    <div class="upload-filelist">
                                                        <div class="title">
                                                            <h5>Files (0)</h5>
                                                            <a href="#" title="Delete all" class="btn-file-deleteall">Delete
                                                                all</a>
                                                        </div>
                                                        <ul class="filelist" id="filelist">
                                                        </ul>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </form>
                                </table>
                            </div>
                        </section>
                    </div> <!--//tab-contens end-->
                </div> <!--//tab-wrap end-->
            </div> <!--//layout-contents end -->
            <footer>
                <p>Copyrightⓒ 0000 corp. All rights reserved.</p>
            </footer>
        </div> <!-- //dashboard-layout-right end-->

    </div> <!-- //dashboard-layout-contents end-->

</th:block>

<th:block layout:fragment="scripts">
    <th:block th:replace="/common/columns_setting :: columns_setting"></th:block>

    <script type="text/javascript">

        class ElecSafePage {
            constructor() {
                this.url = '/api/inspec/elec_safe';

            }

            // 정보 저장
            saveData() {
                let formData = new FormData($('#customForm')[0]);
                let filesList = $('#uploadComponent1')[0].uploadedFiles;

                for (var i = 0; i < filesList.length; i++) {
                    formData.append('filelist', filesList[i]);
                }

                formData.append('title', $('#title').val());
                formData.append('inspec_date', $('#inspec_date').val());
                formData.append('inspec_loc', $('#inspec_loc').val());
                formData.append('endresult', $('#endresult').val());
                formData.append('_csrf', $('[name=_csrf]').val());

                $.ajax({
                    url: this.url + "/save",
                    type: 'POST',
                    data: formData,
                    processData: false,
                    contentType: false,
                    success: function (response) {
                        if (response.success) {
                            Alert.alert('', '저장에 성공했습니다.' + response.message);
                            location.reload();
                        } else {
                            Alert.alert('', '저장에 실패했습니다. ' + response.message);
                        }
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        Alert.alert('', '에러가 발생하였습니다.');
                    }
                });
            }
        }

        $(document).ready(function (e) {

            var page = new ElecSafePage();


            $('#btnSave').click(function (e) {
                e.preventDefault();
                Alert.confirm('', '저장하시겠습니까?', function () {
                    page.saveData();

                });
            });
        });

        /* 점검년도 */
        const currentYear = new Date().getFullYear();
        const yearSelect = document.getElementById('inspec_year');
        const startYear = currentYear - 5; // 5년 전부터

        // 년도 옵션을 동적으로 생성합니다.
        for (let year = currentYear; year >= startYear; year--) {
            const option = document.createElement('option');
            option.value = year;
            option.textContent = year;
            yearSelect.appendChild(option);
        }

        // 기본 선택 년도를 현재 년도로 설정합니다.
        yearSelect.value = currentYear;

    </script>

</th:block>
</html>

