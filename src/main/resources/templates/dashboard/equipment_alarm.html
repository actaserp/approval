<html layout:decorate="~{layout_page}" xmlns:layout="http://www.w3.org/1999/xhtml">
<style>

</style>

<th:block layout:fragment="content">


    <div class="layout-contents">
        <!-- Page Title -->
        <div class="page-title-wrap">
            <div class="left">
                <h2>알림이력</h2>
                <a title="북마크" class="bookmark toggle">
                    내메뉴
                </a>
            </div>
            <ul class="page-navi">
                <li><img src="/images/icon/ico-nav-home.svg" alt="홈아이콘"></li>
                <li>모니터링</li>
                <li>종합관제</li>
                <li>장비알림이력</li>
            </ul>
        </div>
        <!-- Select -->
        <div class="search-wrap">
            <ul>
                <li>
                    <select title="지역">
                        <option>대구</option>
                    </select>
                </li>
                <li>
                    <select title="구">
                        <option>성서산단</option>
                    </select>
                </li>
                <li>
                    <select title="동">
                        <option>성서</option>
                    </select>
                </li>
            </ul>
        </div>
        <div class="tab-wrap" id="jqueryTabs">
            <ul class="tab-links">
                <li>
                    <a href="#tab1" title="목록" class="tab-button">리스트</a>
                </li>
                <li>
                    <a href="#tab2" title="등록" id="runrmate" class="tab-button">통계</a>
                </li>
            </ul>
            <div class="tab-contents" style="margin-bottom: 70px">
                <!-- Section -->



                <section class="tab-item tab-content" id="tab1">
                    <div class="section-top">
                        <div class="search-wrap">
                            <dl>
                                <dt>
                                    조회기간<span class="eq">*</span>
                                </dt>
                                <dd>
                                    <ul class="date-box">
                                        <li>
                                            <input type="date" id="searchfrdate" name="searchfrdate">
                                            <label for="searchfrdate" class="hide">시작일</label>
                                        </li>
                                        <li>
                                            <input type="date" id="searchtodate" name="searchtodate">
                                            <label for="searchtodate" class="hide">종료일</label>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <dl>
                                <dt>
                                    <label for="select1">
                                        구분<span class="eq">*</span></label></dt>

                                <dd>
                                    <select id="select1323" class="w120">
                                        <option>Fault</option>
                                        <option>Alarm</option>
                                        <option>통신이상</option>
                                        <option>가스누출</option>
                                        <option>연료전지 고온</option>
                                        <option>계통연계</option>

                                    </select>
                                </dd>
                            </dl>
                            <dl>
                                <dt>
                                    <label for="select1">
                                        검색조건<span class="eq">*</span></label></dt>

                                <dd>
                                    <select id="select111" class="w120">
                                        <option>일</option>
                                        <option>주</option>
                                        <option>월</option>
                                        <option>년</option>
                                    </select>
                                </dd>
                            </dl>
                            <dl>
                                <dt>
                                    <label for="select1">
                                        확인여부</label></dt>

                                <dd>
                                    <select id="select134" class="w120">
                                        <option>전체</option>
                                        <option>확인</option>
                                        <option>미확인</option>
                                    </select>
                                </dd>
                            </dl>
                            <dl style="margin-left: 40px;">
                                <dt>

                                </dt>
                                <dd>
                                    <div class="srch-box">
                                        <div class="input-clear"></div>
                                        <a href="#a" class="btn-srch" id="searchgrid" title="검색" onclick="searchData()" onkeyup="searchData()" style="border-radius: 7px;"></a>
                                    </div>
                                </dd>
                            </dl>
                        </div>

                    </div> <!--//section-top end -->
                    <div class="container-fluid">
                        <p id="selectedItem"></p>
                        <div id="theGrid"></div>
                    </div>

                    <div class="btn-wrap">
                    </div>
                </section>

                <section class="tab-item tab-content" id="tab2">
                    <div class="section-top">
                        <div class="search-wrap">
                            <dl>
                                <dt>
                                    조회기간<span class="eq">*</span>
                                </dt>
                                <dd>
                                    <ul class="date-box">
                                        <li>
                                            <input type="date" id="searchfrdate2" name="searchfrdate">
                                            <label for="searchfrdate" class="hide">시작일</label>
                                        </li>
                                        <li>
                                            <input type="date" id="searchtodate12" name="searchtodate">
                                            <label for="searchtodate" class="hide">종료일</label>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <dl>
                                <dt>
                                    <label for="select1">
                                        구분<span class="eq">*</span></label></dt>

                                <dd>
                                    <select id="select13" class="w120">
                                        <option>Fault</option>
                                        <option>Alarm</option>
                                        <option>통신이상</option>
                                        <option>가스누출</option>
                                        <option>연료전지 고온</option>
                                        <option>계통연계</option>

                                    </select>
                                </dd>
                            </dl>
                            <dl>
                                <dt>
                                    <label for="select1">
                                        검색조건<span class="eq">*</span></label></dt>

                                <dd>
                                    <select id="select12" class="w120">
                                        <option>일</option>
                                        <option>주</option>
                                        <option>월</option>
                                        <option>년</option>
                                    </select>
                                </dd>
                            </dl>

                            <dl style="margin-left: 40px;">
                                <dt>

                                </dt>
                                <dd>
                                    <div class="srch-box">
                                        <div class="input-clear"></div>
                                        <a href="#a" class="btn-srch" id="runf"  title="검색" style="border-radius: 7px;"></a>
                                    </div>
                                    <!--<div class="button button_top"><a id="test">Column Chart</a></div>-->
                                </dd>
                            </dl>
                        </div>

                    </div> <!--//section-top end -->
                    <div class="row">

                    <div class="row row-2" style="width: 100%">
                        <section class="wp48" style="height: 530px">
                            <!-- 그래프 -->
                            <div id="chartHolder1" style="width:600px; height:400px;">
                            </div>
                        </section>
                        <section class="wp48" style="height: 530px">
                            <!--<img src="/images/알림이력2.png" style="width: 100%"/>-->
                            <div id="chartHolder2" style="width:600px; height:400px;">
                        </section>
                    </div>
                    </div>
                </section>


                <!-- Section -->

            </div> <!--//tab-contens end-->
        </div> <!--//tab-wrap end-->
    </div> <!--//layout-contents end -->








</th:block>
<th:block layout:fragment="scripts">
    <th:block th:replace="/common/approve_box :: approve_box"></th:block>
    <th:block th:replace="/common/ax5_uploader :: ax5_uploader" ></th:block>
    <th:block th:replace="/common/upload_one_image_box :: upload_one_image_box" ></th:block>
    <th:block th:replace="/common/popup_select_user_code :: popup_select_user_code"></th:block>


    <script type="text/javascript">



        var theGrid;
        var viewdata;
        let selectedFiles = [];
        let SelectItem;
        let csrfToken = $("[name=_csrf]").val();

        var columns = [
            { binding: '', header: '발생일시', align: 'center', width: 190},
            { binding: '', header: '장비', align: 'center', width: 190 },
            { binding: '', header: '이벤트내용', align: 'center', minWidth: 270 , width: '*' },
            { binding: '', header: '조치일시', align: 'center', minWidth: 170 , width: '*' },
            { binding: '', header: '조치자', align: 'center', width: 210 },
            { binding: '', header: '조치내용', align: 'center', minWidth: 210 , width: '*' },
            { binding: '', header: '확인', align: 'center', width: 140 },
        ];



        document.readyState === 'complete' ? init() : window.onload = init;


        <!-- 초반 페이지 진입시 그리드 바인딩 끝-->
        function init() {
            let data2 = [];
            let searchusr = $('#searchusr').val();

            $.ajax({
                url: '/api/inspec_report/read',
                type: 'GET',
                data: {
                    'searchusr' : 'infinited',

                },
                async: false,
                success: function(data){
                    console.log('check1',data.data);
                    if(data.data.length === 0){
                        for(let i=0; i < 10; i++ ){
                            data.data.push('example');
                        }
                    }
                    console.log(data.data);
                    data2 = data.data;
                }
            })

            viewdata = new wijmo.collections.CollectionView(data2);
            // 데이터 그리드에 바인딩
            theGrid = new wijmo.grid.FlexGrid('#theGrid', {
                autoGenerateColumns: false,
                showMarquee: true,
                columns: columns,
                itemsSource: viewdata
            });

            // 선택이 변경될 때, 현재 항목 업데이트

            theGrid.rowHeaders.columns.splice(0,1);  //맨 앞에 헤더부분 없애기
        }
        <!-- 초반 페이지 진입시 그리드 바인딩 끝-->




        $(document).ready(function() {

                let LoadingCheck = false;
            $('#runrmate').click(function() {

                if(LoadingCheck === false){
                setTimeout(function() {
                    //$('#runf').trigger('click');
                    let con = "chart1"
                    rMateChartH5.create(con, "chartHolder" + con.replace(/\D/g, ""), chartVars, "100%", "100%");
                    let con2 = "chart2"
                    rMateChartH5.create(con2, "chartHolder" + con2.replace(/\D/g, ""), chartVars2, "120%", "120%");

                    LoadingCheck = true;
                }, 100); // 3000ms = 3초
                }
            });

            // Show the first tab by default


            $("#test").click(function(event){
                let con = "chart2"
                rMateChartH5.create(con, "chartHolder" + con.replace(/\D/g, ""), chartVars2, "120%", "120%");
            })
        });


        let chartVars = "rMateOnLoadCallFunction=chartReadyHandler";
        let chartVars2 = "rMateOnLoadCallFunction=chartReadyHandler2";

        function chartReadyHandler2(id) {
            document.getElementById(id).setLayout(window["layoutStr" + id.replace(/\D/g, "")]);
            document.getElementById(id).setData(chartData2);

            //document.getElementById(id).resize();
        }
        function chartReadyHandler(id) {
            document.getElementById(id).setLayout(window["layoutStr" + id.replace(/\D/g, "")]);
            document.getElementById(id).setData(chartData);

            document.getElementById(id).resize();
        }


        var layoutStr1 =
            '<rMateChart backgroundColor="#FFFFFF" borderStyle="none">'
            +'<Options>'
            +'<Caption text="유형별"/>'
            +'<SubCaption text="( $M )" textAlign="right" paddingBottom="35"/>'
            +'<Legend defaultMouseOverAction="true" useVisibleCheck="true"/>'
            +'</Options>'
            +'<Column2DChart seriesMouseOverAction="series" showDataTips="true" columnWidthRatio="0.4" paddingBottom="25">'
            +'<horizontalAxis>'
            +'<CategoryAxis categoryField="Month"/>'
            +'</horizontalAxis>'
            +'<verticalAxis>'
            +'<LinearAxis maximum="100" interval="10"/>'
            +'</verticalAxis>'
            +'<series>'
            /*
            type 속성을 stacked로 변경
            type속성으로는
            clustered : 일반적인 다중데이터(차트의 멀티시리즈)방식으로 데이터를 표현합니다.(Default)
            stacked : 데이터를 위에 쌓아 올린 방식으로 표현 합니다.
            overlaid : 수치 데이터 값을 겹쳐서 표현 합니다. 주로 목표 위치와 현재 위치를 나타낼 때 많이 쓰입니다.
            100% : 차트의 수치 데이터를 퍼센티지로 계산 후 값을 퍼센티지로 나타냅니다.
            */
            +'<Column2DSet type="stacked" showTotalLabel="true" totalLabelJsFunction="totalFunc" paddingBottom="9" labelYOffset="-5">'
            +'<series>'
            +'<Column2DSeries yField="tv" displayName="TV" lineToEachItems="true" showLinkLabels="true">'
            /* lineToEachItems : True로 설정 하면 Series간에 선을 이어준다 */
            +'<showDataEffect>'
            +'<SeriesInterpolate2/>'
            +'</showDataEffect>'
            +'</Column2DSeries>'
            +'<Column2DSeries yField="tablet" displayName="Tablet" lineToEachItems="true" showLinkLabels="true" fill="#01dbab">'
            +'<showDataEffect>'
            +'<SeriesInterpolate2/>'
            +'</showDataEffect>'
            +'</Column2DSeries>'
            +'<Column2DSeries yField="phone" displayName="Cell Phone" lineToEachItems="true" showLinkLabels="true" fill="#7d88ff">'
            +'<showDataEffect>'
            +'<SeriesInterpolate2/>'
            +'</showDataEffect>'
            +'</Column2DSeries>'
            +'</series>'
            +'</Column2DSet>'
            +'</series>'
            +'</Column2DChart>'
            +'</rMateChart>';


        var layoutStr2 =
            '<rMateChart backgroundColor="#FFFFFF" borderStyle="none" paddingBottom="20">'
            +'<Options>'
            +'<Caption text="발생빈도별"/>'
            +'<SubCaption text="August 2018" paddingBottom="90"/>'
            +'<Legend defaultMouseOverAction="true" useVisibleCheck="true"/>'
            +'</Options>'
            +'<CurrencyFormatter id="numFmt" currencySymbol="%" alignSymbol="right"/>'
            /*
            Pie3D 차트 생성시에 필요한 Pie3DChart 정의합니다
            showDataTips : 데이터에 마우스를 가져갔을 때 나오는 Tip을 보이기/안보이기 속성입니다.
            */
            +'<Pie3DChart showDataTips="true" depth="50" elevation="50" paddingBottom="35">'
            +'<series>'
            +'<Pie3DSeries nameField="browser" field="share" labelPosition="inside" color="#ffffff" startAngle="240" itemRollOverEmphasize="true">'
            /* Pie3DChart 정의 후 Pie3DSeries labelPosition="inside"정의합니다 */
            +'<showDataEffect>'
            /* 차트 생성시에 Effect를 주고 싶을 때 shoDataEffect정의합니다 */
            +'<SeriesInterpolate duration="1000"/>'
            /*
            SeriesInterpolate 효과는 시리즈 데이터가 데이터로 표시될 때 데이터의 변화된 내용을 가지고 효과를 적용합니다
            - 공통 -
            elementOffset : effect를 지연시키는 시간을 지정합니다 default:20
            minimumElementDuration : 각 엘리먼트의 최소 지속 시간을 설정합니다 default:0
                         이 값보다 짧은 시간에 effect가 실행되지 않습니다
            offset : effect개시의 지연시간을 설정합니다 default:0
            perElementOffset : 각 엘리먼트의 개시 지연시간을 설정합니다
            */
            +'</showDataEffect>'
            +'</Pie3DSeries>'
            +'</series>'
            +'</Pie3DChart>'
            +'</rMateChart>';

        var layoutStr3 =
            '<rMateChart backgroundColor="#FFFFFF"  borderStyle="none">'
            +'<Options>'
            +'<Caption text="Rainfall" />'
            +'<SubCaption text="( mm )" textAlign="right" />'
            +'</Options>'
            +'<Pie2DChart showDataTips="true" padding="20">'
            +'<series>'
            +'<Pie2DSeries field="Vancouver" nameField="Month" labelPosition="inside" color="#FFFFFF">'
            +'<showDataEffect>'
            +'<SeriesInterpolate/>'
            +'</showDataEffect>'
            +'</Pie2DSeries>'
            +'</series>'
            +'</Pie2DChart>'
            +'</rMateChart>';

        var chartData =
            [{"Month":"Jan", "phone":12, "tv":11, "tablet":12},
                {"Month":"Feb", "phone":14, "tv":19, "tablet":17},
                {"Month":"Mar", "phone":23, "tv":25, "tablet":20},
                {"Month":"Apr", "phone":20, "tv":20, "tablet":18},
                {"Month":"May", "phone":35, "tv":25, "tablet":25},
                {"Month":"Jun", "phone":20, "tv":22, "tablet":23},
                {"Month":"Jul", "phone":17, "tv":20, "tablet":17},
                {"Month":"Aug", "phone":23, "tv":21, "tablet":21},
                {"Month":"Sep", "phone":18, "tv":17, "tablet":10}];

        var chartData2 =
            [{"browser":"Chrome", "share":68},
                {"browser":"Internet Explorer", "share":12},
                {"browser":"Firefox", "share":11},
                {"browser":"Safari", "share":6},
                {"browser":"Opera", "share":3}];

        function totalFunc(index, data, value){
            if(index == 4)
                return insertComma(value);
            return "";
        }

        //숫자에 천단위 콤마 찍어 반환하는 함수.
        function insertComma(n) {
            var reg = /(^[+-]?\d+)(\d{3})/; // 정규식
            n += "";
            while (reg.test(n))
                n = n.replace(reg, '$1' + "," + '$2');
            return n;
        }

    </script>
</th:block>

</html>