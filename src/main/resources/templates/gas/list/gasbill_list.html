<html layout:decorate="~{layout_page}" xmlns:layout="http://www.w3.org/1999/xhtml">
<head>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <style>


        /* 차트 확장 아이콘 css */
        .expand-icon {
            position: relative;
            width: 20px; /* 전체 크기 20px */
            height: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #FFFFFF; /* 아이콘 배경색 */
        }

        .expand-icon .corner {
            position: absolute;
            width: 6px; /* 꺾은선 크기 */
            height: 6px;
            border: 2px solid #808080; /* 꺾은선 색상 */
        }

        .corner.corner-1 {
            top: 0;
            left: 0;
            border-right: none;
            border-bottom: none;
        }

        .corner.corner-2 {
            top: 0;
            right: 0;
            border-left: none;
            border-bottom: none;
        }

        .corner.corner-3 {
            bottom: 0;
            left: 0;
            border-right: none;
            border-top: none;
        }

        .corner.corner-4 {
            bottom: 0;
            right: 0;
            border-left: none;
            border-top: none;
        }

        .expand-icon span {
            display: block;
            position: absolute;
            background-color: #808080;
        }

        .icon-horizontal, .icon-vertical {
            position: absolute;
            background-color: black;
            width: 100%; /* 선 길이를 모서리까지 확장 */
            height: 2px; /* 선 두께 */
        }

        .icon-horizontal {
            top: 50%;
            left: 0;
            transform: translateY(-50%) rotate(45deg); /* 45도 회전하여 대각선 */
        }

        .icon-vertical {
            top: 50%;
            left: 0;
            transform: translateY(-50%) rotate(-45deg); /* 반대 방향으로 45도 회전하여 X 자 형성 */
        }

    </style>
</head>
<th:block layout:fragment="content">


    <div class="layout-contents">
        <!-- Page Title -->
        <div class="page-title-wrap">
            <div class="left">
                <h2>도시가스청구서관리</h2><a id="toggleButton" onclick="toggleSearchWrap()"><img src="/images/icon/ico-down.png"
                                                                                         alt="알람 아이콘"></a>
                <!--                <a title="북마크" class="bookmark toggle">-->
                <!--                    내 메뉴-->
                <!--                </a>-->
            </div>
            <ul class="page-navi">
                <li><img src="/images/icon/ico-nav-home.svg" alt="홈아이콘"></li>
                <li>서비스분석</li>
                <li>비용관리</li>
                <li>도시가스청구서관리</li>
            </ul>
        </div>
        <!-- Select -->
        <div class="search-wrap" id="searchWrap" style="display: none">
            <ul>
                <li>
                    <select title="지역" id="spworkcd" name="spworkcd"
                            onchange="updateCompcdOptions(); saveSelectedSandanData(); ">
                        <!-- 지역 옵션을 JavaScript에서 동적으로 채움 -->
                    </select>
                    <input type="hidden" id="spworknm" name="spworknm">
                </li>
                <li>
                    <select title="산단" id="spcompcd" name="spcompcd"
                            onchange="updatePlancdOptions(); saveSelectedSandanData();">
                        <!-- 산단 옵션을 JavaScript에서 동적으로 채움 -->
                    </select>
                    <input type="hidden" id="spcompnm" name="spcompnm">
                </li>
                <li>
                    <select title="시설" id="spplancd" name="spplancd"
                            onchange="updatePlannm(); saveSelectedSandanData()">
                        <!-- 시설 옵션을 JavaScript에서 동적으로 채움 -->
                    </select>
                    <input type="hidden" id="spplannm" name="spplannm">
                </li>
            </ul>
        </div>
        <div class="tab-wrap">
            <ul class="tab-links">

                <li>
                    <a href="#tab1" title="기간별조회">기간별조회</a>
                </li>
                <li>
                    <a href="#tab2" title="기간별대비">기간별대비</a>
                </li>
                <li>
                    <a href="#tab3" title="청구서등록">청구서등록</a>
                </li>
            </ul>
            <div class="tab-contents">
                <!-- Section -->
                <section class="tab-item" id="tab1">
                    <!--                    <div class="section-top">-->
                    <!--&lt;!&ndash;                        <div class="search-wrap">&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                            <dl>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                <dt>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                    <label>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                        구분<span class="eq">*</span>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                    </label>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                </dt>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                <dd>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                    <ul>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                        <li>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                            <select>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                                <option>실시간사용량</option>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                                <option>도시가스사용량</option>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                                <option>도시가스사용량대비매출액</option>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                            </select>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                        </li>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                    </ul>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                </dd>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                            </dl>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            <dl>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                <dt>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                    <label for="select1">&ndash;&gt;-->
                    <!--&lt;!&ndash;                                        검색조건<span class="eq">*</span>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                    </label>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                </dt>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                <dd>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                    <select id="select1" class="w120">&ndash;&gt;-->
                    <!--&lt;!&ndash;                                        <option>일</option>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                        <option>주</option>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                        <option>월</option>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                        <option>년</option>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                    </select>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                </dd>&ndash;&gt;-->
                    <!--&lt;!&ndash;                            </dl>&ndash;&gt;-->
                    <!--&lt;!&ndash;                            <dl>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                <dt>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                    조회기간<span class="eq">*</span>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                </dt>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                <dd>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                    <ul class="date-box">&ndash;&gt;-->
                    <!--&lt;!&ndash;                                        <li>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                            <input type="date" id="searchfrdate" name="searchfrdate">&ndash;&gt;-->
                    <!--&lt;!&ndash;                                            <label for="searchfrdate" class="hide">시작일</label>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                        </li>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                        <li>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                            <input type="date" id="searchtodate" name="searchtodate">&ndash;&gt;-->
                    <!--&lt;!&ndash;                                            <label for="searchtodate" class="hide">종료일</label>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                        </li>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                    </ul>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                </dd>&ndash;&gt;-->
                    <!--&lt;!&ndash;                            </dl>&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                            <dl>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                <dt>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                    <label for="select1">&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                        검색조건<span class="eq">*</span></label></dt>&ndash;&gt;&ndash;&gt;-->

                    <!--&lt;!&ndash;                            &lt;!&ndash;                                <dd>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                    <select id="select1" class="w120">&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                        <option>일</option>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                        <option>주</option>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                        <option>월</option>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                        <option>년</option>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                    </select>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                                </dd>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            &lt;!&ndash;                            </dl>&ndash;&gt;&ndash;&gt;-->
                    <!--&lt;!&ndash;                            <dl>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                <dt>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                    <label for="select1">&ndash;&gt;-->
                    <!--&lt;!&ndash;                                        구분<span class="eq">*</span>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                    </label>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                </dt>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                <dd>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                    <select id="select1" class="w120">&ndash;&gt;-->
                    <!--&lt;!&ndash;                                        <option>전체</option>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                        <option>FC#1</option>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                        <option>FC#2</option>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                        <option>FC#3</option>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                        <option>FC#4</option>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                    </select>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                </dd>&ndash;&gt;-->
                    <!--&lt;!&ndash;                            </dl>&ndash;&gt;-->

                    <!--&lt;!&ndash;                            <dl>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                <dt>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                    <label for="select1">&ndash;&gt;-->
                    <!--&lt;!&ndash;                                        표출조건</label>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                </dt>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                <dd>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                    <select id="select1" class="w120">&ndash;&gt;-->
                    <!--&lt;!&ndash;                                        <option>5분</option>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                        <option>10분</option>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                        <option>1시간</option>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                    </select>&ndash;&gt;-->

                    <!--&lt;!&ndash;                                    <a class="btn btn-delete" title="검색" id="searchButton1" onclick="search()">&ndash;&gt;-->
                    <!--&lt;!&ndash;                                        <img src="/images/icon/btn-srch.svg" alt="검색 아이콘">&ndash;&gt;-->
                    <!--&lt;!&ndash;                                        검색&ndash;&gt;-->
                    <!--&lt;!&ndash;                                    </a>&ndash;&gt;-->
                    <!--&lt;!&ndash;                                </dd>&ndash;&gt;-->
                    <!--&lt;!&ndash;                            </dl>&ndash;&gt;-->

                    <!--&lt;!&ndash;                        </div>&ndash;&gt;-->

                    <div class="section-top">
                        <div class="search-wrap">
                            <dl>
                                <dt>
                                    <label for="periodType">
                                        기간유형<span class="eq">*</span>
                                    </label>
                                </dt>
                                <dd>
                                    <ul class="date-box">
                                        <li>
                                            <select id="periodType" name="periodType" onchange="updatePeriodInputs()">
                                                <option value="hourly">시간별</option>
                                                <option value="monthly" selected>월별</option>
                                                <option value="quarterly">분기별</option>
                                                <option value="halfyearly">반기별</option>
                                                <option value="yearly">연도별</option>
                                            </select>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>

                            <dl>
                                <dt>
                                    조회연도<span class="eq">*</span>
                                </dt>
                                <dd>
                                    <ul class="date-box">
                                        <li>
                                            <select id="yearSelectTab1" name="yearSelectTab1">
                                                <option>2023</option>
                                                <option selected>2024</option>
                                            </select>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>

                            <dl>
                                <dt>
                                    조회기간<span class="eq">*</span>
                                </dt>
                                <dd>
                                    <ul class="date-box" id="dateBoxContainer">
                                        <li id="startDateContainer">
                                            <input type="month" id="startDate" name="startDate" value="2024-01">
                                        </li>
                                        <li id="endDateContainer">
                                            <input type="month" id="endDate" name="endDate" value="2024-05">
                                        </li>

                                        <li>
                                            <a class="btn btn-delete" title="검색" id="btn-search"
                                               onclick="searchDataTab1()">
                                                <img src="/images/icon/btn-srch.svg" alt="검색 아이콘">
                                                검색
                                            </a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                        </div>
                    </div>
                    <div class="row row-2" style="margin-bottom: 9px;">
                        <div class="col wp50" style="margin-right: 15px;">
                            <section class="tab-section" style="height: 360px; padding: 11px; margin-bottom: 0px;">
                                <div class="title-wrap" style="margin-bottom: 0px">
                                    <h3>도시가스 공급단가</h3>
                                    <ul class="tab-links-sub">
                                        <li><a href="#tab01" title="통계">통계</a></li>
                                        <li><a href="#tab02" title="현황">현황</a></li>
                                    </ul>
                                </div>
                                <div class="tab-contents">
                                    <!-- tab1 -->
                                    <div class="tab-item-sub" id="tab01">
                                        <div class="chart-wrap">
                                            <div id="chartHolder1"
                                                 style="width: 100%; height: 290px; padding-top: 13px"></div>
                                        </div>
                                    </div>
                                    <!-- tab2 -->
                                    <div class="tab-item-sub" id="tab02" style="padding-top: 10px;">
                                        <div class="container-fluid">
                                            <p id="selectedItem"></p>
                                            <div id="theGrid" class="theGrid" style="width: 100%; height: 280px"></div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>

                        <div class="col wp50">
                            <section class="tab-section" style="height: 360px; padding: 11px; margin-bottom: 0px;">
                                <div class="title-wrap" style="margin-bottom: 0px">
                                    <h3>도시가스 평균단가</h3>
                                    <ul class="tab-links-sub">
                                        <li><a href="#tab03" title="통계">통계</a></li>
                                        <li><a href="#tab04" title="현황">현황</a></li>
                                    </ul>
                                </div>
                                <div class="tab-contents">
                                    <!-- tab5 -->
                                    <div class="tab-item-sub" id="tab03">
                                        <div class="chart-wrap">
                                            <div id="chartHolder2"
                                                 style="width: 100%; height: 290px; padding-top: 13px"></div>
                                        </div>
                                    </div>
                                    <!-- tab6 -->
                                    <div class="tab-item-sub" id="tab04" style="padding-top: 10px;">
                                        <div class="container-fluid">
                                            <p id="selectedItem"></p>
                                            <div id="theGrid2" class="theGrid2"
                                                 style="width: 100%; height: 280px"></div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>


                    <div class="row row-2">
                        <div class="col wp50" style="margin-right: 15px;">
                            <section class="tab-section" style="height: 360px; padding: 11px; margin-bottom: 0px;">
                                <div class="title-wrap" style="margin-bottom: 0px">
                                    <h3>도시가스 사용량</h3>
                                    <ul class="tab-links-sub">
                                        <li><a href="#tab05" title="통계">통계</a></li>
                                        <li><a href="#tab06" title="현황">현황</a></li>
                                    </ul>
                                </div>
                                <div class="tab-contents">
                                    <!-- tab1 -->
                                    <div class="tab-item-sub" id="tab05">
                                        <div class="chart-wrap">
                                            <div id="chartHolder3"
                                                 style="width: 100%; height: 290px; padding-top: 13px"></div>
                                        </div>
                                    </div>
                                    <!-- tab2 -->
                                    <div class="tab-item-sub" id="tab06" style="padding-top:10px;">
                                        <div class="container-fluid">
                                            <p id="selectedItem"></p>
                                            <div id="theGrid3" class="theGrid3"
                                                 style="width: 100%; height: 280px"></div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>

                        <div class="col wp50">
                            <section class="tab-section" style="height: 360px; padding: 11px; margin-bottom: 0px;">
                                <div class="title-wrap" style="margin-bottom: 0px">
                                    <h3>도시가스 사용금액</h3>
                                    <ul class="tab-links-sub">
                                        <li><a href="#tab07" title="통계">통계</a></li>
                                        <li><a href="#tab08" title="현황">현황</a></li>
                                    </ul>
                                </div>
                                <div class="tab-contents">
                                    <!-- tab5 -->
                                    <div class="tab-item-sub" id="tab07">
                                        <div class="chart-wrap">
                                            <div id="chartHolder4"
                                                 style="width: 100%; height: 290px; padding-top: 13px"></div>
                                        </div>
                                    </div>
                                    <!-- tab6 -->
                                    <div class="tab-item-sub" id="tab08" style="padding-top: 10px;">
                                        <div class="container-fluid">
                                            <p id="selectedItem"></p>
                                            <div id="theGrid4" class="theGrid4"
                                                 style="width: 100%; height: 280px"></div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>
                </section>


                <section class="tab-item" id="tab2">
                    <div class="section-top">
                        <div class="search-wrap">
                            <dl>
                                <dt>
                                    <label for="comparisonType">
                                        비교유형<span class="eq">*</span>
                                    </label>
                                </dt>
                                <dd>
                                    <ul class="date-box">
                                        <li>
                                            <select id="comparisonType" name="comparisonType">
                                                <option value="YoY">YoY</option>
                                                <option value="QoQ">QoQ</option>
                                                <option value="MoM">MoM</option>
                                                <option value="YTD">YTD</option>
                                            </select>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <dl>
                                <dt>
                                    조회기간<span class="eq">*</span>
                                </dt>
                                <dd>
                                    <ul class="date-box" id="dateBoxContainerTab2">
                                        <li id="startDateContainerTab2">
                                            <select id="startDateTab2" name="startDateTab2">
                                                <option selected>2023</option>
                                                <option>2024</option>
                                            </select>
                                        </li>
                                        <li id="endDateContainerTab2">
                                            <select id="endDateTab2" name="endDateTab2">
                                                <option>2023</option>
                                                <option selected>2024</option>
                                            </select>
                                        </li>
                                        <li>
                                            <a class="btn btn-delete" title="검색" id="btn-searchTab2"
                                               onclick="searchDataTab2()">
                                                <img src="/images/icon/btn-srch.svg" alt="검색 아이콘">
                                                검색
                                            </a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                        </div>
                    </div> <!--//section-top end -->

                    <div class="row row-2"  style="margin-bottom: 9px;">
                        <div class="col wp50" style="margin-right: 15px;">
                            <section class="tab-section" style="height: 360px; padding: 11px; margin-bottom: 0px;">
                                <div class="title-wrap" style="margin-bottom: 0px">
                                    <h3>도시가스 공급단가</h3>
                                    <ul class="tab-links-sub">
                                        <li><a href="#tab09" title="통계">통계</a></li>
                                        <li><a href="#tab10" title="현황">현황</a></li>
                                    </ul>
                                </div>
                                <div class="tab-contents">
                                    <!-- tab1 -->
                                    <div class="tab-item-sub" id="tab09">
                                        <div class="chart-wrap">
                                            <div id="chartHolder5"
                                                 style="width: 100%; height: 290px; padding-top: 13px"></div>
                                        </div>
                                    </div>
                                    <!-- tab2 -->
                                    <div class="tab-item-sub" id="tab10" style="padding-top: 10px;">

                                        <div class="container-fluid">
                                            <p id="selectedItem"></p>
                                            <div id="theGrid" class="theGrid" style="width: 100%; height: 280px"></div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>

                        <div class="col wp50">
                            <section class="tab-section" style="height: 360px; padding: 11px; margin-bottom: 0px;">
                                <div class="title-wrap" style="margin-bottom: 0px">
                                    <h3>도시가스 평균단가</h3>
                                    <ul class="tab-links-sub">
                                        <li><a href="#tab11" title="통계">통계</a></li>
                                        <li><a href="#tab12" title="현황">현황</a></li>
                                    </ul>
                                </div>
                                <div class="tab-contents">
                                    <!-- tab5 -->
                                    <div class="tab-item-sub" id="tab11">
                                        <div class="chart-wrap">
                                            <div id="chartHolder6"
                                                 style="width: 100%; height: 290px; padding-top: 13px"></div>
                                        </div>
                                    </div>
                                    <!-- tab6 -->
                                    <div class="tab-item-sub" id="tab12" style="padding-top: 10px;">
                                        <div class="container-fluid">
                                            <p id="selectedItem"></p>
                                            <div id="theGrid2" class="theGrid2"
                                                 style="width: 100%; height: 280px"></div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>


                    <div class="row row-2">
                        <div class="col wp50" style="margin-right: 15px;">
                            <section class="tab-section" style="height: 360px; padding: 11px; margin-bottom: 0px;">
                                <div class="title-wrap" style="margin-bottom: 0px">
                                    <h3>도시가스 사용량</h3>
                                    <ul class="tab-links-sub">
                                        <li><a href="#tab13" title="통계">통계</a></li>
                                        <li><a href="#tab14" title="현황">현황</a></li>
                                    </ul>
                                </div>
                                <div class="tab-contents">
                                    <!-- tab1 -->
                                    <div class="tab-item-sub" id="tab13">
                                        <div class="chart-wrap">
                                            <div id="chartHolder7"
                                                 style="width: 100%; height: 290px; padding-top: 13px"></div>
                                        </div>
                                    </div>
                                    <!-- tab2 -->
                                    <div class="tab-item-sub" id="tab14" style="padding-top:10px;">
                                        <div class="container-fluid">
                                            <p id="selectedItem"></p>
                                            <div id="theGrid3" class="theGrid3"
                                                 style="width: 100%; height: 280px"></div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>

                        <div class="col wp50">
                            <section class="tab-section" style="height: 360px; padding: 11px; margin-bottom: 0px;">
                                <div class="title-wrap" style="margin-bottom: 0px">
                                    <h3>도시가스 사용금액</h3>
                                    <ul class="tab-links-sub">
                                        <li><a href="#tab15" title="통계">통계</a></li>
                                        <li><a href="#tab16" title="현황">현황</a></li>
                                    </ul>
                                </div>
                                <div class="tab-contents">
                                    <!-- tab5 -->
                                    <div class="tab-item-sub" id="tab15">
                                        <div class="chart-wrap">
                                            <div id="chartHolder8"
                                                 style="width: 100%; height: 290px; padding-top: 13px"></div>
                                        </div>
                                    </div>
                                    <!-- tab6 -->
                                    <div class="tab-item-sub" id="tab16" style="padding-top: 10px;">
                                        <div class="container-fluid">
                                            <p id="selectedItem"></p>
                                            <div id="theGrid4" class="theGrid4"
                                                 style="width: 100%; height: 280px"></div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>
                </section>


                <section class="tab-item" id="tab3">
                    <div class="section-top">
                        <div class="search-wrap">
                            <dl>
                                <dt>
                                    조회년도<span class="eq">*</span>
                                </dt>
                                <dd>
                                    <div class="srch-box">
                                        <ul class="date-box">
                                            <li>
                                                <select id="yearSelect" style="border-radius: 5px 5px 5px 5px;">
                                                    <option value="2024" selected>2024</option>
                                                    <option value="2023">2023</option>
                                                    <option value="2022">2022</option>
                                                    <option value="2021">2021</option>
                                                    <option value="2020">2020</option>
                                                </select>
                                            </li>
                                           <!-- <li>
                                                <a class="btn btn-delete" title="검색" id="searchbtn">
                                                    <img src="/images/icon/btn-srch.svg" alt="검색 아이콘">
                                                    검색
                                                </a>
                                            </li>-->
                                        </ul>
                                    </div>
                                </dd>
                            </dl>
                        </div>

                        <div class="button-wrap">
                            <ul>
                                <li>
                                    <a title="청구서등록" class="btn btn-popup-open" data-popup="popup1"
                                       onclick="showPopup()">
                                        <img src="/images/icon/ico-save.svg" alt="저장 아이콘">청구서 등록</a>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div> <!--//section-top end -->

                    <div class="row row-2">
                        <div class="col wp100" style="margin-bottom: 24px;">
                            <div class="container-fluid">
                                <p id="selectedItem"></p>
                                <div id="theGrid5"></div>
                            </div>
                        </div>
                    </div>


                    <div class="row row-2" style="margin-bottom: 24px;">
                        <div class="col wp30" style="margin-right: 15px;">
                            <section class="tab-section" style="height: 300px; padding: 11px; margin-bottom: 0px;">
                                <div class="button-wrap" style="float: right; padding-top: 5px; margin-bottom: 7px;">
                                    <ul>
                                        <li>
                                            <a class="btn btn-edit" title="저장">
                                                <img src="/images/icon/ico-edit.svg" alt="수정 아이콘">
                                                수정
                                            </a>
                                        </li>

                                    </ul>
                                </div>
                                <div class="table-wrap">
                                    <table class="view-table" style="border-top:1px solid #D4D5D7">
                                        <caption>청구서 등록 테이블</caption>
                                        <colgroup>
                                            <col class="wp20">
                                            <col class="wauto">
                                        </colgroup>
                                        <tbody>


                                        <tr>
                                            <th><label for="standym">청구년월</label></th>
                                            <td>
                                                <div class="input-clear"><input type="text" id="standym" class="wp100" readonly>
                                                </div>
                                            </td>
                                        </tr>

                                        <tr>
                                            <th><label for="smuseqty">사용량</label></th>
                                            <td>
                                                <div class="input-clear"><input type="text" id="smuseqty" class="wp100" readonly>
                                                </div>
                                            </td>
                                        </tr>

                                        <tr>
                                            <th><label for="smusehqty">사용열량</label></th>
                                            <td>
                                                <div class="input-clear">
                                                    <input type="text" id="smusehqty" class="wp100" readonly><span class="btn-clear">×</span>
                                                </div>
                                            </td>
                                        </tr>

                                        <tr>
                                            <th><label for="askamt">청구금액</label></th>
                                            <td>
                                                <div class="input-clear"><input type="text" id="askamt" class="wp100" readonly>
                                                </div>
                                            </td>
                                        </tr>

                                        </tbody>
                                    </table>
                                </div>
                            </section>
                        </div>

                        <div class="col wp70">
                            <section class="tab-section" style="height: 450px; padding: 11px; margin-bottom: 0px;">
                                <div class="tab-contents">
                                    <div class="tab-item-sub">
                                        <div class="chart-wrap">
                                            <div id="chartHolder9"
                                                 style="width: 100%; height: 380px; padding-top: 13px"></div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>
                </section>
            </div> <!--//tab-contens end-->
        </div> <!--//tab-wrap end-->
    </div> <!--//layout-contents end -->

<footer>
    <p>Copyrightⓒ 0000 corp. All rights reserved.</p>
</footer>

    <div class="modal">
        <div class="popup-wrapper w700" id="popup1">
            <div class="popup-title">
                <h3>청구서 등록</h3>
                <a title="팝업닫기" onclick="closePopup()" class="btn-popup-close">
                    <img src="/images/icon/btn-popup-close.svg" alt="닫기">
                </a>
            </div>
            <div class="popup-contents">
                <div class="table-wrap">
                    <table class="write-table">
                        <caption>점검등록 테이블</caption>
                        <colgroup>
                            <col class="wp20">
                            <col class="wp80">
                        </colgroup>
                        <tbody>
                        <tr>
                            <th>
                                <label for="popup-date">등록일자</label>
                            </th>
                            <td>
                                <div class="input-clear">
                                    <input type="date" id="popup-date" name="standdt" class="CostDate" readonly>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <th>첨부파일</th>
                            <td>
                                <div id="uploadComponent2" class="upload-component">
                                    <div class="upload-filebox">
                                        <img src="/images/icon/ico-fileupload.svg" alt="업로드아이콘">
                                        <a class="btn" title="파일업로드">파일업로드</a>
                                        <input type="file" id="fileInput2" class="fileInput" multiple="">
                                        <p>Maximun upload file size <span>1GiB</span></p>
                                    </div>
                                    <div class="upload-filelist">
                                        <div class="title">
                                            <span> * 업로드시 PDF 파일이어야 합니다.</span>
                                            <h5>Files (0)</h5>
                                            <a title="Delete all" class="btn-file-deleteall">Delete all</a>
                                        </div>
                                        <ul class="filelist">
                                        </ul>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="popup-button">
                <button onclick="closePopup()"
                        style="border: 1px solid #03428E !important; font-size: 15px !important;">취소
                </button>
                <button onclick="uploadFile()"
                        style="border: 1px solid #03428E !important;color: white;background: #03428E !important;font-size: 15px !important;">
                    저장
                </button>
            </div>
        </div>
    </div>




    <div id="chartModal" class="modal" style="opacity:100">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="modalChartHolder" style="width: 100%; height: 500px;"></div> <!-- 차트를 보여줄 모달의 div -->
        </div>
    </div>


</th:block>
<th:block layout:fragment="scripts">
    <th:block th:replace="/common/approve_box :: approve_box"></th:block>
    <th:block th:replace="/common/ax5_uploader :: ax5_uploader"></th:block>
    <th:block th:replace="/common/upload_one_image_box :: upload_one_image_box"></th:block>
    <th:block th:replace="/common/popup_select_user_code :: popup_select_user_code"></th:block>

    <script type="text/javascript">


        //  select 바뀌면 hidden input 변경
        function updateSelect(selectId, hiddenInputId) {
            var selectElement = document.getElementById(selectId);
            var selectedOptionText = selectElement.options[selectElement.selectedIndex].text;
            document.getElementById(hiddenInputId).value = selectedOptionText;
        }


        // 조회기간 변동 함수 -> 입력 필드를 동적으로 업데이트
        function updatePeriodInputs() {
            const periodType = document.getElementById("periodType").value;
            const selectedYear = document.getElementById("yearSelectTab1").value; // 선택된 조회연도 가져오기
            const dateBoxContainer = document.getElementById("dateBoxContainer");
            const startDateContainer = document.getElementById("startDateContainer");
            const endDateContainer = document.getElementById("endDateContainer");
            const periodLabel = dateBoxContainer.closest('dl').querySelector('dt'); // <dl> 요소를 가져옴

            // 기존 내용을 초기화
            // document.getElementById("startDateContainer").innerHTML = "";
            // document.getElementById("endDateContainer").innerHTML = "";

            // 조회연도 필드를 가져옴
            const yearSelectContainer = Array.from(document.querySelectorAll('dl')).find(dl => {
                const dt = dl.querySelector('dt');
                return dt && dt.textContent.includes("조회연도");
            });

            // 시간별, 월별일 경우 조회연도 필드를 숨기거나 표시
            if (periodType === "hourly" || periodType === "monthly") {
                if (yearSelectContainer) yearSelectContainer.style.display = "none"; // 조회연도 숨기기
                document.getElementById("comparisonType").value = "MoM";
            } else {
                if (yearSelectContainer) yearSelectContainer.style.display = "block"; // 조회연도 표시
            }

            if (periodType === "yearly") { // 연도별 조회가 선택된 경우
                document.getElementById("comparisonType").value = "YoY";
                // 조회기간 글자 숨기기
                periodLabel.style.visibility = "hidden";
                // startDate와 endDate input 요소 숨기기
                startDateContainer.style.display = "none";
                endDateContainer.style.display = "none";
            } else {
                // 조회기간 글자 보이기
                periodLabel.style.visibility = "visible";
                // startDate와 endDate input 요소 보이기
                startDateContainer.style.display = "inline-block";
                endDateContainer.style.display = "inline-block";

                // 각 기간유형에 맞는 요소 설정
                if (periodType === "hourly") {
                    const currentDate = new Date();
                    const defaultMonth = (currentDate.getMonth() + 1).toString().padStart(2, '0');
                    const defaultDay = currentDate.getDate().toString().padStart(2, '0');

                    document.getElementById("startDateContainer").innerHTML = `
                <input type="date" id="startDate" name="startDate" value="${selectedYear}-${defaultMonth}-${defaultDay}">
            `;

                    document.getElementById("endDateContainer").innerHTML = `
                <select id="startHour" name="startHour" style="width: 60px;">
                    ${generateHourOptions()}
                </select>
                -
                <select id="endHour" name="endHour" style="width: 60px;">
                    ${generateHourOptions(true)}
                </select>
            `;
                } else if (periodType === "monthly") {
                    const startDate = `${selectedYear}-01`;
                    const endDate = `${selectedYear}-12`;

                    document.getElementById("startDateContainer").innerHTML = `<input type="month" id="startDate" name="startDate" value="${startDate}">`;
                    document.getElementById("endDateContainer").innerHTML = `<input type="month" id="endDate" name="endDate" value="${endDate}">`;
                } else if (periodType === "quarterly") {
                    document.getElementById("comparisonType").value = "QoQ";
                    const options = `
                <option value="Q1">1분기</option>
                <option value="Q2">2분기</option>
                <option value="Q3">3분기</option>
                <option value="Q4">4분기</option>
            `;
                    document.getElementById("startDateContainer").innerHTML = `<select id="startQuarter">${options}</select>`;
                    document.getElementById("endDateContainer").innerHTML = `<select id="endQuarter">${options}</select>`;
                } else if (periodType === "halfyearly") {
                    document.getElementById("comparisonType").value = "QoQ";
                    const options = `
                <option value="H1">상반기</option>
                <option value="H2">하반기</option>
            `;
                    document.getElementById("startDateContainer").innerHTML = `<select id="startHalf">${options}</select>`;
                    document.getElementById("endDateContainer").innerHTML = `<select id="endHalf">${options}</select>`;
                }
            }
        }

        // 시간 옵션 생성 함수
        function generateHourOptions(isEnd = false) {
            return Array.from({length: 24}, (_, i) => {
                const hour = (i + 1).toString().padStart(2, '0');
                return `<option value="${hour}"${isEnd && hour === '24' || !isEnd && hour === '01' ? ' selected' : ''}>${hour}</option>`;
            }).join('');
        }

        // tab2 MoM 선택시, 월 선택 셀렉트 생성
        function createMonthSelect(id) {
            const monthSelect = document.createElement('select');
            monthSelect.id = id;
            monthSelect.name = id;
            monthSelect.style.width = '70px';

            const months = [
                "01", "02", "03", "04", "05", "06",
                "07", "08", "09", "10", "11", "12"
            ];

            months.forEach(month => {
                const option = document.createElement('option');
                option.value = month;
                option.textContent = `${month}월`;
                monthSelect.appendChild(option);
            });

            return monthSelect;
        }

        // tab2 비교유형 변경시 실행될 함수
        function updateComparisonType() {
            const comparisonType = document.getElementById("comparisonType").value;
            const startDateContainerTab2 = document.getElementById("startDateContainerTab2");
            const endDateContainerTab2 = document.getElementById("endDateContainerTab2");

            // 기존 월 선택 셀렉트를 제거
            const existingStartMonthSelect = document.getElementById("startMonthTab2");
            const existingEndMonthSelect = document.getElementById("endMonthTab2");

            if (existingStartMonthSelect) startDateContainerTab2.removeChild(existingStartMonthSelect);
            if (existingEndMonthSelect) endDateContainerTab2.removeChild(existingEndMonthSelect);

            // "MoM"이 선택된 경우에만 새로운 월 셀렉트 추가
            if (comparisonType === "MoM") {
                const startMonthSelect = createMonthSelect("startMonthTab2");
                const endMonthSelect = createMonthSelect("endMonthTab2");

                // 첫 번째 셀렉트가 변경될 때 두 번째 셀렉트도 동일한 값으로 설정
                startMonthSelect.addEventListener("change", function () {
                    endMonthSelect.value = startMonthSelect.value;
                });

                startDateContainerTab2.appendChild(startMonthSelect);
                endDateContainerTab2.appendChild(endMonthSelect);
            }
        }

        document.getElementById("comparisonType").addEventListener("change", updateComparisonType);

        var theGrid;
        var theGrid2;
        var theGrid3;
        var theGrid4;
        var theGrid5;

        var viewdata;
        var viewdata2;

        let selectedFiles = [];
        let SelectItem;
        let csrfToken = $("[name=_csrf]").val();


        // 첫 번째 탭 버튼 클릭 이벤트
        document.querySelector('a[href="#tab1"]').addEventListener('click', function () {
            setTimeout(createTab1Charts, 100); // 탭이 보인 후에 차트가 렌더링되도록 약간의 지연을 줌
        });

        // 두 번째 탭 버튼 클릭 이벤트
        document.querySelector('a[href="#tab2"]').addEventListener('click', function () {
            setTimeout(createTab2Charts, 100); // 탭이 보인 후에 차트가 렌더링되도록 약간의 지연을 줌
        });

        // 두 번째 탭 버튼 클릭 이벤트
        document.querySelector('a[href="#tab3"]').addEventListener('click', function () {
            setTimeout(createTab3Charts, 100); // 탭이 보인 후에 차트가 렌더링되도록 약간의 지연을 줌
        });

        // 페이지 로드 시 첫 번째 탭의 차트를 자동으로 로드
        document.addEventListener('DOMContentLoaded', function () {
            createTab1Charts();
        });


        // -----------------------차트 설정 시작-----------------------
        // 첫 번째 탭 차트 생성 함수
        function createTab1Charts() {

            let chartVars = "rMateOnLoadCallFunction=chartReadyHandler";

            let chartsTab1 = [
                {name: "chart1", vars: chartVars},
                {name: "chart2", vars: chartVars},
                {name: "chart3", vars: chartVars},
                {name: "chart4", vars: chartVars},
            ];

            chartsTab1.forEach(chart => {
                let chartID = chart.name.replace(/\D/g, ""); // 숫자만 추출
                rMateChartH5.create(chart.name, "chartHolder" + chartID, chart.vars, "100%", "100%");
            });
        }

          /*  rMateChartH5.create("chart1", "chartHolder1", "", "100%", "100%");
            rMateChartH5.create("chart2", "chartHolder2", "", "100%", "100%");
            rMateChartH5.create("chart3", "chartHolder3", "", "100%", "100%");
            rMateChartH5.create("chart4", "chartHolder4", "", "100%", "100%");*/



          /*  var chartData = [
                {"EXPESYM": "01월", "FUEAMT": 100},
                {"EXPESYM": "02월", "FUEAMT": 120},
                {"EXPESYM": "03월", "FUEAMT": 150},
                {"EXPESYM": "04월", "FUEAMT": 180},
                {"EXPESYM": "05월", "FUEAMT": 170},
                {"EXPESYM": "06월", "FUEAMT": 210},
                {"EXPESYM": "07월", "FUEAMT": 250},
                {"EXPESYM": "08월", "FUEAMT": 140},
                {"EXPESYM": "09월", "FUEAMT": 180},
                {"EXPESYM": "10월", "FUEAMT": 330},
                {"EXPESYM": "11월", "FUEAMT": 280},
                {"EXPESYM": "12월", "FUEAMT": 270}
            ];

            var chartData2 = [
                {"EXPESYM": "01월", "FUEAMT": 140},
                {"EXPESYM": "02월", "FUEAMT": 160},
                {"EXPESYM": "03월", "FUEAMT": 220},
                {"EXPESYM": "04월", "FUEAMT": 250},
                {"EXPESYM": "05월", "FUEAMT": 180},
                {"EXPESYM": "06월", "FUEAMT": 310},
                {"EXPESYM": "07월", "FUEAMT": 400},
                {"EXPESYM": "08월", "FUEAMT": 520},
                {"EXPESYM": "09월", "FUEAMT": 380},
                {"EXPESYM": "10월", "FUEAMT": 730},
                {"EXPESYM": "11월", "FUEAMT": 250},
                {"EXPESYM": "12월", "FUEAMT": 180}
            ];

            rMateChartH5.calls("chart1", {
                "setLayout": layoutStr,
                "setData": chartData
            });

            rMateChartH5.calls("chart2", {
                "setLayout": layoutStr,
                "setData": chartData2
            });
            rMateChartH5.calls("chart3", {
                "setLayout": layoutStr,
                "setData": chartData2
            });
            rMateChartH5.calls("chart4", {
                "setLayout": layoutStr,
                "setData": chartData
            });*/




        // 두 번째 탭 차트 생성 함수
        function createTab2Charts() {

            let chartVars1 = "rMateOnLoadCallFunction=chartReadyHandler";


            let chartsTab2 = [
                {name: "chart5", vars: chartVars1},
                {name: "chart6", vars: chartVars1},
                {name: "chart7", vars: chartVars1},
                {name: "chart8", vars: chartVars1}
            ];
           /* rMateChartH5.create("chart5", "chartHolder5", "", "100%", "100%");
            rMateChartH5.create("chart6", "chartHolder6", "", "100%", "100%");
            rMateChartH5.create("chart7", "chartHolder7", "", "100%", "100%");
            rMateChartH5.create("chart8", "chartHolder8", "", "100%", "100%");*/

            chartsTab2.forEach(chart => {
                let chartID = chart.name.replace(/\D/g, ""); // 숫자만 추출
                rMateChartH5.create(chart.name, "chartHolder" + chartID, chart.vars, "100%", "100%");
            });

        }

        function chartReadyHandler(id) {

            let chartIndex = id.replace(/\D/g, "");

            var chartData;

            switch (chartIndex) {
                case "1":
                    chartData = [
                        {"EXPESYM": "01월", "FUEAMT": 100},
                        {"EXPESYM": "02월", "FUEAMT": 120},
                        {"EXPESYM": "03월", "FUEAMT": 150},
                        {"EXPESYM": "04월", "FUEAMT": 180},
                        {"EXPESYM": "05월", "FUEAMT": 170},
                        {"EXPESYM": "06월", "FUEAMT": 210},
                        {"EXPESYM": "07월", "FUEAMT": 250},
                        {"EXPESYM": "08월", "FUEAMT": 140},
                        {"EXPESYM": "09월", "FUEAMT": 180},
                        {"EXPESYM": "10월", "FUEAMT": 330},
                        {"EXPESYM": "11월", "FUEAMT": 280},
                        {"EXPESYM": "12월", "FUEAMT": 270}
                    ];
                    break;

                case "2":
                    chartData = [
                        {"EXPESYM": "01월", "FUEAMT": 140},
                        {"EXPESYM": "02월", "FUEAMT": 160},
                        {"EXPESYM": "03월", "FUEAMT": 220},
                        {"EXPESYM": "04월", "FUEAMT": 250},
                        {"EXPESYM": "05월", "FUEAMT": 180},
                        {"EXPESYM": "06월", "FUEAMT": 310},
                        {"EXPESYM": "07월", "FUEAMT": 400},
                        {"EXPESYM": "08월", "FUEAMT": 520},
                        {"EXPESYM": "09월", "FUEAMT": 380},
                        {"EXPESYM": "10월", "FUEAMT": 730},
                        {"EXPESYM": "11월", "FUEAMT": 250},
                        {"EXPESYM": "12월", "FUEAMT": 180}
                    ];

                    break;

                case "3":
                    chartData = [
                        {"EXPESYM": "01월", "FUEAMT": 100},
                        {"EXPESYM": "02월", "FUEAMT": 120},
                        {"EXPESYM": "03월", "FUEAMT": 150},
                        {"EXPESYM": "04월", "FUEAMT": 180},
                        {"EXPESYM": "05월", "FUEAMT": 170},
                        {"EXPESYM": "06월", "FUEAMT": 210},
                        {"EXPESYM": "07월", "FUEAMT": 250},
                        {"EXPESYM": "08월", "FUEAMT": 140},
                        {"EXPESYM": "09월", "FUEAMT": 180},
                        {"EXPESYM": "10월", "FUEAMT": 330},
                        {"EXPESYM": "11월", "FUEAMT": 280},
                        {"EXPESYM": "12월", "FUEAMT": 270}
                    ];
                    break;

                case "4":
                    chartData = [
                        {"EXPESYM": "01월", "FUEAMT": 140},
                        {"EXPESYM": "02월", "FUEAMT": 160},
                        {"EXPESYM": "03월", "FUEAMT": 220},
                        {"EXPESYM": "04월", "FUEAMT": 250},
                        {"EXPESYM": "05월", "FUEAMT": 180},
                        {"EXPESYM": "06월", "FUEAMT": 310},
                        {"EXPESYM": "07월", "FUEAMT": 400},
                        {"EXPESYM": "08월", "FUEAMT": 520},
                        {"EXPESYM": "09월", "FUEAMT": 380},
                        {"EXPESYM": "10월", "FUEAMT": 730},
                        {"EXPESYM": "11월", "FUEAMT": 250},
                        {"EXPESYM": "12월", "FUEAMT": 180}
                    ];

                    break;

                case "5":
                    chartData = [
                        {"Year": "1월", "2023": 120, "2024": 100},
                        {"Year": "2월", "2023": 140, "2024": 150},
                        {"Year": "3월", "2023": 220, "2024": 180},
                        {"Year": "4월", "2023": 160, "2024": 140},
                        {"Year": "5월", "2023": 210, "2024": 220},
                        {"Year": "6월", "2023": 400, "2024": 420},
                        {"Year": "7월", "2023": 330, "2024": 320},
                        {"Year": "8월", "2023": 420, "2024": 280},
                        {"Year": "9월", "2023": 550, "2024": 610},
                        {"Year": "10월", "2023": 480, "2024": 330},
                        {"Year": "11월", "2023": 320, "2024": 450},
                        {"Year": "12월", "2023": 600, "2024": 740},

                    ];
                    break;
                case "6":
                    chartData = [
                        {"Year": "1월", "2023": 110, "2024": 300},
                        {"Year": "2월", "2023": 130, "2024": 250},
                        {"Year": "3월", "2023": 120, "2024": 280},
                        {"Year": "4월", "2023": 150, "2024": 150},
                        {"Year": "5월", "2023": 160, "2024": 120},
                        {"Year": "6월", "2023": 220, "2024": 300},
                        {"Year": "7월", "2023": 450, "2024": 120},
                        {"Year": "8월", "2023": 870, "2024": 180},
                        {"Year": "9월", "2023": 320, "2024": 150},
                        {"Year": "10월", "2023": 560, "2024": 230},
                        {"Year": "11월", "2023": 220, "2024": 500},
                        {"Year": "12월", "2023": 700, "2024": 110},

                    ];
                    break;
                case "7":
                    chartData = [
                        {"Year": "1월", "2023": 220, "2024": 120},
                        {"Year": "2월", "2023": 230, "2024": 18},
                        {"Year": "3월", "2023": 450, "2024": 400},
                        {"Year": "4월", "2023": 280, "2024": 160},
                        {"Year": "5월", "2023": 450, "2024": 600},
                        {"Year": "6월", "2023": 320, "2024": 280},
                        {"Year": "7월", "2023": 440, "2024": 330},
                        {"Year": "8월", "2023": 300, "2024": 350},
                        {"Year": "9월", "2023": 250, "2024": 300},
                        {"Year": "10월", "2023": 560, "2024": 400},
                        {"Year": "11월", "2023": 320, "2024": 380},
                        {"Year": "12월", "2023": 470, "2024": 110},
                    ];
                    break;
                case "8":
                    chartData = [
                        {"Year": "1월", "2023": 120, "2024": 100},
                        {"Year": "2월", "2023": 140, "2024": 150},
                        {"Year": "3월", "2023": 220, "2024": 180},
                        {"Year": "4월", "2023": 160, "2024": 140},
                        {"Year": "5월", "2023": 210, "2024": 220},
                        {"Year": "6월", "2023": 400, "2024": 420},
                        {"Year": "7월", "2023": 330, "2024": 320},
                        {"Year": "8월", "2023": 420, "2024": 280},
                        {"Year": "9월", "2023": 550, "2024": 610},
                        {"Year": "10월", "2023": 480, "2024": 330},
                        {"Year": "11월", "2023": 320, "2024": 450},
                        {"Year": "12월", "2023": 600, "2024": 740},

                    ];
                    break;

                case "9":
                    chartData  = [
                        {"Month": "1월", "ASKAMT": 1000, "SMUSEQTY": 40, "SMUSEHQTY": 50},
                        {"Month": "2월", "ASKAMT": 1500, "SMUSEQTY": 50, "SMUSEHQTY": 60},
                        {"Month": "3월", "ASKAMT": 1700, "SMUSEQTY": 30, "SMUSEHQTY": 45},
                        {"Month": "4월", "ASKAMT": 2300, "SMUSEQTY": 50, "SMUSEHQTY": 60},
                        {"Month": "5월", "ASKAMT": 1800, "SMUSEQTY": 60, "SMUSEHQTY": 65},
                        {"Month": "6월", "ASKAMT": 2500, "SMUSEQTY": 85, "SMUSEHQTY": 95},
                        {"Month": "7월", "ASKAMT": 1500, "SMUSEQTY": 40, "SMUSEHQTY": 50},
                        {"Month": "8월", "ASKAMT": 1600, "SMUSEQTY": 60, "SMUSEHQTY": 65},
                        {"Month": "9월", "ASKAMT": 1200, "SMUSEQTY": 70, "SMUSEHQTY": 75},
                        {"Month": "10월", "ASKAMT": 1400, "SMUSEQTY": 80, "SMUSEHQTY": 85},
                        {"Month": "11월", "ASKAMT": 1600, "SMUSEQTY": 60, "SMUSEHQTY": 65},
                        {"Month": "12월", "ASKAMT": 1800, "SMUSEQTY": 90, "SMUSEHQTY": 95}
                    ];
            }

            // document.getElementById(id).setLayout(layoutStr);
            document.getElementById(id).setData(chartData);
            if (chartIndex >= "1" && chartIndex <= "4") {
                document.getElementById(id).setLayout(layoutStr1);
            } else if (chartIndex >= "5" && chartIndex <= "8") {
                document.getElementById(id).setLayout(layoutStr2);
            }else if (chartIndex === "9") {
                document.getElementById(id).setLayout(layoutStr3);
            }

        }


        // 스트링 형식으로 레이아웃 정의.
        var layoutStr1 = '<rMateChart backgroundColor="#FFFFFF" borderStyle="none">'
            + '<Column2DChart showDataTips="true">'
            + '<horizontalAxis><CategoryAxis categoryField="EXPESYM"/></horizontalAxis>'
            + '<series>'
            + '<Column2DSeries yField="FUEAMT" fill="#62b2fd">'
            + '<showDataEffect><SeriesInterpolate/></showDataEffect>'
            + '</Column2DSeries>'
            + '</series>'
            + '</Column2DChart>'
            + '</rMateChart>';


            var layoutStr2 =
                `<rMateChart borderStyle='none'>
        <Options><Caption text=''/>
        <Legend defaultMouseOverAction='true' useVisibleCheck='true'/>
        </Options>
        <Line2DChart showDataTips='true'>
            <series>
                <Line2DSeries yField='2023' displayName='2023' itemRenderer='DiamondItemRenderer'>
                    <showDataEffect><SeriesXYTransition offset='500'/></showDataEffect>
                    <lineStroke><Stroke color='#ffa336' weight='2'/></lineStroke>
                </Line2DSeries>
                <Line2DSeries yField='2024' displayName='2024' itemRenderer='DiamondItemRenderer'>
                    <showDataEffect><SeriesXYTransition offset='500'/></showDataEffect>
                    <lineStroke><Stroke color='#909BFF' weight='2'/></lineStroke>
                </Line2DSeries>
            </series>
            <horizontalAxis><CategoryAxis categoryField='Year'/></horizontalAxis>
            <verticalAxis><LinearAxis interval='5'/></verticalAxis>
        </Line2DChart>
    </rMateChart>`;

        var layoutStr3 =
            `<rMateChart backgroundColor="#FFFFFF" borderStyle="none">
                <Options>
                    <Caption text=""/>
                    <Legend defaultMouseOverAction="true"/>
                </Options>
                <NumberFormatter id="numFmt" useThousandsSeparator="true"/>
                <Combination2DChart showDataTips="true">
                    <horizontalAxis>
                        <CategoryAxis categoryField="Month"/>
                    </horizontalAxis>
                    <verticalAxis>
                        <LinearAxis id="vAxis1" interval="500" formatter="{numFmt}" maximum="3000"/>
                    </verticalAxis>
                    <series>
                        <Column2DSet type="clustered">
                            <series>
                                <Column2DSeries yField="ASKAMT" displayName="청구금액" fill="#62b2fd">
                                    <showDataEffect><SeriesInterpolate/></showDataEffect>
                                </Column2DSeries>
                            </series>
                        </Column2DSet>
                        <Line2DSeries yField="SMUSEQTY" displayName="사용량" itemRenderer="DiamondItemRenderer">
                            <lineStroke><Stroke color="#ffa336" weight="2"/></lineStroke>
                            <showDataEffect><SeriesInterpolate/></showDataEffect>
                            <verticalAxis>
                                <LinearAxis id="vAxis2" interval="10" maximum="100"/>  <!-- 오른쪽 축 최대값 100 -->
                            </verticalAxis>
                        </Line2DSeries>
                        <Line2DSeries yField="SMUSEHQTY" displayName="사용열량" itemRenderer="DiamondItemRenderer">
                            <lineStroke><Stroke color='#909BFF' weight="2"/></lineStroke>
                            <showDataEffect><SeriesInterpolate/></showDataEffect>
                            <verticalAxis>
                                <LinearAxis id="vAxis2" interval="10" maximum="100"/>  <!-- 오른쪽 축 최대값 100 -->
                            </verticalAxis>
                        </Line2DSeries>
                    </series>
                    <verticalAxisRenderers>
                        <Axis2DRenderer axis="{vAxis1}" showLine="true"/>
                        <Axis2DRenderer axis="{vAxis2}" showLine="true" side="right"/>
                    </verticalAxisRenderers>
                </Combination2DChart>
            </rMateChart>`;


          /*  rMateChartH5.calls("chart5", {
                "setLayout": layoutStr2,
                "setData": chartData8
            });
            rMateChartH5.calls("chart6", {
                "setLayout": layoutStr2,
                "setData": chartData9
            });
            rMateChartH5.calls("chart7", {
                "setLayout": layoutStr2,
                "setData": chartData10
            });

            rMateChartH5.calls("chart8", {
                "setLayout": layoutStr2,
                "setData": chartData8
            });*/



        function createTab3Charts() {
            let chartVars2 = "rMateOnLoadCallFunction=chartReadyHandler";
            // rMateChartH5.create("chart9", "chartHolder9", "", "100%", "100%");


            let chartsTab3 = [

                {name: "chart9", vars: chartVars2},

            ];
            chartsTab3.forEach(chart => {
                let chartID = chart.name.replace(/\D/g, ""); // 숫자만 추출
                rMateChartH5.create(chart.name, "chartHolder" + chartID, chart.vars, "100%", "100%");
            });


            // rMateChartH5.calls("chart9", {"setLayout": layoutStr3, "setData": chartDataCombo});

        }


        rMateChartH5.registerTheme(rMateChartH5.themes);

        function rMateChartH5ChangeTheme(theme) {
            document.getElementById("chart1").setTheme(theme);
            document.getElementById("chart2").setTheme(theme);
            document.getElementById("chart3").setTheme(theme);
            document.getElementById("chart4").setTheme(theme);
            document.getElementById("chart5").setTheme(theme);
            document.getElementById("chart6").setTheme(theme);
            document.getElementById("chart7").setTheme(theme);
            document.getElementById("chart8").setTheme(theme);
            document.getElementById("chart9").setTheme(theme);
        }

        // 팝업 함수
        function closePopup() {

            const modal = document.querySelector('.modal');
            const modalContent = document.querySelector('.popup-wrapper');

            // 애니메이션을 위한 클래스 제거
            modal.classList.remove('show');
            modalContent.classList.remove('show');

            // 애니메이션이 끝난 후 모달을 숨기기 위해 타임아웃 설정
            setTimeout(() => {
                modal.style.display = 'none';
                modalContent.style.display = 'none';
            }, 300); // 애니메이션 지속 시간 (0.3초)과 동일하게 설정
        }

        function showPopup() {
            let fileNameDisplay = document.getElementById('fileNameDisplay');

            const modal = document.querySelector('.modal');
            const modalContent = document.querySelector('.popup-wrapper');

            // 모달과 콘텐츠를 표시
            modal.style.display = 'block';
            modalContent.style.display = 'block';

            // 애니메이션을 위한 클래스 추가
            requestAnimationFrame(() => {
                modal.classList.add('show');
                modalContent.classList.add('show');
            });
        }


        // 파일 업로드 함수
        function uploadFile() {
            const fileInput = document.getElementById('fileInput2');
            const file = fileInput.files[0];

            // 파일 유효성 검사
            if (!file || file.type !== 'application/pdf') {
                alert("PDF 파일만 업로드 가능합니다.");
                return;
            }




            const formData = new FormData();

            const dateInput = document.getElementById('popup-date').value;

            formData.append("file", file);
            formData.append("_csrf", csrfToken);
            formData.append("standdt", dateInput);  // 날짜 값 추가

            // 각각의 select 요소 값 가져오기
            const spworkcdValue = document.getElementById('spworkcd').value;
            const spworknmValue = document.getElementById('spworknm').value;
            const spcompcdValue = document.getElementById('spcompcd').value;
            const spcompnmValue = document.getElementById('spcompnm').value;
            const spplancdValue = document.getElementById('spplancd').value;
            const spplannmValue = document.getElementById('spplannm').value;

            // FormData에 값 추가
            formData.append('spworkcd', spworkcdValue);
            formData.append('spworknm', spworknmValue);
            formData.append('spcompcd', spcompcdValue);
            formData.append('spcompnm', spcompnmValue);
            formData.append('spplancd', spplancdValue);
            formData.append('spplannm', spplannmValue);


            fetch('/api/cost/gas_bill/upload', {
                method: 'POST',
                body: formData
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error("파일 업로드 실패");
                    }
                    return response.json();  // 서버에서 JSON 응답을 기대
                })
                .then(result => {
                    if (result.success) {
                        alert("파일이 성공적으로 업로드되었습니다.");
                        closeModal();  // 모달창 닫기

                    } else {
                        alert(result.message);  // 오류 메시지 표시
                    }
                })
                .catch(error => {
                    console.error('오류:', error);
                    alert(`파일 처리 중 오류가 발생했습니다: ${error.message}`);
                });
        }

        function closeModal() {
            document.getElementById('popup1').style.display = 'none';
        }

        document.readyState === 'complete' ? init() : window.onload = init;


        <!-- 초반 페이지 진입시 그리드 바인딩 끝-->
        function init() {
            let data2 = [];

            $.ajax({
                url: '/api/gas/list/read',
                type: 'GET',
                // data: {
                //     'searchusr' : searchusr,
                //
                // },
                async: false,
                success: function (data) {
                    console.log('wijmo', data.data);
                    data2 = data.data;
                }
            })



            // 데이터 배열이 비어있을 경우 여러 개의 빈 객체 추가
           /* if (data3.length === 0) {
                let emptyRowsCount = 3;  // 원하는 빈 행의 수
                for (let i = 0; i < emptyRowsCount; i++) {
                    data3.push({});
                }
                console.log('Grid initialized with empty data.');
            }*/

            // // 데이터 그리드에 바인딩
            /* theGrid1 = new wijmo.grid.FlexGrid('#theGrid1', {
                 autoGenerateColumns: false,
                 showMarquee: true,
                 columns: columns,
                 itemsSource: viewdata1
             });

             theGrid2 = new wijmo.grid.FlexGrid('#theGrid2', {
                 autoGenerateColumns: false,
                 showMarquee: true,
                 columns: columns,
                 itemsSource: viewdata2
             });

             theGrid3 = new wijmo.grid.FlexGrid('#theGrid3', {
                 autoGenerateColumns: false,
                 showMarquee: true,
                 columns: columns,
                 itemsSource: viewdata3
             });

             theGrid4 = new wijmo.grid.FlexGrid('#theGrid4', {
                 autoGenerateColumns: false,
                 showMarquee: true,
                 columns: columns,
                 itemsSource: viewdata4
             });*/

            yearSelect();

            /*    viewdata2 = new wijmo.collections.CollectionView(data3);

                theGrid5 = new wijmo.grid.FlexGrid('#theGrid5', {
                    autoGenerateColumns: false,
                    showMarquee: true,
                    columns: [
                        {binding: 'category', header: '구분', width: 120, align: 'center'},
                        {binding: 'Year1', header: '1월', width: 120, align: 'center'},
                        {binding: 'Year2', header: '2월', width: 120, align: 'center'},
                        {binding: 'Year3', header: '3월', width: 120, align: 'center'},
                        {binding: 'Year4', header: '4월', width: 120, align: 'center'},
                        {binding: 'Year5', header: '5월', width: 120, align: 'center'},
                        {binding: 'Year6', header: '6월', width: 120, align: 'center'},
                        {binding: 'Year7', header: '7월', width: 120, align: 'center'},
                        {binding: 'Year8', header: '8월', width: 120, align: 'center'},
                        {binding: 'Year9', header: '9월', width: 120, align: 'center'},
                        {binding: 'Year10', header: '10월', width: 120, align: 'center'},
                        {binding: 'Year11', header: '11월', width: 120, align: 'center'},
                        {binding: 'Year12', header: '12월', width: "*", align: 'center'}
                    ],

                    //홀짝 로우 음영주기

                    itemsSource: viewdata2

                });

                theGrid5.setCellData(0, 'category', '사용량');
                theGrid5.setCellData(1, 'category', '사용열량');
                theGrid5.setCellData(2, 'category', '청구금액');


                theGrid5.rowHeaders.columns.splice(0, 1);  //맨 앞에 헤더부분 없애기*/


                var columns = [
                    {binding: 'num', header: 'No', align: 'center', width: 80},
                    {binding: 'day', header: '기간', align: 'center', width: "*"},
                    {binding: 'amount', header: '금액', align: 'center', width: "*"},

                ];

                viewdata = new wijmo.collections.CollectionView(data2);

                // .theGrid1 클래스를 가진 모든 요소를 선택
                var theGrids = document.querySelectorAll('.theGrid');
                theGrids.forEach(function (element, index) {
                    // 각 요소에 대해 Wijmo FlexGrid 생성
                    var grid = new wijmo.grid.FlexGrid(element, {
                        autoGenerateColumns: false, // 자동으로 컬럼 생성하지 않음
                        columns: columns, // 컬럼 설정
                        itemsSource: viewdata // 데이터 소스 설정
                    });

                    // rowHeaders의 첫 번째 컬럼을 제거
                    grid.rowHeaders.columns.splice(0, 1);

                    // 데이터가 한 번만 추가되도록 확인
                    if (grid.collectionView.items.length === 0) {  // 데이터가 비어있을 때만 추가
                        data2.push({num: '1', day: '2024-08-01', amount: 1200});
                        data2.push({num: '2', day: '2024-08-02', amount: 1500});
                        data2.push({num: '3', day: '2024-08-03', amount: 2400});
                        data2.push({num: '4', day: '2024-08-04', amount: 3200});
                        data2.push({num: '5', day: '2024-08-05', amount: 1800});
                        data2.push({num: '6', day: '2024-08-06', amount: 1400});
                        data2.push({num: '7', day: '2024-08-07', amount: 2800});
                        data2.push({num: '8', day: '2024-08-08', amount: 1300});
                        data2.push({num: '9', day: '2024-08-09', amount: 2500});
                        data2.push({num: '10', day: '2024-08-10', amount: 1400});
                        data2.push({num: '11', day: '2024-08-11', amount: 1800});
                        data2.push({num: '12', day: '2024-08-12', amount: 1500});
                        data2.push({num: '13', day: '2024-08-13', amount: 2000});
                        data2.push({num: '14', day: '2024-08-14', amount: 1700});
                        data2.push({num: '15', day: '2024-08-15', amount: 2500});
                        data2.push({num: '16', day: '2024-08-16', amount: 1100});
                    }

                    // 그리드 업데이트
                    grid.collectionView.refresh();
                });


                var theGrid2s = document.querySelectorAll('.theGrid2');
                theGrid2s.forEach(function (element, index) {
                    // 각 요소에 대해 Wijmo FlexGrid 생성
                    var grid = new wijmo.grid.FlexGrid(element, {
                        autoGenerateColumns: false, // 자동으로 컬럼 생성하지 않음
                        columns: columns, // 컬럼 설정
                        itemsSource: viewdata // 데이터 소스 설정
                    });
                    // rowHeaders의 첫 번째 컬럼을 제거
                    grid.rowHeaders.columns.splice(0, 1);
                });

                var theGrid3s = document.querySelectorAll('.theGrid3');
                theGrid3s.forEach(function (element, index) {
                    // 각 요소에 대해 Wijmo FlexGrid 생성
                    var grid = new wijmo.grid.FlexGrid(element, {
                        autoGenerateColumns: false, // 자동으로 컬럼 생성하지 않음
                        columns: columns, // 컬럼 설정
                        itemsSource: viewdata // 데이터 소스 설정
                    });
                    // rowHeaders의 첫 번째 컬럼을 제거
                    grid.rowHeaders.columns.splice(0, 1);
                });


                var theGrid4s = document.querySelectorAll('.theGrid4');
                theGrid4s.forEach(function (element, index) {
                    // 각 요소에 대해 Wijmo FlexGrid 생성
                    var grid = new wijmo.grid.FlexGrid(element, {
                        autoGenerateColumns: false, // 자동으로 컬럼 생성하지 않음
                        columns: columns, // 컬럼 설정
                        itemsSource: viewdata // 데이터 소스 설정
                    });
                    // rowHeaders의 첫 번째 컬럼을 제거
                    grid.rowHeaders.columns.splice(0, 1);
                });

                let selector = new wijmo.grid.selector.Selector(theGrid, {
                    itemChecked: (e, ctx) => {
                        SelectItem = theGrid.rows.filter(r => r.isSelected);

                    }
                })


                /* // 선택이 변경될 때, 현재 항목 업데이트

                 theGrid1.rowHeaders.columns.splice(0, 1);  //맨 앞에 헤더부분 없애기
                 theGrid2.rowHeaders.columns.splice(0, 1);
                 theGrid3.rowHeaders.columns.splice(0, 1);
                 theGrid4.rowHeaders.columns.splice(0, 1);

                 theGrid1.setCellData(0, 'num', '1');
                 theGrid1.setCellData(1, 'num', '2');
                 theGrid1.setCellData(2, 'num', '3');
                 theGrid1.setCellData(3, 'num', '4');
                 theGrid1.setCellData(4, 'num', '5');

                 theGrid1.setCellData(0, 'day', '2024-01-01');
                 theGrid1.setCellData(1, 'day', '2024-01-02');
                 theGrid1.setCellData(2, 'day', '2024-01-03');
                 theGrid1.setCellData(3, 'day', '2024-01-04');
                 theGrid1.setCellData(4, 'day', '2024-01-05');

                 theGrid2.setCellData(0, 'num', '1');
                 theGrid2.setCellData(1, 'num', '2');
                 theGrid2.setCellData(2, 'num', '3');
                 theGrid2.setCellData(3, 'num', '4');
                 theGrid2.setCellData(4, 'num', '5');

                 theGrid2.setCellData(0, 'day', '2024-01-01');
                 theGrid2.setCellData(1, 'day', '2024-01-02');
                 theGrid2.setCellData(2, 'day', '2024-01-03');
                 theGrid2.setCellData(3, 'day', '2024-01-04');
                 theGrid2.setCellData(4, 'day', '2024-01-05');


                 theGrid3.setCellData(0, 'num', '1');
                 theGrid3.setCellData(1, 'num', '2');
                 theGrid3.setCellData(2, 'num', '3');
                 theGrid3.setCellData(3, 'num', '4');
                 theGrid3.setCellData(4, 'num', '5');

                 theGrid3.setCellData(0, 'day', '2024-01-01');
                 theGrid3.setCellData(1, 'day', '2024-01-02');
                 theGrid3.setCellData(2, 'day', '2024-01-03');
                 theGrid3.setCellData(3, 'day', '2024-01-04');
                 theGrid3.setCellData(4, 'day', '2024-01-05');


                 theGrid4.setCellData(0, 'num', '1');
                 theGrid4.setCellData(1, 'num', '2');
                 theGrid4.setCellData(2, 'num', '3');
                 theGrid4.setCellData(3, 'num', '4');
                 theGrid4.setCellData(4, 'num', '5');

                 theGrid4.setCellData(0, 'day', '2024-01-01');
                 theGrid4.setCellData(1, 'day', '2024-01-02');
                 theGrid4.setCellData(2, 'day', '2024-01-03');
                 theGrid4.setCellData(3, 'day', '2024-01-04');
                 theGrid4.setCellData(4, 'day', '2024-01-05');*/


        }

            <!-- 초반 페이지 진입시 그리드 바인딩 끝-->


        function yearSelect(){

            $.ajax({
                url: '/api/cost/gas_bill/Select_years',
                type: 'GET',
                dataType: 'json',
                success: function(years) {
                    const yearSelect = $('#yearSelect');
                    const currentYear = new Date().getFullYear(); // 올해 연도

                    // 기존 option 요소 모두 삭제
                    yearSelect.empty();

                    // 연도로 option 추가
                    years.forEach(function(year) {
                        yearSelect.append(new Option(year, year));
                    });

                    // 올해 연도가 years 배열에 포함되어 있지 않으면 추가
                    if (!years.includes(currentYear.toString())) {
                        yearSelect.append(new Option(currentYear, currentYear));
                        years.push(currentYear.toString()); // 배열에도 올해 연도를 추가
                    }

                    // 올해 연도를 기본 선택하고 해당 연도의 데이터를 그리드에 바인딩
                    const latestYear = currentYear.toString(); // 올해 연도를 기본으로 선택
                    yearSelect.val(latestYear);
                    loadGridData(latestYear); // 선택한 연도 데이터 로드
                },
                error: function(xhr, status, error) {
                    console.error('Error fetching years:', status, error);
                }
            });


            // 선택된 연도의 데이터를 그리드에 로드하는 함수
            function loadGridData(year) {
                $.ajax({
                    url: '/api/cost/gas_bill/read',
                    type: 'GET',
                    data: { year: year },
                    dataType: 'json',
                    success: function(response) {
                        // 응답에서 실제 데이터 배열 추출
                        const data = response.data;

                        if (theGrid5) {
                            theGrid5.dispose();
                        }

                        // 그리드 초기화 및 데이터 바인딩
                        theGrid5 = new wijmo.grid.FlexGrid('#theGrid5', {
                            autoGenerateColumns: false,
                            showMarquee: true,
                            columns: [
                                { binding: 'category', header: '구분', width: 100, align: 'center' },
                                { binding: 'Jan', header: '1월', width: 110, align: 'center', format: 'n0'},
                                { binding: 'Feb', header: '2월', width: 110, align: 'center', format: 'n0'},
                                { binding: 'Mar', header: '3월', width: 110, align: 'center', format: 'n0'},
                                { binding: 'Apr', header: '4월', width: 110, align: 'center', format: 'n0'},
                                { binding: 'May', header: '5월', width: 110, align: 'center', format: 'n0'},
                                { binding: 'Jun', header: '6월', width: 110, align: 'center', format: 'n0'},
                                { binding: 'Jul', header: '7월', width: 110, align: 'center', format: 'n0'},
                                { binding: 'Aug', header: '8월', width: 110, align: 'center', format: 'n0'},
                                { binding: 'Sep', header: '9월', width: 110, align: 'center', format: 'n0'},
                                { binding: 'Oct', header: '10월', width: 110, align: 'center', format: 'n0'},
                                { binding: 'Nov', header: '11월', width: 110, align: 'center', format: 'n0'},
                                { binding: 'Dec', header: '12월', width: 110, align: 'center', format: 'n0'},
                                { binding: 'total', header: '계', width: '*', align: 'center', format: 'n0'}
                            ]
                        });

                        theGrid5.rowHeaders.columns.splice(0, 1);


                        if (!Array.isArray(data) || data.length === 0) {
                            console.warn('No data found for the selected year:', year);

                            // 빈 그리드 초기화
                            const emptyData = [
                                { category: '사용량', Jan: '', Feb: '', Mar: '', Apr: '', May: '', Jun: '', Jul: '', Aug: '', Sep: '', Oct: '', Nov: '', Dec: '', total: '' },
                                { category: '사용열량', Jan: '', Feb: '', Mar: '', Apr: '', May: '', Jun: '', Jul: '', Aug: '', Sep: '', Oct: '', Nov: '', Dec: '', total: '' },
                                { category: '청구금액', Jan: '', Feb: '', Mar: '', Apr: '', May: '', Jun: '', Jul: '', Aug: '', Sep: '', Oct: '', Nov: '', Dec: '', total: '' }
                            ];
                            theGrid5.itemsSource = emptyData;
                            return;
                        }

                        // 데이터 가공 및 바인딩
                        const gridData = [
                            { category: '사용량', ...getMonthlyData(data, 'smuseqty') },
                            { category: '사용열량', ...getMonthlyData(data, 'smusehqty') },
                            { category: '청구금액', ...getMonthlyData(data, 'askamt') }
                        ];

                        theGrid5.itemsSource = gridData;


                        theGrid5.selectionChanged.addHandler(function (e) {
                            const selectedRow = theGrid5.selection.row; // 선택된 행
                            const selectedCol = theGrid5.selection.col; // 선택된 열

                            console.log(selectedRow,"+", selectedCol,"선택된 행과 열 확인");

                            if (selectedRow >= 0) {
                                const selectedData = theGrid5.itemsSource[selectedRow]; // 선택된 행의 데이터

                                // 월 인덱스 계산
                                const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                                const monthIndex = selectedCol - 1; // 0은 구분, 1부터 12월

                                // 필드에 데이터 표시
                                const selectedMonth = monthIndex < 9 ? '0' + (monthIndex + 1) : (monthIndex + 1); // 월 포맷팅
                                const formattedYearMonth = year + selectedMonth; // 예: 202301

                                $('#standym').val(formattedYearMonth); // 청구년월
                                $('#askamt').val(selectedData.category === '청구금액' ? selectedData.total : ''); // 청구금액
                                $('#smuseqty').val(selectedData.category === '사용량' ? selectedData.total : ''); // 사용량
                                $('#smusehqty').val(selectedData.category === '사용열량' ? selectedData.total : ''); // 사용열량
                            }
                        });

                    },
                    error: function(xhr, status, error) {
                        console.error('Error fetching grid data:', status, error);
                        console.error('Response text:', xhr.responseText);
                    }
                });
            }

            // 연도 변경 시 그리드 데이터 로드
            document.getElementById('yearSelect').addEventListener('change', function() {
                const selectedYear = this.value;
                loadGridData(selectedYear);
            });


            // 월별 데이터 가공 함수
            function getMonthlyData(data, field) {

                const monthlyData = {
                    Jan: '', Feb: '', Mar: '', Apr: '', May: '', Jun: '',
                    Jul: '', Aug: '', Sep: '', Oct: '', Nov: '', Dec: '',
                    total: 0 // 합계를 계산하는 필드 추가
                };

                data.forEach(function(item) {
                    const month = parseInt(item.month, 10);
                    const value = item[field] ? parseInt(item[field], 10) : 0; // 값이 없을 때 0으로 처리

                    switch (month) {
                        case 1: monthlyData.Jan = value; break;
                        case 2: monthlyData.Feb = value; break;
                        case 3: monthlyData.Mar = value; break;
                        case 4: monthlyData.Apr = value; break;
                        case 5: monthlyData.May = value; break;
                        case 6: monthlyData.Jun = value; break;
                        case 7: monthlyData.Jul = value; break;
                        case 8: monthlyData.Aug = value; break;
                        case 9: monthlyData.Sep = value; break;
                        case 10: monthlyData.Oct = value; break;
                        case 11: monthlyData.Nov = value; break;
                        case 12: monthlyData.Dec = value; break;
                    }
                });

                monthlyData.total = Object.values(monthlyData).reduce((sum, val) => sum + (val || 0), 0);
                return monthlyData;
            }

        }





            //검색
            function searchData() {
                let data = {
                    'searchusr': $('#searchusr').val(),
                    'searchfrdate': $('#searchfrdate').val(),
                    'searchtodate': $('#searchtodate').val()
                }

                let result = AjaxUtil.getSyncData('/api/inspec_report/read', data);

                if (result.success) {
                    console.log(result.data);
                    grid_binding(result.data);
                }
            }

            function grid_binding(data) {
                var inspecDto = data;
                var inspecData = [];
                var cnt = 1;
                for (var i = 0; i < inspecDto.length; i++) {
                    inspecData.push({
                        spuncode: inspecDto[i]["spuncode"],
                        spworknm: inspecDto[i]["spworknm"],
                        spcompnm: inspecDto[i]["spcompnm"],
                        spplannm: inspecDto[i]["spplannm"],
                        checkdt: inspecDto[i]["checkdt"],
                        checkusr: inspecDto[i]["checkusr"],
                        checkarea: inspecDto[i]["checkarea"],
                        checktmdt: inspecDto[i]["checktmdt"],

                    });
                    cnt++;
                }

                theGrid.columns.clear();
                theGrid.autoGenerateColumns = false;
                viewdata.sourceCollection = inspecData;

                for (var i = 0; i < columns.length; i++) {
                    var col = new wijmo.grid.Column(columns[i]);
                    theGrid.columns.push(col);
                }


            }

            function SelectItemPush() {

                let selectedList = [];
                for (let i = 0; i < SelectItem.length; i++) {
                    selectedList.push(SelectItem[i]._data.spuncode);
                }
                return selectedList;
            }

            function DownloadDoc() {

                let selectedList = SelectItemPush();


                console.log('selected', selectedList);

                //csrf토큰은 바디가 아니라 헤더에 포함하는거구나 기억해두자 개념이 부족하다.
                fetch('/api/inspec_report/download-docs', {
                    method: 'POST',
                    headers: {
                        "Content-Type": "application/json",
                        "X-CSRF-TOKEN": csrfToken
                    },
                    body: JSON.stringify(selectedList)  //JSON으로 전송된다.
                })
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        return response.blob();
                    })
                    .then(blob => {
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = 'modified_documents.zip'; // 다운로드 받을 zip 파일 이름
                        document.body.appendChild(a);
                        a.click();
                        a.remove();
                        window.URL.revokeObjectURL(url); // URL 객체 해제
                    })
                    .catch(error => {
                        console.error('There was a problem with the fetch operation:', error);
                        alert("File download failed!");
                    });
            }

            $(document).ready(function (e) {
                initializeSelections();
                updatePeriodInputs();
                updateComparisonType();

                // 등록 화면 등록일자 설정
                const today = new Date();
                const CostDate = today.toISOString().slice(0, 10);
                document.querySelectorAll('.CostDate').forEach(input => {
                    input.value = CostDate;
                });

                $('.chart-wrap').each(function() {
                    // expand-icon 아이콘 생성
                    let expandIcon = $('<span class="material-symbols-outlined">\n' +
                        'zoom_out_map\n' +
                        '</span>');

                    // expand-icon 스타일 적용
                    expandIcon.css({
                        'position': 'absolute',
                        'top': '17px', // 차트 오른쪽 끝 위에서 10px 아래
                        'right': '3px', // 차트의 오른쪽 끝에 위치
                        'cursor': 'pointer',
                        'z-index': '10',
                        'color': '##B3B3B3'
                    });

                    // chart-wrap에 expand-icon 추가
                    $(this).css('position', 'relative').append(expandIcon);
                });


                // .chart-wrap에 클릭 이벤트 바인딩 (동적 요소에 대해서도 대응)
                $(document).on('click', '.material-symbols-outlined', function() {
                    // 클릭한 div의 id 가져오기
                    let chartHolderId = $(this).prev('div[id^="chartHolder"]').attr('id');

                    // ID가 제대로 추출되었는지 확인
                    console.log("Clicked chartHolder ID: " + chartHolderId);

                    // 모달 열기
                    let modal = document.getElementById("chartModal");
                    let modalChartHolder = document.getElementById("modalChartHolder");
                    modal.style.display = "block";

                    // 기존 차트의 레이아웃과 데이터를 모달 차트로 설정
                    rMateChartH5.create(chartHolderId + "_modal", "modalChartHolder", "rMateOnLoadCallFunction=chartReadyHandler", "100%", "100%");

                    // 모달 닫기 버튼 클릭 시 모달 닫기
                    let closeModal = document.getElementsByClassName("close")[0];
                    closeModal.onclick = function() {
                        modal.style.display = "none";
                        modalChartHolder.innerHTML = ""; // 모달 차트 초기화
                    }

                    // 모달 외부를 클릭하면 모달 닫기
                    window.onclick = function(event) {
                        if (event.target === modal) {
                            modal.style.display = "none";
                            modalChartHolder.innerHTML = ""; // 모달 차트 초기화
                        }
                    }
                });

            });
    </script>
</th:block>

</html>