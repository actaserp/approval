<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[KTFOMS] AI 기반 연료전지 인프라 구축 - 모바일</title>
<!--    <link rel="shortcut icon" href="/img/favicon.ico">-->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" /> <!-- Slide css -->
    
    <link rel="stylesheet" type="text/css" href="/css/import.css">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script> <!-- Slide js -->
    <link rel="stylesheet" href="/resource/ax5ui/ax5ui.all.css" />
    
    <script src="/js/ui.js"></script> <!-- Common js -->
</head>

<body>
    <div class="mobile-wrapper page-login"><!-- ★페이지 Class명 -->
        <div class="mobile-login-wrap">
            <div class="login-wrap">
                <form method="post" class="form" role="form" id="loginFrm" action="/postLogin">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                    <div class="login-logo">
                        <img src="/images/logo/login-logo.png" alt="로고">
                    </div>
                    <div class="login-form">
                        <dl>
                            <dt><label for="loginId">아이디</label></dt>
                            <dd>
                                <input type="text" id="loginId" placeholder="아이디를 입력해주세요">
                            </dd>
                            <!-- 에러메시지 출력 -->
                            <dd class="hint-red">
                                <img src="/images/icon/ico-info-red.svg" alt="힌트메세지">
                                에러메세지 출력
                            </dd>
                        </dl>
                        <dl>
                            <dt><label for="loginPwd">비밀번호</label></dt>
                            <dd>
                                <input type="password" id="loginPwd" placeholder="비밀번호를 입력해주세요">
                            </dd>
                            <dd class="hint">
                                <img src="/images/icon/ico-info.svg" alt="힌트메세지">
                                힌트메세지
                            </dd>
                        </dl>
                        <div class="check-save">
                            <input type="checkbox" id="id_save">
                            <label for="id_save">아이디 저장</label>
                        </div>
                        <button type="submit" class="btn-login" id="login">로그인</button>
                        <ul class="btn-login-etc">
                            <li>
                                <a href="#" class="btn btn-popup-open" data-popup="popup1" title="사용자신청">사용자신청</a>
                            </li>
                            <li>
                                <a href="#" class="btn" title="아이디 찾기">아이디 찾기</a>
                            </li>
                            <li>
                                <a href="#" class="btn" title="비밀번호 찾기">비밀번호 찾기</a>
                            </li>
                        </ul>
                    </div>
                </form>
            </div>
            <!-- <p class="copyright">ⓒ Kt Corp. All rights reserved.</p> -->
        </div>
        <!-- [사용자권한] 팝업  -->
        <div class="mobile-layout-popup">
            <div class="popup-overlay"></div>
            <div class="popup-wrapper" id="popup1">
                <div class="popup-title">
                    <h3>사용자권한신청</h3>
                    <a href="#" title="팝업닫기" class="btn-popup-close">
                        <img src="/images/icon/btn-popup-close.svg" alt="닫기">
                    </a>
                </div>
                <div class="popup-contents">
                    <div class="table-wrap">
                        <div class="write-wrap">
                            <div class="row">
                                <dl>
                                    <dt>
                                        <label for="">
                                            소속사
                                        </label>
                                    </dt>
                                    <dd>
                                        <div class="input-clear">
                                            <input type="text" id="" name="">
                                        </div>
                                    </dd>
                                </dl>
                                <dl>
                                    <dt>
                                        <label for="">
                                            소속부서
                                        </label>
                                    </dt>
                                    <dd>
                                        <div class="input-clear">
                                            <input type="text" id="" name="">
                                        </div>
                                    </dd>
                                </dl>
                            </div>
                            <div class="row">
                                <dl>
                                    <dt>
                                        <label for="">
                                            직급
                                        </label>
                                    </dt>
                                    <dd>
                                        <div class="input-clear">
                                            <input type="text" id="" name="">
                                        </div>
                                    </dd>
                                </dl>
                                <dl>
                                    <dt>
                                        <label for="">
                                            성명
                                        </label>
                                    </dt>
                                    <dd>
                                        <div class="input-clear">
                                            <input type="text" id="" name="">
                                        </div>
                                    </dd>
                                </dl>
                            </div>
                            <dl>
                                <dt>
                                    <label for="">
                                        핸드폰
                                    </label>
                                </dt>
                                <dd>
                                    <div class="input-clear">
                                        <input type="text" id="" name="">
                                    </div>
                                </dd>
                            </dl>                            
                            <dl>
                                <dt>
                                    <label for="">
                                        이메일
                                    </label>
                                </dt>
                                <dd>
                                    <div class="input-clear">
                                        <input type="text" id="" name="">
                                    </div>
                                    <a href="#" class="btn" title="코드발급">코드발급</a>
                                </dd>
                            </dl>                            
                            <dl>
                                <dt>
                                    <label for="">
                                        인증코드
                                    </label>
                                </dt>
                                <dd>
                                    <div class="input-clear">
                                        <input type="text" id="" name="">
                                    </div>
                                    <a href="#" class="btn" title="코드인증">코드인증</a>
                                </dd>
                            </dl>                       
                            <dl>
                                <dt>
                                    <label for="">
                                        아이디 <span class="eq">*</span>
                                    </label>
                                </dt>
                                <dd>
                                    <div class="input-clear">
                                        <input type="text" id="" name="">
                                    </div>
                                    <a href="#" class="btn" title="중복확인">중복확인</a>
                                </dd>
                            </dl>           
                            <dl>
                                <dt>
                                    <label for="">
                                        비밀번호 <span class="eq">*</span>
                                    </label>
                                </dt>
                                <dd>
                                    <div class="input-clear">
                                        <input type="password" id="" name="">
                                    </div>
                                </dd>
                            </dl>           
                            <dl>
                                <dt>
                                    <label for="">
                                        비밀번호 확인 <span class="eq">*</span>
                                    </label>
                                </dt>
                                <dd>
                                    <div class="input-clear">
                                        <input type="password" id="" name="">
                                    </div>
                                </dd>
                            </dl>
                            <dl>
                                <dt>
                                    <label for="">
                                        발전시설
                                    </label>
                                </dt>
                                <dd class="fl-fc">
                                    <div class="row">
                                        <select title="전체">
                                            <option>전체</option>
                                        </select>
                                        <select title="전체">
                                            <option>전체</option>
                                        </select>
                                    </div>
                                    <div class="row">
                                        <select title="전체">
                                            <option>전체</option>
                                        </select>
                                        <a href="#" class="btn" title="발전시설 추가">발전시설 추가</a>
                                    </div>
                                </dd>
                            </dl>     
                            <dl>
                                <dt>
                                    <label for="">
                                        신청사유
                                    </label>
                                </dt>
                                <dd>
                                    <div class="textarea-box">
                                        <textarea id="textarea1" placeholder="신청사유를 입력해주세요."></textarea>
                                        <p class="text-count" id="text-count1">0/100</p>
                                    </div>
                                </dd>
                            </dl>     
                        </div>
                    </div>
                </div>
                <div class="popup-button">
                    <button class="btn-navy">권한신청</button>
                </div>
            </div>
        </div> <!-- //mobile-layout-popup end -->
    </div> <!-- //page-wrapper end-->

    <script type="text/javascript" src="/resource/jquery.min.js"></script>
    <script type="text/javascript" src="/resource/jquery-validation/1.17.0/jquery.validate.min.js"></script>
    <script type="text/javascript" src="/resource/ax5ui/ax5ui.all.min.js"></script>
    <script type="text/javascript" src="/resource/moment.min.js"></script>
    <script type="text/javascript" src="/js/js.cookie.js"></script>
    <script type="text/javascript" src="/js/common.js?v=1050"></script>
    <script type="text/javascript" src="/resource/JavaScript-Templates/tmpl.js"></script>
    <script type="text/javascript" src="/js/ax5commUtil.js?v=1050"></script>

    <script type="text/javascript">

        $(document).ready(function () {
            console.log('ready');
            function submitHandler(form) {
                console.log('submitHandler');
                var submitData = $(form).serialize() + '&isChangeLang=' + isChangeLang;
                $.post('/login', submitData, function (result) {
                    console.log('postpost');
                    let code = result.data.code;
                    if (code == 'NOUSER') {

                        Alert.alert('', '아이디 또는 비밀번호가 일치하지 않습니다.');
                        return false;
                    }
                    if (code == 'NOID') {

                        let redtext = document.getElementById('hint-red');
                        redtext.style.display = 'block';
                        Alert.alert('', '아이디 또는 비밀번호가 일치하지 않습니다.', clearFields);
                    }
                    else if (code == 'NOPW') {
                        Alert.alert('', '비밀번호가 일치하지 않습니다', function () { $('#loginPwd').val(''); $('#loginPwd').focus(); });
                    }
                    else if (code == 'ETC') {
                        Alert.alert('', '로그인에 실패했습니다.&lt;br&gt;다시 시도하십시요', clearFields);
                    } else if (code == 'NOAUTH') {
                        Alert.alert('', '시스템 접근 권한이 없습니다. 시스템관리자에게 확인하시기 바랍니다', clearFields);
                    } else if (code == 'FIRST') {
                        Alert.alert('', '비밀번호를 변경하십시요.', function () { location.href = '/pwdchange'; });
                    } else if (code == 'NOTCONFIRM') {
                        Alert.alert('', '승인되지 않은 사용자입니다.', clearFields);
                    } else if (code == 'noactive') {
                        Alert.alert('', '사용 불가능한 사용자입니다.', clearFields);
                    }
                    else {
                        if (code == 'OK') {
                            console.log('okokokokokokok');
                            let lang_cd = sessionStorage.getItem('lang_code');
                            let url = '/api/common/labels';
                            let pData = { lang_code: lang_cd };
                            let fnsuccess = function (result) {
                                dic = {};
                                $.each(result, function (idx, item) {
                                    let storageKey = lang_cd + '_' + item.gui_code + '_' + item.template_key;
                                    let data = [];
                                    if (dic.hasOwnProperty(storageKey)) {
                                        data = dic[storageKey];
                                    } else {
                                        dic[storageKey] = data;
                                    }
                                    data.push({ 'label_code': item.label_code, 'text': item.text, 'desc': item.descr });
                                });

                                $.each(dic, function (k, v) {
                                    let sessionData = JSON.stringify(v);
                                    sessionStorage.setItem(k, sessionData);
                                });
                                location.href = "/";
                            };

                            let fnfailure = function () {
                                location.href = "/login";
                            };
                            AjaxUtil.getAsyncData(url, pData, fnsuccess, fnfailure);
                            //location.href = "/";
                        } else {
                            location.href = '/';
                        }
                    }
                }).fail(function (e) {
                    Alert.alert('', JSON.parse(e.responseText).message);
                });
            }
            $('#loginFrm').validate({ submitHandler: submitHandler });

        });


    </script>
</body>
</html>
